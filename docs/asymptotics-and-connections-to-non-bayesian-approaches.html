<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Asymptotics and connections to non-Bayesian approaches | Bayesian Data Analysis</title>
  <meta name="description" content="Chapter 4 Asymptotics and connections to non-Bayesian approaches | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Asymptotics and connections to non-Bayesian approaches | Bayesian Data Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 4 Asymptotics and connections to non-Bayesian approaches | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Asymptotics and connections to non-Bayesian approaches | Bayesian Data Analysis" />
  
  <meta name="twitter:description" content="Chapter 4 Asymptotics and connections to non-Bayesian approaches | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  

<meta name="author" content="Anthony R. Colombo, Dr. Paul Marjoram" />


<meta name="date" content="2022-08-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exercises-2.html"/>
<link rel="next" href="blocks.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#independent-study"><i class="fa fa-check"></i>Independent study</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#supervised-learning"><i class="fa fa-check"></i>Supervised learning</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html"><i class="fa fa-check"></i><b>1</b> Fundamentals of Bayesian Inference</a>
<ul>
<li class="chapter" data-level="1.1" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#general-notation-for-statistical-inference"><i class="fa fa-check"></i><b>1.1</b> General notation for statistical inference</a>
<ul>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#exchangeability"><i class="fa fa-check"></i>Exchangeability</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#explanatory-variables"><i class="fa fa-check"></i>Explanatory variables</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#hierarchical-modeling"><i class="fa fa-check"></i>Hierarchical modeling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#bayesian-inference"><i class="fa fa-check"></i><b>1.2</b> Bayesian inference</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#subjectivity-and-objectivity"><i class="fa fa-check"></i>Subjectivity and Objectivity</a></li>
<li class="chapter" data-level="1.3" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#simulation-100-times"><i class="fa fa-check"></i>Simulation 100 times</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>2</b> Single parameter models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cross.html"><a href="cross.html#estimating-a-probability-from-binomial-data"><i class="fa fa-check"></i><b>2.1</b> Estimating a probability from binomial data</a></li>
<li class="chapter" data-level="2.2" data-path="cross.html"><a href="cross.html#posterior-as-a-compromise-between-data-and-prior-information"><i class="fa fa-check"></i><b>2.2</b> Posterior as a compromise between data and prior information</a></li>
<li class="chapter" data-level="2.3" data-path="cross.html"><a href="cross.html#summarizing-the-posterior-inference"><i class="fa fa-check"></i><b>2.3</b> Summarizing the posterior inference</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#posterior-quantiles-and-intervals"><i class="fa fa-check"></i>Posterior quantiles and intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="cross.html"><a href="cross.html#informative-prior-distributions"><i class="fa fa-check"></i><b>2.4</b> Informative prior distributions</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#conjugate-prior-distributions"><i class="fa fa-check"></i>Conjugate prior distributions</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#conjugate-prior-distributions-exponential-families-and-sufficient-statistics"><i class="fa fa-check"></i>Conjugate prior, distributions, exponential families, and sufficient statistics</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="cross.html"><a href="cross.html#normal-distribution-with-known-variance"><i class="fa fa-check"></i><b>2.5</b> Normal distribution with known variance</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#likelihood-of-one-data-point"><i class="fa fa-check"></i>Likelihood of one data point</a></li>
<li class="chapter" data-level="2.5.1" data-path="cross.html"><a href="cross.html#conjugate-prior-and-posterior-distributions"><i class="fa fa-check"></i><b>2.5.1</b> Conjugate prior and posterior distributions</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#posterior-predictive-distribution"><i class="fa fa-check"></i>Posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-model-with-multiple-observations"><i class="fa fa-check"></i>Normal model with multiple observations</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="cross.html"><a href="cross.html#other-standard-single-parameter-models"><i class="fa fa-check"></i><b>2.6</b> Other standard single-parameter models</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-distribution-with-known-mean-but-unknown-variance"><i class="fa fa-check"></i>Normal distribution with known mean but unknown variance</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#poisson-model"><i class="fa fa-check"></i>Poisson model</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#negative-binomial-distribution"><i class="fa fa-check"></i>Negative Binomial distribution</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#exponential-distribution"><i class="fa fa-check"></i>Exponential distribution</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#constructing-a-prior-distribution"><i class="fa fa-check"></i>Constructing a prior distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="cross.html"><a href="cross.html#noninformative-prior-distributions"><i class="fa fa-check"></i><b>2.7</b> Noninformative prior distributions</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="cross.html"><a href="cross.html#jeffreys-invariance-principle"><i class="fa fa-check"></i><b>2.7.1</b> Jeffreys’ invariance principle</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#difficulties-with-noninformative-prior-distributions"><i class="fa fa-check"></i>Difficulties with noninformative prior distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="cross.html"><a href="cross.html#exercises-1"><i class="fa fa-check"></i><b>2.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-1"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-approximation-example"><i class="fa fa-check"></i>Normal approximation example</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-3"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-4"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-7"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-8-normal-distribution-with-unknown-mean"><i class="fa fa-check"></i>Question 8 (Normal distribution with unknown mean)</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-10"><i class="fa fa-check"></i>Question 10</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-11"><i class="fa fa-check"></i>Question 11</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-12"><i class="fa fa-check"></i>Question 12</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-13"><i class="fa fa-check"></i>Question 13</a></li>
<li class="chapter" data-level="2.8.1" data-path="cross.html"><a href="cross.html#question-21"><i class="fa fa-check"></i><b>2.8.1</b> Question 21</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3.html"><a href="chapter-3.html"><i class="fa fa-check"></i><b>3</b> Chapter 3</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="3.1" data-path="exercises-2.html"><a href="exercises-2.html#question-1-1"><i class="fa fa-check"></i><b>3.1</b> Question 1</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-2"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-3-1"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-4-independent-binomial"><i class="fa fa-check"></i>Question 4 (independent binomial)</a>
<ul>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-4-dirichlet"><i class="fa fa-check"></i>Question 4 (dirichlet)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-5"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-7-1"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-8"><i class="fa fa-check"></i>question 8</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-9"><i class="fa fa-check"></i>question 9</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-11-1"><i class="fa fa-check"></i>Question 11</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html"><i class="fa fa-check"></i><b>4</b> Asymptotics and connections to non-Bayesian approaches</a>
<ul>
<li class="chapter" data-level="4.1" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#normal-approximations-to-the-posterior-distribution"><i class="fa fa-check"></i><b>4.1</b> Normal approximations to the posterior distribution</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#summarizing-posterior-distributions-by-point-estimates-and-standard-errors"><i class="fa fa-check"></i>Summarizing posterior distributions by point estimates and standard errors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#large-sample-theory"><i class="fa fa-check"></i><b>4.2</b> Large-sample theory</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#asymptotic-normality-and-consistency"><i class="fa fa-check"></i>Asymptotic normality and consistency</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#frequency-evaluations-of-bayesian-inferences"><i class="fa fa-check"></i><b>4.3</b> Frequency evaluations of Bayesian inferences</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#large-sample-correspondence"><i class="fa fa-check"></i>Large sample correspondence</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#point-estimation-consistency-and-efficiency"><i class="fa fa-check"></i>Point estimation, consistency, and efficiency</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#confidence-coverage"><i class="fa fa-check"></i>Confidence coverage</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#exercises-3"><i class="fa fa-check"></i><b>4.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-1-2"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="4.4.1" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-4.2-using-the-posterior-sampling-via-grid-approach"><i class="fa fa-check"></i><b>4.4.1</b> Question 4.2 using the posterior sampling via grid approach</a></li>
<li class="chapter" data-level="4.4.2" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#taylor-series-approximation-of-the-information-matrix"><i class="fa fa-check"></i><b>4.4.2</b> Taylor series approximation of the information matrix</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-4-1"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-5-1"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-9-1"><i class="fa fa-check"></i>Question 9</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>5</b> Blocks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="blocks.html"><a href="blocks.html#equations"><i class="fa fa-check"></i><b>5.1</b> Equations</a></li>
<li class="chapter" data-level="5.2" data-path="blocks.html"><a href="blocks.html#theorems-and-proofs"><i class="fa fa-check"></i><b>5.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="5.3" data-path="blocks.html"><a href="blocks.html#callout-blocks"><i class="fa fa-check"></i><b>5.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>6</b> Sharing your book</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>6.1</b> Publishing</a></li>
<li class="chapter" data-level="6.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>6.2</b> 404 pages</a></li>
<li class="chapter" data-level="6.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>6.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="7" data-path="parts.html"><a href="parts.html"><i class="fa fa-check"></i><b>7</b> Parts</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="asymptotics-and-connections-to-non-bayesian-approaches" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Asymptotics and connections to non-Bayesian approaches<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#asymptotics-and-connections-to-non-bayesian-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="normal-approximations-to-the-posterior-distribution" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Normal approximations to the posterior distribution<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#normal-approximations-to-the-posterior-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If the posterior distribution is unimodal and roughly symmetric, it can be approximated by a normal distribution, such that the logarithm of the posterior density is approximated by a quadratic function via the Taylor series expansion of <span class="math inline">\(\theta\)</span>.</p>
<p>Consider a quadratic approximation to the log-posterior centered on the posterior mode. where the linear term goes to 0.</p>
<p><span class="math display" id="eq:logdensityquadratic">\[\begin{equation}
log p(\theta|y) = log p(\hat{\theta|y}) + (1/2)(\theta-\hat{\theta)})^T[ d^2/d\theta^2 log p(\theta|y)]_{\theta=\hat{\theta}}+...
\tag{4.1}
\end{equation}\]</span></p>
<p>The first term is a constant and the second term is proportional to the normal density yielding the approximation and we can expand the posterior density second derivative in terms of the prior and likelihood.</p>
<p><span class="math display">\[\begin{equation}
[d^2/d\theta^2 log p(\theta|y)]_{\theta=\hat{\theta}} =[d^2/d\theta^2log p(\theta)]_{\theta=\hat{\theta}}+\sum_{i=1}^n[d^2/d\theta^2log p(y_i|\theta)]_{\theta=\hat{\theta}}
\end{equation}\]</span></p>
<p>Now to show the normal approximation</p>
<p><span class="math display">\[
\begin{aligned}
log p(\theta|y) &amp;= log p(\hat{\theta|y}) + (1/2)(\theta-\hat{\theta)})^T[ d^2/d\theta^2 log p(\theta|y)]_{\theta=\hat{\theta}}+... \\
&amp;= log p(\hat{\theta|y}) + (1/2)(\theta-\hat{\theta)})^T ( d^2/d\theta^2 log p(\hat{\theta}) + \sum_{i=1}^n d^2/d\theta^2 log p(y_i | \theta)_{\theta=\hat{\theta}} ) \\
log p(\theta|y)  - log p(\hat{\theta|y}) &amp;= + (1/2)(\theta-\hat{\theta)})^T (c  -n* J(\theta_0)) \\
  p(\theta|y ) - p(\hat{\theta}|y) &amp;\propto exp( -\frac{1}{2(nJ(\theta_0))^{-1}}(\theta-\hat{\theta})^T)
\end{aligned}
\]</span>
Which taking the limit as <span class="math inline">\(|\theta -\hat{\theta}| \to 0\)</span>, then the posterior converges to 0 written as <span class="math inline">\(p(\theta|y )- p(\hat{\theta}|y) \to 0\)</span> as <span class="math inline">\(n \to \infty\)</span>, and we have normality.</p>
<p>In discussing large-sample periorties, the concept of Fisher Information , <span class="math inline">\(J(\theta)\)</span>, in the context of Jeffreys’ prior is used.</p>
<p><span class="math display" id="eq:normalapprox">\[\begin{equation}
p(\theta|y) \approx N(\hat{\theta}, [I(\hat{\theta})]^{-1})
\tag{4.2}
\end{equation}\]</span></p>
<p>Where I(<span class="math inline">\(\theta)\)</span> is the <em>observed information</em>
<span class="math display">\[\begin{equation}
I(\theta)= -d^2/d\theta^2 log p(\theta|y)
\end{equation}\]</span></p>
<p>Where is the mode <span class="math inline">\(\hat{\theta}\)</span> is in the interior of the parameter space, then the information is positive definite.</p>
<div id="summarizing-posterior-distributions-by-point-estimates-and-standard-errors" class="section level3 unnumbered hasAnchor">
<h3>Summarizing posterior distributions by point estimates and standard errors<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#summarizing-posterior-distributions-by-point-estimates-and-standard-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From the asymptotic theory, if n is large enough, a posterior distribution is approximated by the normal distribution. A standard inferential summary is the 95<span class="math inline">\(\%\)</span> interval obtained by computing a point estimate <span class="math inline">\(\hat{\theta}\)</span> such as the MLE (which is the posterior under a uniform prior density), plus or minus two standard errors, with the standard error estimated from the information at the estimate <span class="math inline">\(I(\hat{\theta})\)</span>.</p>
</div>
</div>
<div id="large-sample-theory" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Large-sample theory<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#large-sample-theory" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The basic tool of Bayesian inference is asymptotic normality of the posterior distribution, as more data arrive from the same underlying process, the posterior distribution of the parameter vector approaches multivariate normality. Suppose the data are modeled by a parametric family, <span class="math inline">\(p(y|\theta)\)</span>, and a prior p<span class="math inline">\((\theta)\)</span>, and suppose that the true distribution is included in the parametric family (i.e. if <span class="math inline">\(f(y) = p(y|\theta_0))\)</span> then the property of asymptotic normality and <em>consistency</em> holds.</p>
<p>Consistency is defined as the posterior distribution converges to a point mass at the true parameter, <span class="math inline">\(\theta_0\)</span> as n<span class="math inline">\(\to \infty\)</span>.</p>
<p>Note, that if the true distribution is not included in the parametric family, then there is no longer a true parameter to converge to. One must use the <em>Kullback-Leibler divergence</em> to determine the value <span class="math inline">\(\theta_0\)</span> that makes the model distribution closest to the true distribution.</p>
<div id="asymptotic-normality-and-consistency" class="section level3 unnumbered hasAnchor">
<h3>Asymptotic normality and consistency<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#asymptotic-normality-and-consistency" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Under regularity conditions ( the likelihood is a continuous function of <span class="math inline">\(\theta\)</span>, and that <span class="math inline">\(\theta_0\)</span> is not a boundary point), as <span class="math inline">\(n\to \infty\)</span>, the posterior distribution of <span class="math inline">\(\theta\)</span> approaches normality with mean <span class="math inline">\(\theta_0\)</span> and variance (<span class="math inline">\(nJ(\theta_0))^{-1}. Where J(\)</span>)$ is the <em>FIsher information</em> in context fo Jeffreys’ Prior.</p>
<p>The posterior mode is consistent for <span class="math inline">\(\theta_0\)</span>, as <span class="math inline">\(n\to \infty\)</span>, so the mass of the posterior <span class="math inline">\(p(\theta|y)\)</span> becomes concentrated in small neighborhoods of <span class="math inline">\(\theta_0\)</span> and the distance of <span class="math inline">\(|\theta-\theta_0|\to 0\)</span>.</p>
<p>Further, we can write the coefficient of the quadratic term in <a href="asymptotics-and-connections-to-non-bayesian-approaches.html#eq:logdensityquadratic">(4.1)</a>.
<span class="math display">\[\begin{equation}
[d^2/d\theta^2 log p(\theta|y)]_{\theta=\hat{\theta}} =[d^2/d\theta^2log p(\theta)]_{\theta=\hat{\theta}}+\sum_{i=1}^n[d^2/d\theta^2log p(y_i|\theta)]_{\theta=\hat{\theta}}
\end{equation}\]</span></p>
<p>This is considered a function of <span class="math inline">\(\theta\)</span>, as a constant term plus the sum of n terms whose expected value under the true sampling distribution <span class="math inline">\(p(y_i|\theta_0\)</span>)., is approximately <span class="math inline">\(-J(\theta_0)\)</span>, assuming <span class="math inline">\(\hat{\theta}\)</span> is close to <span class="math inline">\(\theta\)</span>.</p>
<p>In summary, as the limit of n, in the context of a family of models posterior mode, <span class="math inline">\(\hat{\theta}\)</span>, approaches the truth <span class="math inline">\(\theta_0\)</span>, and the curvature approaches <span class="math inline">\(nJ(\hat{\theta})\)</span> or nJ(<span class="math inline">\(\theta_0\)</span>). Interesting, as <span class="math inline">\(n\to\infty\)</span> the prior term is a constant, and the likelihood dominates the posterior because the likelihood alone is used to obtain the mode and curvature for the normal approximation.</p>
</div>
</div>
<div id="frequency-evaluations-of-bayesian-inferences" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Frequency evaluations of Bayesian inferences<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#frequency-evaluations-of-bayesian-inferences" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The notion of <em>stable estimation</em> which says that for a fixed model, the posterior approaches a point as more data arrive, leading , in the limit, to inferential certainty, is based on the concepts of repeated sampling. It is certainly appealing that if the hypothesized family of probability models contain the true distribution, then as more information about <span class="math inline">\(\theta\)</span> arrives, the posterior distribution converges to the true value of <span class="math inline">\(\theta\)</span>.</p>
<div id="large-sample-correspondence" class="section level3 unnumbered hasAnchor">
<h3>Large sample correspondence<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#large-sample-correspondence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose that the normal approximation holds <a href="asymptotics-and-connections-to-non-bayesian-approaches.html#eq:normalapprox">(4.2)</a> for the posterior distribution for <span class="math inline">\(\theta\)</span>, then we can transform to the <em>standard</em> normal multivariate normal</p>
<p><span class="math display" id="eq:standardmultivariateapprox">\[\begin{equation}
[I(\hat{\theta})]^{1/2}(\theta-\hat{\theta}) |y \sim N(0,I)
\tag{4.3}
\end{equation}\]</span></p>
<p>Where <span class="math inline">\(\hat{\theta}\)</span> is the posterior mode and <span class="math inline">\([I(\hat{\theta})]^{1/2}\)</span> is any matrix square root of the observed fisher information. In addition to <span class="math inline">\(\hat{\theta}\to \theta_0\)</span> we can write the approximation using I(<span class="math inline">\(\theta_0\)</span>). If the true data distribution is included in the class of models, so that <span class="math inline">\(f(y)= p(y|\theta)\)</span>, then under <em>repeated sampling</em> with fixed <span class="math inline">\(\theta\)</span>, as <span class="math inline">\(n \to \infty\)</span> then</p>
<p><span class="math display" id="eq:classical">\[\begin{equation}
[I(\hat{\theta})]^{1/2}(\theta-\hat{\theta}) |\theta \sim N(0,I)
\tag{4.4}
\end{equation}\]</span></p>
<p>This is generally proven for the MLE, but can be extended for the posterior mode <span class="math inline">\(\hat{\theta}\)</span>. This results suggest that for any function (<span class="math inline">\(\theta-\hat{\theta})\)</span> the posterior distribution derived from <a href="asymptotics-and-connections-to-non-bayesian-approaches.html#eq:standardmultivariateapprox">(4.3)</a> is asymptotically the same as the repeated sampling distribution from <a href="asymptotics-and-connections-to-non-bayesian-approaches.html#eq:classical">(4.4)</a>. Thus for a <span class="math inline">\(95\%\)</span> central posterior interval for <span class="math inline">\(\theta\)</span> will cover the true value 95<span class="math inline">\(\%\)</span> of the time under repeated sampling with any fixed true <span class="math inline">\(\theta.\)</span></p>
</div>
<div id="point-estimation-consistency-and-efficiency" class="section level3 unnumbered hasAnchor">
<h3>Point estimation, consistency, and efficiency<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#point-estimation-consistency-and-efficiency" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For large samples, obtaining an estimate- makes most sense when the posterior mode <span class="math inline">\(\hat{\theta}\)</span> is the obvious center and the <span class="math inline">\(nI(\theta_0\)</span>) is small and practically unimportant. However in smaller samples, one can define optimal point estimates, but it is better to show the full representation of the full posterior distribution. In most problems, the point estimate and the standard error are adequate to summarize the posterior inference. We interpret the estimate as an inferential summary, not as a decision solution / classification.</p>
<p>A point estimate is said to be <em>consistent</em> as the samples get larger, it converges to the true value parameter. Thus if <span class="math inline">\(f(y)=p(y|\theta_0)\)</span>, then a point estimate <span class="math inline">\(\hat{\theta}\)</span> of <span class="math inline">\(\theta\)</span> is consistent if its sampling distribution converges to a point mass at <span class="math inline">\(\theta_0\)</span> for <span class="math inline">\(n\to \infty\)</span>.</p>
<p><em>Asymptotic unbiasedness</em> is defined as <span class="math inline">\((E(\hat{\theta}|\theta_0 - \theta_0))/sd(\hat{\theta}|\theta_0)\)</span> converges to 0 as sample size increases.</p>
<p><em>Efficiency</em> for a point estimate is if there is no other function of y that estimates <span class="math inline">\(\theta\)</span> with lower mean squared error, that is if the expression E((<span class="math inline">\(\hat{\theta}-\theta_0)^2|\theta_0)\)</span> is at its optiomal lowest value. An estimate is asymptotically efficient if its efficiency approaches 1 as the sample size n, increases to infinity.</p>
</div>
<div id="confidence-coverage" class="section level3 unnumbered hasAnchor">
<h3>Confidence coverage<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#confidence-coverage" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If a region C(y) includes <span class="math inline">\(\theta_0\)</span> at least 100(<span class="math inline">\(1-\alpha)\%\)</span> of the time, then C(y) is called the 100(<span class="math inline">\(1-\alpha)\%\)</span> <em>confidence region</em> for parameter <span class="math inline">\(\theta\)</span>. We saw previously that asymptotically a 100(<span class="math inline">\(1-\alpha)\%\)</span> central posterior interval for <span class="math inline">\(\theta\)</span> has the property that , in repeated samples of y, 100(<span class="math inline">\(1-\alpha)\%\)</span> of the intervals include <span class="math inline">\(\theta_0\)</span>.</p>
</div>
</div>
<div id="exercises-3" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Exercises<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="question-1-2" class="section level3 unnumbered hasAnchor">
<h3>Question 1<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-1-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>a using simple calculus we found l’ = <span class="math inline">\(\frac{2*\sum_{i=1}^5(y_i-\theta)}{1+(y_i-\theta)^2}\)</span> and l’’ = <span class="math inline">\(\frac{-2\sum_{i=1}^5((y_i-\theta)^2-1)}{(1+(y_i-\theta)^2)^2}\)</span></li>
</ul>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-1" aria-hidden="true" tabindex="-1"></a>mleCauchy<span class="ot">&lt;-</span><span class="cf">function</span>(x,<span class="at">tolerance=</span><span class="fl">0.001</span>){</span>
<span id="cb264-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-2" aria-hidden="true" tabindex="-1"></a>  startvalue<span class="ot">&lt;-</span><span class="fu">median</span>(x)</span>
<span id="cb264-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-3" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb264-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-4" aria-hidden="true" tabindex="-1"></a>  theta_current<span class="ot">&lt;-</span>startvalue</span>
<span id="cb264-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-5" aria-hidden="true" tabindex="-1"></a>  first_deriv<span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>((x<span class="sc">-</span>theta_current)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>(x<span class="sc">-</span>theta_current)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb264-6"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-7"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>( <span class="fu">abs</span>(first_deriv)<span class="sc">&gt;</span>tolerance){</span>
<span id="cb264-8"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-8" aria-hidden="true" tabindex="-1"></a>  second_deriv<span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(((x<span class="sc">-</span>theta_current)<span class="sc">^</span><span class="dv">2-1</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>(x<span class="sc">-</span>theta_current)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb264-9"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb264-10"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-10" aria-hidden="true" tabindex="-1"></a>  theta_new<span class="ot">&lt;-</span>  theta_current <span class="sc">-</span> first_deriv<span class="sc">/</span>second_deriv</span>
<span id="cb264-11"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-11" aria-hidden="true" tabindex="-1"></a>  theta_current<span class="ot">&lt;-</span>theta_new</span>
<span id="cb264-12"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-12" aria-hidden="true" tabindex="-1"></a>  first_deriv<span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>((x<span class="sc">-</span>theta_current)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>(x<span class="sc">-</span>theta_current)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb264-13"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb264-14"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta_current)</span>
<span id="cb264-15"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb264-16"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-16" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.94</span>,<span class="fl">0.59</span>,<span class="sc">-</span><span class="fl">5.98</span>,<span class="sc">-</span><span class="fl">0.08</span>,<span class="sc">-</span><span class="fl">0.77</span>)</span>
<span id="cb264-17"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb264-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mleCauchy</span>(x,<span class="fl">0.0001</span>)</span></code></pre></div>
<pre><code>## [1] -0.5343968</code></pre>
<ul>
<li>b the MLE for theta is -0.138. Using newton-raphson method for <span class="math inline">\(\theta^{1} = \theta^0 - l&#39;(\theta^0)/l&#39;&#39;(\theta^0)\)</span></li>
</ul>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb266-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>)</span>
<span id="cb266-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb266-2" aria-hidden="true" tabindex="-1"></a> posterior_mode<span class="ot">&lt;-</span><span class="fu">mleCauchy</span>(x,<span class="fl">0.0001</span>)</span>
<span id="cb266-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb266-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(posterior_mode)</span></code></pre></div>
<pre><code>## [1] -0.1376488</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb268-1" aria-hidden="true" tabindex="-1"></a> <span class="do">## optimize function</span></span>
<span id="cb268-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb268-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">optimize</span>(<span class="cf">function</span>(theta) <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dcauchy</span>(x, <span class="at">location=</span>theta, <span class="at">log=</span><span class="cn">TRUE</span>)),  <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">100</span>)) </span></code></pre></div>
<pre><code>## $minimum
## [1] -0.1376593
## 
## $objective
## [1] 11.17292</code></pre>
<p>-c for the normal approximation we use <span class="math inline">\(p(\hat{\theta}|y)\approx N(\hat{\theta}, nI(\theta_0)^-1)\)</span>
<span class="math display">\[
\begin{aligned}
I(\theta) &amp;= E(d/d\theta log p(\theta|y))^2 \\
E[ (\frac{2(y-\theta)}{1+(y-\theta)^2})^2] &amp;= \int_{-\infty}^{\infty}(\frac{2(y-\theta)}{1+(y-\theta)^2})^2 \frac{1}{1+(y-\theta)^2}d\theta\\
&amp;= 8 \int_{0}^{\infty} \frac{u^2}{(1+u^2)^2}du,  u= y-\theta,  du = -d\theta\\
&amp; \text{2nd substitution  } x=\frac{1}{1+u^2} \implies u^2=\frac{1}{x}-1 , du=(1/2)(1/x-1)^{-1/2}(-1/x^2)dx\\
&amp; = -4 \int (1-x)x^2 [1/2 (\frac{1}{x}-1)^{-1/2}(-1/x^2) dx] \\
&amp;2 \int_0^\infty (1-x) (1/x -1)^{-1/2} dx \\
&amp; 2 \int_0^\infty x^{1/2}(1-x)^{1/2} \sim Beta(\alpha=3/2, \beta = 3/2)\\
I(\theta)&amp; = \frac{ 4 \Gamma(3/2)\Gamma(3/2)}{\Gamma(3)} \approx 1.5708
\end{aligned}
\]</span>
<span class="math inline">\(p(\theta| y) \approx N(\hat{\theta}, \sigma^2 = 1/(n*I(\theta)))\)</span></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># need to derived the Fisher information for Cauchy</span></span>
<span id="cb270-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb270-2" aria-hidden="true" tabindex="-1"></a>   fishers.n<span class="ot">&lt;-</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">gamma</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">gamma</span>(<span class="dv">3</span>)))</span>
<span id="cb270-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb270-3" aria-hidden="true" tabindex="-1"></a>   var.approx<span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="fu">length</span>(x)<span class="sc">*</span>fishers.n)</span>
<span id="cb270-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb270-4" aria-hidden="true" tabindex="-1"></a> norm.approx<span class="ot">&lt;-</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="at">mean=</span>posterior_mode,<span class="at">sd=</span><span class="fu">sqrt</span>(var.approx)))</span>
<span id="cb270-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb270-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(norm.approx)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>compare with 2.11 grid approach using the Cauchy distribution, we see that normal approximation has much wider tails compared to the exact distribution, this is because of the small sample size.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-1" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>)</span>
<span id="cb271-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-3" aria-hidden="true" tabindex="-1"></a>  step<span class="ot">=</span><span class="fl">0.01</span></span>
<span id="cb271-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="co">#theta&lt;-seq(from=0,to=100000)/m</span></span>
<span id="cb271-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-5" aria-hidden="true" tabindex="-1"></a> theta<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>,<span class="at">by=</span>step)</span>
<span id="cb271-6"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-6" aria-hidden="true" tabindex="-1"></a> <span class="do">## p(theta | y) ~ p(y|theta)*p(theta)</span></span>
<span id="cb271-7"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-7" aria-hidden="true" tabindex="-1"></a> dens<span class="ot">&lt;-</span><span class="cf">function</span>(y,th){</span>
<span id="cb271-8"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-8" aria-hidden="true" tabindex="-1"></a>   dens0<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb271-9"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-9" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(th)){</span>
<span id="cb271-10"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-10" aria-hidden="true" tabindex="-1"></a>     dens0<span class="ot">&lt;-</span><span class="fu">c</span>(dens0, <span class="fu">prod</span> (<span class="fu">dcauchy</span>(y, th[i],<span class="dv">1</span>)))</span>
<span id="cb271-11"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-11" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb271-12"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-12" aria-hidden="true" tabindex="-1"></a>   dens0</span>
<span id="cb271-13"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-13" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb271-14"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-14" aria-hidden="true" tabindex="-1"></a> <span class="co">#dens(y,theta)</span></span>
<span id="cb271-15"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># L(theta | y) = prod_{i=1}^n  f(y| theta)  we need the product term here.</span></span>
<span id="cb271-16"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-16" aria-hidden="true" tabindex="-1"></a> unnorm.post<span class="ot">&lt;-</span><span class="fu">sapply</span>(theta, <span class="cf">function</span>(x)  <span class="fu">prod</span>(<span class="fu">dcauchy</span>(y,<span class="at">location=</span>x,<span class="at">scale=</span><span class="dv">1</span>) )) <span class="do">## un norm post</span></span>
<span id="cb271-17"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-17" aria-hidden="true" tabindex="-1"></a>   <span class="do">## p(theta| y ) = p(y| theta)p(theta)  where p(theta) is U(0,100)</span></span>
<span id="cb271-18"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-18" aria-hidden="true" tabindex="-1"></a> post<span class="ot">&lt;-</span>unnorm.post<span class="sc">/</span>(step<span class="sc">*</span><span class="fu">sum</span>(unnorm.post))</span>
<span id="cb271-19"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb271-19" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(theta,post,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&#39;Normalized posterior&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span><span class="sc">*</span><span class="fu">max</span>(post)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb272-1" aria-hidden="true" tabindex="-1"></a> samps<span class="ot">&lt;-</span>(<span class="fu">sample</span>(theta,<span class="dv">1000</span>,<span class="at">prob=</span>post<span class="sc">*</span>step,<span class="at">replace=</span>T))</span>
<span id="cb272-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb272-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb272-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb272-3" aria-hidden="true" tabindex="-1"></a>ytilde<span class="ot">&lt;-</span><span class="fu">rcauchy</span>(<span class="dv">1000</span>,<span class="at">location=</span>samps,<span class="at">scale=</span><span class="dv">1</span>) </span>
<span id="cb272-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb272-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(ytilde)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-2.png" width="672" /></p>
</div>
<div id="exercise-2" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#exercise-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To show the analytic information matrix of the bioassay example.</p>
<p>The logistic function has a derivative in the form
<span class="math display">\[\begin{equation}
\partial/\partial\alpha logit^{-1}(\alpha+\beta*x_i) = \frac{exp(\alpha+\beta*x_i)}{(1+exp(\alpha+\beta*x_i))^2}=\frac{logit^{-1}(\alpha+\beta*x_i)}{1+exp(\alpha+\beta*x_i)}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\partial/\partial\beta logit^{-1}(\alpha+\beta*x_i) = \frac{exp(\alpha+\beta*x_i)x_i}{(1+exp(\alpha+\beta*x_i))^2}=\frac{logit^{-1}(\alpha+\beta*x_i)x_i}{1+exp(\alpha+\beta*x_i)}
\end{equation}\]</span></p>
<p>Also by algebra</p>
<p><span class="math display">\[\begin{equation}
\frac{1}{1-logit^{-1}(\alpha+\beta*x_i)} = 1+exp(\alpha+\beta*x_i)
\end{equation}\]</span></p>
<p>Normal approximation using the information
<span class="math display">\[
\begin{aligned}
p(\alpha,\beta | y_i,n_i, x_i) &amp;\propto p(\alpha,\beta)p(y_i | \alpha,\beta,n_i,x_i)\\
&amp;\propto [logit^{-1}(\alpha+\beta*x_i)]^{y_i}[1-logit^{-1}(\alpha+\beta*x_i)]^{n_i-y_y}\\
lp(\alpha,\beta | y_i,n_i, x_i) &amp;\propto y_i log([logit^{-1}(\alpha+\beta*x_i)])+(n_i-y_i)log([1-logit^{-1}(\alpha+\beta*x_i)])\\
\end{aligned}
\]</span>
<span class="math display">\[
\begin{aligned}
\frac{\partial lp}{\partial\alpha} &amp;\propto y_i\frac{1}{logit^{-1}(\alpha+\beta*x_i)}\frac{logit^{-1}(\alpha+\beta*x_i)}{1+exp(\alpha+\beta*x_i)}-\frac{n_i-y_i}{1-logit^{-1}(\alpha+\beta*x_i)}\frac{logit^{-1}(\alpha+\beta*x_i)x_i}{1+exp(\alpha+\beta*x_i)}\\
&amp;=\frac{y_i}{1+exp(\alpha+\beta*x_i)} - (n_i -y_i)logit^{-1}(\alpha+\beta*x_i) \\
&amp; = y_i(1-logit^{-1}(\alpha+\beta*x_i) - (n_i -y_i)logit^{-1}(\alpha+\beta*x_i) \\
&amp;= y_i - n_i*logit^{-1}(\alpha+\beta*x_i)
\end{aligned}
\]</span>
note that
<span class="math display">\[\begin{equation}
\frac{1}{1+exp(\alpha+\beta*x_i)} =1-logit^{-1}(\alpha+\beta*x_i)
\end{equation}\]</span>
<span class="math display">\[
\begin{aligned}
\frac{\partial^2 lp}{\partial\alpha^2} &amp;\propto \frac{-n_i logit^{-1}(\alpha+\beta*x_i)}{1+exp(\alpha+\beta*x_i)}\\
&amp;= logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))n_i
\end{aligned}
\]</span>
<span class="math display">\[
\begin{aligned}
\frac{\partial^2 lp}{\partial\alpha \partial \beta} &amp;\propto \frac{-x_in_i*logit^{-1}(\alpha+\beta*x_i)}{1+exp(\alpha+\beta*x_i)}\\
&amp;= -x_i*n_i*logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial lp}{\partial \beta} &amp;\propto \frac{y_i}{1+exp(\alpha+\beta*x_i)}\frac{logit^{-1}(\alpha+\beta*x_i)}{1+exp(\alpha+\beta*x_i)} + \frac{n_i-y_i}{1-logit^{-1}(\alpha+\beta*x_i)}\frac{-x_i*logit^{-1}(\alpha+\beta*x_i)}{1+exp(\alpha+\beta*x_i)}\\
&amp;\propto y_i*x_i(1-logit^{-1}(\alpha+\beta*x_i))-x_i(n_i-y_i)logit^{-1}(\alpha+\beta*x_i)
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial^2 lp}{\partial \beta^2} &amp;\propto x_iy_i (\frac{-x_ilogit^{-1}(\alpha+\beta*x_i)}{1+exp(\alpha+\beta*x_i)})-x_i(n_i-y_i)\frac{logit^{-1}(\alpha+\beta*x_i)}{1+exp(\alpha+\beta*x_i)}\\
&amp;= logit^{-1}(\alpha+\beta*x_i)x_i^2 -y_i(1-logit^{-1}(\alpha+\beta*x_i))-(n_i-y_i)(1-logit^{-1}(\alpha+\beta*x_i))\\
&amp;= logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))(-n_ix_i^2)
\end{aligned}
\]</span>
Now the information matrix is evaluated at the posterior mode <span class="math inline">\(\hat{\alpha}\)</span></p>
<p><span class="math display">\[
I(\alpha,\beta) = \begin{bmatrix} \sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))n_i &amp; \sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_in_i\\
\sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_in_i &amp; \sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_i^2n_i\\
\end{bmatrix}_{\alpha,\beta = \hat{\alpha},\hat{\beta}}
\]</span>
<span class="math display">\[\begin{equation}
p(\theta|y) \approx N(\hat{\alpha},\hat{\beta}, I(\alpha,\beta)^{-1})
\end{equation}\]</span></p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb273-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(magrittr)</span>
<span id="cb273-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(dplyr)</span>
<span id="cb273-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(ggplot2)</span>
<span id="cb273-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-5" aria-hidden="true" tabindex="-1"></a> assay<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.86</span>,<span class="sc">-</span><span class="fl">0.30</span>,<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">0.73</span>), <span class="at">n=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb273-6"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-7"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-7" aria-hidden="true" tabindex="-1"></a>inv.logit<span class="ot">&lt;-</span><span class="cf">function</span>(theta){</span>
<span id="cb273-8"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( (<span class="fu">exp</span>(theta)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(theta)))  )</span>
<span id="cb273-9"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb273-10"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matlib)</span>
<span id="cb273-11"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-12"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-12" aria-hidden="true" tabindex="-1"></a><span class="do">### normal approximation</span></span>
<span id="cb273-13"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-13" aria-hidden="true" tabindex="-1"></a> alpha_hat<span class="ot">&lt;-</span><span class="fl">1.353</span></span>
<span id="cb273-14"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-14" aria-hidden="true" tabindex="-1"></a> beta_hat<span class="ot">&lt;-</span><span class="fl">11.634</span></span>
<span id="cb273-15"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-16"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb273-17"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-17" aria-hidden="true" tabindex="-1"></a>I_hat_theta<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">sum</span>(<span class="fu">inv.logit</span>(alpha_hat<span class="sc">+</span>beta_hat<span class="sc">*</span>assay<span class="sc">$</span>x)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">inv.logit</span>(alpha_hat<span class="sc">+</span>beta_hat<span class="sc">*</span>assay<span class="sc">$</span>x))<span class="sc">*</span>assay<span class="sc">$</span>n),</span>
<span id="cb273-18"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-18" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sum</span>(<span class="fu">inv.logit</span>(alpha_hat<span class="sc">+</span>beta_hat<span class="sc">*</span>assay<span class="sc">$</span>x)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">inv.logit</span>(alpha_hat<span class="sc">+</span>beta_hat<span class="sc">*</span>assay<span class="sc">$</span>x))<span class="sc">*</span>assay<span class="sc">$</span>n<span class="sc">*</span>assay<span class="sc">$</span>x),</span>
<span id="cb273-19"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-19" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sum</span>(<span class="fu">inv.logit</span>(alpha_hat<span class="sc">+</span>beta_hat<span class="sc">*</span>assay<span class="sc">$</span>x)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">inv.logit</span>(alpha_hat<span class="sc">+</span>beta_hat<span class="sc">*</span>assay<span class="sc">$</span>x))<span class="sc">*</span>assay<span class="sc">$</span>n<span class="sc">*</span>assay<span class="sc">$</span>x),</span>
<span id="cb273-20"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-20" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sum</span>(<span class="fu">inv.logit</span>(alpha_hat<span class="sc">+</span>beta_hat<span class="sc">*</span>assay<span class="sc">$</span>x)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">inv.logit</span>(alpha_hat<span class="sc">+</span>beta_hat<span class="sc">*</span>assay<span class="sc">$</span>x))<span class="sc">*</span>assay<span class="sc">$</span>n<span class="sc">*</span>assay<span class="sc">$</span>x<span class="sc">*</span>assay<span class="sc">$</span>x)),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb273-21"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-22"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-22" aria-hidden="true" tabindex="-1"></a><span class="do">## asymptotic variance (a,b)</span></span>
<span id="cb273-23"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-23" aria-hidden="true" tabindex="-1"></a>invI<span class="ot">&lt;-</span>matlib<span class="sc">::</span><span class="fu">inv</span>(I_hat_theta)</span>
<span id="cb273-24"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-25"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-25" aria-hidden="true" tabindex="-1"></a>norm.approx<span class="ot">&lt;-</span><span class="fu">rmvnorm</span>(<span class="dv">1000</span>,<span class="at">mean=</span><span class="fu">c</span>(alpha_hat,beta_hat),<span class="at">sigma=</span>invI)</span>
<span id="cb273-26"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-26" aria-hidden="true" tabindex="-1"></a> <span class="fu">colnames</span>(norm.approx)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)</span>
<span id="cb273-27"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb273-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(norm.approx,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">10</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">40</span>)) <span class="co"># figure 4.1(b) </span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
<div id="exercise-3" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#exercise-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A reasonable estimate for the posterior mode and standard deviation as proxy to the asymptotic values will utilize a GLM, where <span class="math inline">\(\theta= \frac{-\alpha}{\beta}\)</span>= -0.109 (-0.15,0.37) as the limit values.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-1" aria-hidden="true" tabindex="-1"></a> dr<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">xi=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="sc">-</span><span class="fl">0.86</span>,<span class="dv">5</span>),</span>
<span id="cb274-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-2" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">rep</span>(<span class="sc">-</span><span class="fl">0.30</span>,<span class="dv">5</span>),</span>
<span id="cb274-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">rep</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="dv">5</span>),</span>
<span id="cb274-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">rep</span>(<span class="fl">0.73</span>,<span class="dv">5</span>)),</span>
<span id="cb274-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">yi=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb274-6"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-6" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>),</span>
<span id="cb274-7"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-7" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),</span>
<span id="cb274-8"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-8" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>)))</span>
<span id="cb274-9"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-10"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-10" aria-hidden="true" tabindex="-1"></a>bioassay<span class="ot">&lt;-</span><span class="fu">glm</span>(yi<span class="sc">~</span>xi,<span class="at">family=</span><span class="st">&#39;binomial&#39;</span>,dr)</span>
<span id="cb274-11"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-11" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(bioassay)</span></span>
<span id="cb274-12"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-12" aria-hidden="true" tabindex="-1"></a> ab<span class="ot">&lt;-</span><span class="fu">coef</span>(bioassay)</span>
<span id="cb274-13"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb274-13" aria-hidden="true" tabindex="-1"></a> ab<span class="ot">&lt;-</span><span class="fu">cbind</span>(ab,<span class="fu">confint</span>(bioassay))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb276-1" aria-hidden="true" tabindex="-1"></a> ld50<span class="ot">&lt;-</span><span class="sc">-</span>ab[<span class="dv">1</span>,]<span class="sc">/</span>ab[<span class="dv">2</span>,]</span>
<span id="cb276-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb276-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(ld50)</span></code></pre></div>
<pre><code>##         ab      2.5 %     97.5 % 
## -0.1092528  0.3663445 -0.1560259</code></pre>
<p>Using a uniform prior, we compute the Bayesian posterior for <span class="math inline">\(\theta=-\alpha/\beta\)</span> using posterior distribution for <span class="math inline">\(p(\alpha,\beta|y)\)</span> and then compute <span class="math inline">\(\theta\)</span> with interval -0.1049 (-0.27, 0.09) and the standard deviation is 0.0988. This reproduces figure 3.3 from section 3.7</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-1" aria-hidden="true" tabindex="-1"></a> <span class="do">## compare with the Bayesian approximation using 3.16 from section 3.7</span></span>
<span id="cb278-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(mvtnorm)</span>
<span id="cb278-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(magrittr)</span>
<span id="cb278-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(dplyr)</span>
<span id="cb278-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(ggplot2)</span>
<span id="cb278-6"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-6" aria-hidden="true" tabindex="-1"></a> assay<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.86</span>,<span class="sc">-</span><span class="fl">0.30</span>,<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">0.73</span>), <span class="at">n=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb278-7"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-8"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-8" aria-hidden="true" tabindex="-1"></a> <span class="do">## the point a,b by MLE is (0.8,7.7) so we grid around these solution.</span></span>
<span id="cb278-9"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-9" aria-hidden="true" tabindex="-1"></a> a0<span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">10</span>,<span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb278-10"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-10" aria-hidden="true" tabindex="-1"></a> b1<span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">40</span>,<span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb278-11"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-11" aria-hidden="true" tabindex="-1"></a>  a0b1<span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(a0, b1)</span>
<span id="cb278-12"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-13"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-13" aria-hidden="true" tabindex="-1"></a>logit<span class="ot">&lt;-</span><span class="cf">function</span>(theta){</span>
<span id="cb278-14"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">log</span>(theta<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>theta)))</span>
<span id="cb278-15"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb278-16"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-17"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-17" aria-hidden="true" tabindex="-1"></a>inv.logit<span class="ot">&lt;-</span><span class="cf">function</span>(theta){</span>
<span id="cb278-18"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( (<span class="fu">exp</span>(theta)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(theta)))  )</span>
<span id="cb278-19"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb278-20"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-21"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-21" aria-hidden="true" tabindex="-1"></a> <span class="do">## equation 3.16 using the uniform</span></span>
<span id="cb278-22"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-22" aria-hidden="true" tabindex="-1"></a><span class="do">## alpha, beta come from uniform distribution</span></span>
<span id="cb278-23"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-23" aria-hidden="true" tabindex="-1"></a> <span class="do">## \prod_(i=1)^5 p(y|theta) ~ \theta^y (1-theta)^n-y ## kth dose. </span></span>
<span id="cb278-24"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-24" aria-hidden="true" tabindex="-1"></a>  <span class="do">### logit(theta) = alpha+ beta*x</span></span>
<span id="cb278-25"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-25" aria-hidden="true" tabindex="-1"></a>logit.likelihood<span class="ot">&lt;-</span><span class="cf">function</span>(alpha,beta,x,y,n){</span>
<span id="cb278-26"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-26" aria-hidden="true" tabindex="-1"></a>   theta_approx<span class="ot">&lt;-</span> alpha<span class="sc">+</span>beta<span class="sc">*</span>x</span>
<span id="cb278-27"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-27" aria-hidden="true" tabindex="-1"></a>   bin.like<span class="ot">&lt;-</span>(<span class="fu">inv.logit</span>(theta_approx))<span class="sc">^</span>y<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">inv.logit</span>(theta_approx))<span class="sc">^</span>(n<span class="sc">-</span>y)</span>
<span id="cb278-28"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-28" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(bin.like)</span>
<span id="cb278-29"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-29" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb278-30"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-31"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-31" aria-hidden="true" tabindex="-1"></a> <span class="do">## the alpha,beta stem from the grid, and we return the probability mass from the prior.</span></span>
<span id="cb278-32"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-32" aria-hidden="true" tabindex="-1"></a><span class="do">## uniform prior p(a,b) ~ 1</span></span>
<span id="cb278-33"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-33" aria-hidden="true" tabindex="-1"></a> joint.prior<span class="ot">&lt;-</span><span class="cf">function</span>(alpha,beta){</span>
<span id="cb278-34"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-34" aria-hidden="true" tabindex="-1"></a>  prob.ab<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb278-35"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(prob.ab)</span>
<span id="cb278-36"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-36" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb278-37"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb278-38"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-38" aria-hidden="true" tabindex="-1"></a> posterior_density<span class="ot">&lt;-</span><span class="cf">function</span>(alpha,beta,assay){</span>
<span id="cb278-39"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-39" aria-hidden="true" tabindex="-1"></a>   joint_density<span class="ot">&lt;-</span><span class="fu">joint.prior</span>(alpha,beta)</span>
<span id="cb278-40"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-40" aria-hidden="true" tabindex="-1"></a>   probs<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb278-41"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-41" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(assay)){</span>
<span id="cb278-42"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-42" aria-hidden="true" tabindex="-1"></a>     p<span class="ot">&lt;-</span><span class="fu">logit.likelihood</span>(alpha,beta,assay<span class="sc">$</span>x[k],assay<span class="sc">$</span>y[k],assay<span class="sc">$</span>n[k])</span>
<span id="cb278-43"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-43" aria-hidden="true" tabindex="-1"></a>     probs<span class="ot">&lt;-</span><span class="fu">c</span>(probs,p)</span>
<span id="cb278-44"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-44" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb278-45"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-45" aria-hidden="true" tabindex="-1"></a>   totalLikelihood<span class="ot">&lt;-</span><span class="fu">prod</span>(probs)</span>
<span id="cb278-46"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-46" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>( joint_density<span class="sc">*</span>totalLikelihood)</span>
<span id="cb278-47"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-47" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb278-48"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-48" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb278-49"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-49" aria-hidden="true" tabindex="-1"></a>  posts<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb278-50"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-50" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb278-51"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-51" aria-hidden="true" tabindex="-1"></a> <span class="do">## unnormalized posterior over grid which covers (a,b)</span></span>
<span id="cb278-52"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(a0b1)){</span>
<span id="cb278-53"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-53" aria-hidden="true" tabindex="-1"></a>  posts[i]<span class="ot">&lt;-</span><span class="fu">posterior_density</span>(a0b1[i,<span class="st">&quot;Var1&quot;</span>],a0b1[i,<span class="st">&quot;Var2&quot;</span>],assay) </span>
<span id="cb278-54"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb278-55"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb278-56"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb278-57"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-57" aria-hidden="true" tabindex="-1"></a> posts_norm<span class="ot">&lt;-</span>posts<span class="sc">/</span><span class="fu">sum</span>(posts)</span>
<span id="cb278-58"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-58" aria-hidden="true" tabindex="-1"></a> a0b1<span class="sc">$</span>joint.prob<span class="ot">&lt;-</span>posts_norm</span>
<span id="cb278-59"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-59" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb278-60"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-60" aria-hidden="true" tabindex="-1"></a> <span class="do">## grid sampling procedure</span></span>
<span id="cb278-61"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-61" aria-hidden="true" tabindex="-1"></a>  marginal.post_a<span class="ot">&lt;-</span> a0b1<span class="sc">%&gt;%</span><span class="fu">group_by</span>(Var1)<span class="sc">%&gt;%</span><span class="fu">summarise</span>(<span class="at">p=</span><span class="fu">sum</span>(joint.prob))<span class="sc">%&gt;%</span>data.frame</span>
<span id="cb278-62"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-62" aria-hidden="true" tabindex="-1"></a>    A<span class="ot">&lt;-</span>B<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb278-63"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>){</span>
<span id="cb278-64"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-64" aria-hidden="true" tabindex="-1"></a>    a_s<span class="ot">&lt;-</span><span class="fu">sample</span>(marginal.post_a<span class="sc">$</span>Var1,<span class="dv">1</span>,<span class="at">prob=</span>marginal.post_a<span class="sc">$</span>p)</span>
<span id="cb278-65"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-65" aria-hidden="true" tabindex="-1"></a>    p.a_s<span class="ot">&lt;-</span>marginal.post_a[<span class="fu">which</span>(marginal.post_a<span class="sc">$</span>Var1<span class="sc">==</span>a_s),<span class="st">&#39;p&#39;</span>]</span>
<span id="cb278-66"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-66" aria-hidden="true" tabindex="-1"></a>    marginal.post_b<span class="ot">&lt;-</span>a0b1[<span class="fu">which</span>(a0b1<span class="sc">$</span>Var1<span class="sc">==</span>a_s),]</span>
<span id="cb278-67"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-67" aria-hidden="true" tabindex="-1"></a>    marginal.post_b<span class="sc">$</span>cond.prob<span class="ot">&lt;-</span>marginal.post_b<span class="sc">$</span>joint.prob<span class="sc">/</span>p.a_s</span>
<span id="cb278-68"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-68" aria-hidden="true" tabindex="-1"></a>    b_s<span class="ot">&lt;-</span><span class="fu">sample</span>(marginal.post_b<span class="sc">$</span>Var2,<span class="dv">1</span>,<span class="at">prob=</span>marginal.post_b<span class="sc">$</span>cond.prob)</span>
<span id="cb278-69"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-69" aria-hidden="true" tabindex="-1"></a>    A<span class="ot">&lt;-</span><span class="fu">c</span>(A,a_s)</span>
<span id="cb278-70"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-70" aria-hidden="true" tabindex="-1"></a>    B<span class="ot">&lt;-</span><span class="fu">c</span>(B,b_s)</span>
<span id="cb278-71"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-71" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb278-72"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-72" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb278-73"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-73" aria-hidden="true" tabindex="-1"></a>    <span class="do">### need to add a random jitter around each point.</span></span>
<span id="cb278-74"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-74" aria-hidden="true" tabindex="-1"></a>    Ajit<span class="ot">&lt;-</span>A<span class="sc">+</span><span class="fu">runif</span>(<span class="fu">length</span>(A),<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="fl">0.1</span>)</span>
<span id="cb278-75"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-75" aria-hidden="true" tabindex="-1"></a>    Bjit<span class="ot">&lt;-</span>B<span class="sc">+</span><span class="fu">runif</span>(<span class="fu">length</span>(B),<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="fl">0.1</span>)</span>
<span id="cb278-76"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-76" aria-hidden="true" tabindex="-1"></a>   ab.post<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">A=</span>Ajit,<span class="at">B=</span>Bjit)</span>
<span id="cb278-77"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-77" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(a0b1)<span class="sc">+</span></span>
<span id="cb278-78"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-78" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">z =</span> posts), <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb278-79"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb278-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> ab.post, <span class="fu">aes</span>(<span class="at">x =</span> A, <span class="at">y =</span> B), <span class="at">pch =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb279-1" aria-hidden="true" tabindex="-1"></a> <span class="do">## posterior means (1.35,11.6)</span></span>
<span id="cb279-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb279-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;posterior mean for A :&#39;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(A),<span class="dv">3</span>),<span class="st">&#39; B &#39;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(B),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## posterior mean for A :1.31 B 11.686</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb281-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">quantile</span>(<span class="sc">-</span>A<span class="sc">/</span>B,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## -0.2777954  0.1063830</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb283-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;posterio std.dev -a/b: &#39;</span>,<span class="fu">round</span>(<span class="fu">sd</span>(<span class="sc">-</span>A<span class="sc">/</span>B),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## posterio std.dev -a/b: 0.096</code></pre>
<div id="q3-delta-method-approximation" class="section level4 unnumbered hasAnchor">
<h4>Q3 Delta method approximation<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#q3-delta-method-approximation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using the <em>delta-method</em> and the correlation matrix computed from Q2. The delta method can be used to derive a normal approximation.</p>
<p><span class="math display">\[\begin{equation}
\sqrt{n}(\hat{\alpha}/\hat{\beta}-\alpha/\beta) \to N(0, \nabla \frac{\alpha}{\beta}^T \Sigma \nabla \frac{\alpha}{\beta})
\end{equation}\]</span></p>
<p><span class="math display">\[
\begin{aligned}
V(\alpha/\beta)&amp;=(\frac{1}{\beta},\frac{-\alpha}{\beta^2})\begin{bmatrix} \sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))n_i &amp; \sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_in_i\\
\sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_in_i &amp; \sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_i^2n_i\\
\end{bmatrix}\begin{pmatrix} 1/\beta \\ -\alpha/\beta^2 \end{pmatrix}\\
&amp;=\begin{pmatrix} \sum_i \frac{1}{\beta} logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))n_i -\frac{-\alpha}{\beta^2}\sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_in_i \\
\sum_i \frac{1}{\beta} logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_in_i -\frac{-\alpha}{\beta^2} \sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_i^2n_i \end{pmatrix}\begin{pmatrix} 1/\beta \\ -\alpha/\beta^2 \end{pmatrix}\\
&amp;= \sum_i \frac{1}{\beta^2} logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))n_i -\frac{-2\alpha}{\beta^3}\sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_in_i+\frac{\alpha^2}{\beta^4}\sum_i logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))x_i^2n_i\\
&amp;=\sum_i \frac{n_i*logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))}{\beta^2}(\frac{\alpha^2 x_i^2}{\beta^2}-\frac{2\alpha}{\beta}x_i+1)\\
&amp;=\sum_i \frac{n_i*logit^{-1}(\alpha+\beta*x_i)(1-logit^{-1}(\alpha+\beta*x_i))}{\beta^2}(\frac{\alpha x_i}{\beta}-1)^2_{\alpha,\beta = \hat{\alpha},\hat{\beta}}
\end{aligned}
\]</span></p>
<p>Using the derivation of the delta method shown above, we input the posterior means into the equation and derive the variance to the normal approximation. the posterior mean is approximately 0.109 with <span class="math inline">\(\sigma = 0.107\)</span>. The solution from the author derived the <span class="math inline">\(\sigma = 0.096\)</span> so we are very close.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb285-1" aria-hidden="true" tabindex="-1"></a> theor.var<span class="ot">&lt;-</span><span class="fu">sum</span>((assay<span class="sc">$</span>n<span class="sc">/</span>beta_hat<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">inv.logit</span>(alpha_hat<span class="sc">+</span>beta_hat<span class="sc">*</span>assay<span class="sc">$</span>x)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">inv.logit</span>(alpha_hat<span class="sc">+</span>beta_hat<span class="sc">*</span>assay<span class="sc">$</span>x))<span class="sc">*</span>((alpha_hat<span class="sc">/</span>beta_hat)<span class="sc">*</span>assay<span class="sc">$</span>x<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb285-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb285-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&#39;the theoretical std dev:&#39;</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(theor.var),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## the theoretical std dev:0.109</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb287-1" aria-hidden="true" tabindex="-1"></a>  emp.var<span class="ot">&lt;-</span><span class="fu">var</span>(<span class="sc">-</span>A<span class="sc">/</span>B)</span>
<span id="cb287-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb287-2" aria-hidden="true" tabindex="-1"></a> ld50_normApprox<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="fu">mean</span>(<span class="sc">-</span>A<span class="sc">/</span>B),<span class="at">sd=</span><span class="fu">sqrt</span>(theor.var))</span>
<span id="cb287-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb287-3" aria-hidden="true" tabindex="-1"></a>  ld50_normApprox<span class="sc">%&gt;%</span><span class="fu">hist</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>,<span class="fl">0.6</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb288-1" aria-hidden="true" tabindex="-1"></a> ld50_hat<span class="ot">&lt;-</span><span class="fu">mean</span>(ld50_normApprox)  <span class="do">## poster mean (should use the mode but close enough)</span></span>
<span id="cb288-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb288-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb288-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb288-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;normal approx posterior mean &#39;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(ld50_normApprox),<span class="dv">3</span>),<span class="st">&#39; std. dev &#39;</span>,<span class="fu">round</span>(<span class="fu">sd</span>(ld50_normApprox),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## normal approx posterior mean -0.107 std. dev 0.107</code></pre>
</div>
</div>
<div id="question-4.2-using-the-posterior-sampling-via-grid-approach" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Question 4.2 using the posterior sampling via grid approach<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-4.2-using-the-posterior-sampling-via-grid-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We derive the posterior marginal using a grid approach and the fact that the jacobian = <span class="math inline">\(|\nu|\)</span> and we let <span class="math inline">\(\theta= -\alpha/\beta\)</span> and <span class="math inline">\(\nu=\beta\)</span> to solve for the change of variables.</p>
<p><span class="math display">\[
p(\theta|y) = \int p(\theta,\nu|y)d\nu = \int p(\alpha,\beta|y)|\nu|d\nu
=\int \prod_i logit^{-1}(-\theta*\nu+\nu*x_i)(1-logit^{-1}(-\theta*\nu+\nu*x_i))|\nu|d\nu
\]</span></p>
<p>We use the grid approach described in section 3.7 to sample from the posterior of <span class="math inline">\(p(\theta,\nu)\)</span> where <span class="math inline">\(\theta\)</span> =LD50 term.</p>
<p>The posterior mean is -0.1055, with marginal posterior standard deviation of 0.092.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-1" aria-hidden="true" tabindex="-1"></a> <span class="do">## using change of variable equation -\theta*nu +nu*xi in the likelihood</span></span>
<span id="cb290-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-2" aria-hidden="true" tabindex="-1"></a> logit.likelihood.variableChange<span class="ot">&lt;-</span><span class="cf">function</span>(alpha,beta,x,y,n){</span>
<span id="cb290-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-3" aria-hidden="true" tabindex="-1"></a>   theta_approx<span class="ot">&lt;-</span> <span class="sc">-</span>alpha<span class="sc">*</span>beta<span class="sc">+</span>beta<span class="sc">*</span>x</span>
<span id="cb290-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-4" aria-hidden="true" tabindex="-1"></a>   bin.like<span class="ot">&lt;-</span>(<span class="fu">inv.logit</span>(theta_approx))<span class="sc">^</span>y<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">inv.logit</span>(theta_approx))<span class="sc">^</span>(n<span class="sc">-</span>y)</span>
<span id="cb290-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(bin.like)</span>
<span id="cb290-6"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-6" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb290-7"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb290-8"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-8" aria-hidden="true" tabindex="-1"></a><span class="do">### re-doing based on sampling</span></span>
<span id="cb290-9"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-9" aria-hidden="true" tabindex="-1"></a> posterior_density_Jacobian<span class="ot">&lt;-</span><span class="cf">function</span>(alpha,beta,assay,jacobian){</span>
<span id="cb290-10"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-10" aria-hidden="true" tabindex="-1"></a>   joint_density<span class="ot">&lt;-</span><span class="fu">joint.prior</span>(alpha,beta)</span>
<span id="cb290-11"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-11" aria-hidden="true" tabindex="-1"></a>   probs<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb290-12"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-12" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(assay)){</span>
<span id="cb290-13"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-13" aria-hidden="true" tabindex="-1"></a>     p<span class="ot">&lt;-</span><span class="fu">logit.likelihood.variableChange</span>(alpha,beta,assay<span class="sc">$</span>x[k],assay<span class="sc">$</span>y[k],assay<span class="sc">$</span>n[k])</span>
<span id="cb290-14"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-14" aria-hidden="true" tabindex="-1"></a>     probs<span class="ot">&lt;-</span><span class="fu">c</span>(probs,p)</span>
<span id="cb290-15"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-15" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb290-16"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-16" aria-hidden="true" tabindex="-1"></a>   totalLikelihood<span class="ot">&lt;-</span><span class="fu">prod</span>(probs)<span class="sc">*</span><span class="fu">abs</span>(jacobian)</span>
<span id="cb290-17"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>( joint_density<span class="sc">*</span>totalLikelihood)</span>
<span id="cb290-18"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-18" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb290-19"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-19" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb290-20"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-20" aria-hidden="true" tabindex="-1"></a>theta_seq<span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="at">by=</span><span class="fl">0.001</span>) <span class="do">## alpha</span></span>
<span id="cb290-21"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-21" aria-hidden="true" tabindex="-1"></a><span class="do">### numerical integration</span></span>
<span id="cb290-22"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-22" aria-hidden="true" tabindex="-1"></a> nu_seq<span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">70</span>,<span class="at">by=</span><span class="fl">0.05</span>) <span class="do">## beta</span></span>
<span id="cb290-23"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-24"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-24" aria-hidden="true" tabindex="-1"></a>  thetaNu<span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(theta_seq, nu_seq)</span>
<span id="cb290-25"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-25" aria-hidden="true" tabindex="-1"></a>  posts<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb290-26"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(thetaNu)){</span>
<span id="cb290-27"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-27" aria-hidden="true" tabindex="-1"></a>  posts[i]<span class="ot">&lt;-</span><span class="fu">posterior_density_Jacobian</span>(thetaNu[i,<span class="st">&quot;Var1&quot;</span>],thetaNu[i,<span class="st">&quot;Var2&quot;</span>],assay,<span class="at">jacobian =</span> thetaNu[i,<span class="st">&quot;Var2&quot;</span>]) </span>
<span id="cb290-28"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb290-29"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb290-30"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-30" aria-hidden="true" tabindex="-1"></a>  posts_norm<span class="ot">&lt;-</span>posts<span class="sc">/</span><span class="fu">sum</span>(posts)</span>
<span id="cb290-31"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-31" aria-hidden="true" tabindex="-1"></a> thetaNu<span class="sc">$</span>joint.prob<span class="ot">&lt;-</span>posts_norm</span>
<span id="cb290-32"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-32" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb290-33"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-33" aria-hidden="true" tabindex="-1"></a> <span class="do">## grid sampling procedure</span></span>
<span id="cb290-34"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-34" aria-hidden="true" tabindex="-1"></a> <span class="do">## marginal post of alpha by summing over nu terms</span></span>
<span id="cb290-35"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-35" aria-hidden="true" tabindex="-1"></a>  marginal.post_theta<span class="ot">&lt;-</span> thetaNu<span class="sc">%&gt;%</span><span class="fu">group_by</span>(Var1)<span class="sc">%&gt;%</span><span class="fu">summarise</span>(<span class="at">p=</span><span class="fu">sum</span>(joint.prob))<span class="sc">%&gt;%</span>data.frame</span>
<span id="cb290-36"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-36" aria-hidden="true" tabindex="-1"></a>    thetas.post<span class="ot">&lt;-</span>nu.post<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb290-37"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-37" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>){</span>
<span id="cb290-38"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-38" aria-hidden="true" tabindex="-1"></a>    a_s<span class="ot">&lt;-</span><span class="fu">sample</span>(marginal.post_theta<span class="sc">$</span>Var1,<span class="dv">1</span>,<span class="at">prob=</span>marginal.post_theta<span class="sc">$</span>p)</span>
<span id="cb290-39"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-39" aria-hidden="true" tabindex="-1"></a>    p.a_s<span class="ot">&lt;-</span>marginal.post_theta[<span class="fu">which</span>(marginal.post_theta<span class="sc">$</span>Var1<span class="sc">==</span>a_s),<span class="st">&#39;p&#39;</span>]</span>
<span id="cb290-40"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span></span>
<span id="cb290-41"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-41" aria-hidden="true" tabindex="-1"></a>    marginal.post_b<span class="ot">&lt;-</span>thetaNu[<span class="fu">which</span>(thetaNu<span class="sc">$</span>Var1<span class="sc">==</span>a_s),]</span>
<span id="cb290-42"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-42" aria-hidden="true" tabindex="-1"></a>    marginal.post_b<span class="sc">$</span>cond.prob<span class="ot">&lt;-</span>marginal.post_b<span class="sc">$</span>joint.prob<span class="sc">/</span>p.a_s</span>
<span id="cb290-43"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-43" aria-hidden="true" tabindex="-1"></a>    b_s<span class="ot">&lt;-</span><span class="fu">sample</span>(marginal.post_b<span class="sc">$</span>Var2,<span class="dv">1</span>,<span class="at">prob=</span>marginal.post_b<span class="sc">$</span>cond.prob)</span>
<span id="cb290-44"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-44" aria-hidden="true" tabindex="-1"></a>    thetas.post<span class="ot">&lt;-</span><span class="fu">c</span>(thetas.post,a_s)</span>
<span id="cb290-45"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-45" aria-hidden="true" tabindex="-1"></a>    nu.post<span class="ot">&lt;-</span><span class="fu">c</span>(nu.post,b_s)</span>
<span id="cb290-46"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-46" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb290-47"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb290-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(thetas.post,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="at">main=</span><span class="st">&#39;posterior sample theta= -a/b&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb291-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;sample posterior mean: &#39;</span>, <span class="fu">mean</span>(thetas.post))</span></code></pre></div>
<pre><code>## sample posterior mean: -0.1069205</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb293-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;sample posterior variance: &#39;</span>, <span class="fu">round</span>(<span class="fu">var</span>(thetas.post),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## sample posterior variance: 0.009</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb295-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;sample posterior std.dev: &#39;</span>, <span class="fu">round</span>(<span class="fu">sd</span>(thetas.post),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## sample posterior std.dev: 0.092</code></pre>
</div>
<div id="taylor-series-approximation-of-the-information-matrix" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Taylor series approximation of the information matrix<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#taylor-series-approximation-of-the-information-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Taylor series expansion to approximate <span class="math inline">\(d^2log p(\hat{\theta}|y)/d\theta^2 \approx \frac{f(\hat{\theta}+h)+f(\hat{\theta}-h)-2f(\hat{\theta})}{h^2}\)</span> centered on the posterior mean <span class="math inline">\(\hat{\theta}\)</span> within a neighborhood h=0.002.</p>
<p><span class="math display">\[
\begin{aligned}
f(a+h) &amp;\approx f(a) +h&#39;f(a) +1/2 h^2f&#39;&#39;(a) \\
  f(a-h) &amp;\approx f(a) -h&#39;f(a) +1/2 h^2f&#39;&#39;(a) \\
\to f&#39;&#39;(a) \approx \frac{f(a+h)+f(a-h)-2f(a)}{h^2}
\end{aligned}
\]</span></p>
<p>Using a numerical approximation of <span class="math inline">\(p(\theta|y)\)</span> from the grid approach had <span class="math inline">\(\sigma = 0.064\)</span> which is lower than we would expect from the theoretical delta method.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(DescTools)</span>
<span id="cb297-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-2" aria-hidden="true" tabindex="-1"></a> theta_approx<span class="ot">&lt;-</span> <span class="fu">mean</span>(thetas.post)</span>
<span id="cb297-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-3" aria-hidden="true" tabindex="-1"></a> h<span class="ot">=</span><span class="fl">0.002</span></span>
<span id="cb297-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-4" aria-hidden="true" tabindex="-1"></a> a<span class="ot">&lt;-</span>marginal.post_theta[<span class="fu">which</span>(<span class="fu">abs</span>(marginal.post_theta<span class="sc">$</span>Var1<span class="sc">-</span>theta_approx)<span class="sc">==</span><span class="fu">min</span>(<span class="fu">abs</span>(marginal.post_theta<span class="sc">$</span>Var1<span class="sc">-</span>theta_approx))),]</span>
<span id="cb297-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-5" aria-hidden="true" tabindex="-1"></a> ah<span class="ot">&lt;-</span>marginal.post_theta[<span class="fu">which</span>(<span class="fu">abs</span>(marginal.post_theta<span class="sc">$</span>Var1<span class="sc">-</span>theta_approx<span class="sc">-</span>h)<span class="sc">==</span><span class="fu">min</span>(<span class="fu">abs</span>(marginal.post_theta<span class="sc">$</span>Var1<span class="sc">-</span>theta_approx<span class="sc">-</span>h))),]</span>
<span id="cb297-6"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-6" aria-hidden="true" tabindex="-1"></a> adh<span class="ot">&lt;-</span>marginal.post_theta[<span class="fu">which</span>(<span class="fu">abs</span>(marginal.post_theta<span class="sc">$</span>Var1<span class="sc">-</span>theta_approx<span class="sc">+</span>h)<span class="sc">==</span><span class="fu">min</span>(<span class="fu">abs</span>(marginal.post_theta<span class="sc">$</span>Var1<span class="sc">-</span>theta_approx<span class="sc">+</span>h))),]</span>
<span id="cb297-7"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb297-8"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-8" aria-hidden="true" tabindex="-1"></a>tapprox<span class="ot">&lt;-</span>(<span class="fu">log</span>(ah<span class="sc">$</span>p)<span class="sc">+</span><span class="fu">log</span>(adh<span class="sc">$</span>p)<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(a<span class="sc">$</span>p))<span class="sc">/</span>h<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb297-9"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-10"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-10" aria-hidden="true" tabindex="-1"></a>std.approx<span class="ot">&lt;-</span>(<span class="sc">-</span>tapprox)<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb297-11"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-12"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb297-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;taylor approximation of std.dev: &#39;</span>,<span class="fu">round</span>(std.approx,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## taylor approximation of std.dev: 0.064</code></pre>
<p>If we would not able to solve for the theoretical value from the <em>delta-method</em> in closed form we can use the standard deviation from marginal posterior sampled from the grid approach.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb299-1" aria-hidden="true" tabindex="-1"></a>theoretical.approx<span class="ot">&lt;-</span>(<span class="fu">dnorm</span>(theta_approx<span class="sc">+</span>h,<span class="at">mean=</span>theta_approx,<span class="at">sd=</span><span class="fu">sd</span>(thetas.post),<span class="at">log=</span><span class="cn">TRUE</span>)<span class="sc">+</span>  <span class="fu">dnorm</span>(theta_approx<span class="sc">-</span>h,<span class="at">mean=</span>theta_approx,<span class="at">sd=</span><span class="fu">sd</span>(thetas.post),<span class="at">log=</span><span class="cn">TRUE</span>)<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>  <span class="fu">dnorm</span>(theta_approx,<span class="at">mean=</span>theta_approx,<span class="at">sd=</span><span class="fu">sd</span>(thetas.post),<span class="at">log=</span><span class="cn">TRUE</span>))<span class="sc">/</span>h<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb299-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb299-3" aria-hidden="true" tabindex="-1"></a>std.approx2<span class="ot">&lt;-</span>(<span class="sc">-</span>theoretical.approx)<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb299-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb299-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb299-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;taylor approximation of std.dev using posterior sample variance: &#39;</span>,<span class="fu">round</span>(std.approx2,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## taylor approximation of std.dev using posterior sample variance: 0.092</code></pre>
</div>
<div id="question-4-1" class="section level3 unnumbered hasAnchor">
<h3>Question 4<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For <span class="math inline">\(n\to \infty p(\theta|y)\)</span> approaches normality, and any 1-1 transformation approaches normality <span class="math inline">\(\phi=f(\theta), p(\phi|y)\)</span> is also asymptotically normal. A nonlinear transformation we can use the delta method such that <span class="math inline">\(g&#39;(\theta)\neq 0\)</span> and given that <span class="math inline">\(p(\theta|y)\)</span> is normal. Then for any function, the Taylor series in the neighborhood of the true parameter can converge to a normal approximation.</p>
<p>This is given by Slutsky’s theorem to show that a sequence of random variables converges in distribution, and also if <span class="math inline">\(lim_{n\to \infty} V(S_n^2)\to 0\)</span> where the sample variance goes to 0 in the limit. Hence the normal approximation in the limit has 0 variance, and converges almost certaintly to the true distribution.</p>
</div>
<div id="question-5-1" class="section level3 unnumbered hasAnchor">
<h3>Question 5<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-5-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using a simulation, we simply take the ratio of 2 random normal variables from their samples</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb301-1" aria-hidden="true" tabindex="-1"></a> x<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="at">mean=</span><span class="dv">4</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb301-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb301-2" aria-hidden="true" tabindex="-1"></a> y<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="at">mean=</span><span class="dv">3</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb301-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb301-3" aria-hidden="true" tabindex="-1"></a> sim.xy<span class="ot">&lt;-</span>y<span class="sc">/</span>x</span>
<span id="cb301-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb301-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb301-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb301-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(sim.xy,<span class="at">main=</span><span class="st">&#39;y/x simulation&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb302-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;simulated mean/std.dev: &#39;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(sim.xy),<span class="dv">3</span>),<span class="st">&#39; &#39;</span>,<span class="fu">round</span>(<span class="fu">sd</span>(sim.xy),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## simulated mean/std.dev: 0.787 0.617</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb304-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(<span class="fu">var</span>(sim.xy))</span></code></pre></div>
<pre><code>## [1] 0.3806254</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb306-1" aria-hidden="true" tabindex="-1"></a> <span class="do">## theoretical mean  E(Y/X)=E(Y)E(1/X) = 3/4</span></span>
<span id="cb306-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb306-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb306-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb306-3" aria-hidden="true" tabindex="-1"></a> <span class="do">## taylor series for Var(Y/X) = </span></span></code></pre></div>
<p>-(b) without using a simulation we use the delta method</p>
<p><span class="math display">\[
\begin{aligned}
V(Y/X)&amp;=(\frac{-Y}{X^2},\frac{1}{X})\begin{bmatrix} 1 &amp; 0\\
0 &amp; 4\\
\end{bmatrix}\begin{pmatrix} -Y/X^2 \\ 1/X \end{pmatrix}\\
&amp;=\begin{pmatrix} -Y/X^2 &amp; 4/X \end{pmatrix}\begin{pmatrix} -Y/X^2 \\ 1/X \end{pmatrix}\\
&amp;= Y^2/X^4 +4/X^2 |_{X,Y=\hat{X},\hat{Y}} \\
&amp;= \frac{\mu_x^2\sigma_y^2 +\sigma_x^2\mu_y^2}{\mu_y^4}\\
&amp;= \frac{3^2+4^3}{4^4} = 0.28516
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb307-1" aria-hidden="true" tabindex="-1"></a>  xy<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="at">mean=</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>,<span class="at">sd=</span><span class="fu">sqrt</span>( (<span class="dv">9</span><span class="sc">+</span><span class="dv">4</span><span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span><span class="dv">4</span><span class="sc">^</span><span class="dv">4</span>))</span></code></pre></div>
<p>-(c) we must assume that <span class="math inline">\(x\neq 0\)</span>, for the posterior. note that for the ratio of 2 standard normal distributions</p>
</div>
<div id="question-9-1" class="section level3 unnumbered hasAnchor">
<h3>Question 9<a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-9-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>we set the known variance to 3 and select 5 observed values of y <span class="math inline">\(\sim N(\mu,\sigma)\)</span> where <span class="math inline">\(\sigma=3\)</span> is known and <span class="math inline">\(\mu=0.720925\)</span> is the population parameter that we make inferences for.</li>
<li>the MLE is the sample mean of 1.56, with MSE of 0.71 with observed sample size of 5. Note that if the sample size is larger, n=1000, then the MLE is more powerful.</li>
<li>the posterior mean is used to compute the MSE which is 0.001.</li>
<li>note that if <span class="math inline">\(\sigma=0.01\)</span> the MLE is far more powerful.</li>
</ul>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">8182022</span>)</span>
<span id="cb308-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-2" aria-hidden="true" tabindex="-1"></a> true_mu<span class="ot">&lt;-</span><span class="fl">0.720925</span></span>
<span id="cb308-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-3" aria-hidden="true" tabindex="-1"></a> true_var<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb308-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-4" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb308-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-5" aria-hidden="true" tabindex="-1"></a> <span class="co">#observed_y&lt;-sapply(true_var,function(x) rnorm(1,true_mu,sd=sqrt(x)))</span></span>
<span id="cb308-6"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-6" aria-hidden="true" tabindex="-1"></a> <span class="co">#Y&lt;-data.frame(Y=y,var=true_var)</span></span>
<span id="cb308-7"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb308-8"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-8" aria-hidden="true" tabindex="-1"></a> <span class="do">##observed point</span></span>
<span id="cb308-9"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-9" aria-hidden="true" tabindex="-1"></a> observed_y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">5</span>,<span class="at">mean=</span>true_mu,<span class="at">sd=</span><span class="fu">sqrt</span>(true_var)) </span>
<span id="cb308-10"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-10" aria-hidden="true" tabindex="-1"></a> MLE <span class="ot">=</span> <span class="fu">mean</span>(observed_y) <span class="do">## point estimate for n=1</span></span>
<span id="cb308-11"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-11" aria-hidden="true" tabindex="-1"></a> <span class="co"># MSE for 1 data point is just itself</span></span>
<span id="cb308-12"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-12" aria-hidden="true" tabindex="-1"></a>  mse1<span class="ot">=</span>(MLE<span class="sc">-</span>true_mu)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb308-13"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb308-14"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb308-15"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## posterior mean </span></span>
<span id="cb308-16"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## known variance, uniform prior for theta</span></span>
<span id="cb308-17"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-17" aria-hidden="true" tabindex="-1"></a>   <span class="co"># theta| y ~ p(theta)*l(y|theta)</span></span>
<span id="cb308-18"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-18" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.99</span>,<span class="at">by=</span><span class="fl">0.001</span>)</span>
<span id="cb308-19"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-19" aria-hidden="true" tabindex="-1"></a>  post.norm<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb308-20"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> theta){</span>
<span id="cb308-21"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-21" aria-hidden="true" tabindex="-1"></a>  post_theta<span class="ot">&lt;-</span><span class="fu">dunif</span>(i)<span class="sc">*</span><span class="fu">prod</span>(<span class="fu">dnorm</span>(observed_y,<span class="at">mean=</span>i,<span class="at">sd=</span><span class="fu">sqrt</span>(true_var)))</span>
<span id="cb308-22"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-22" aria-hidden="true" tabindex="-1"></a>  post.norm<span class="ot">&lt;-</span><span class="fu">c</span>(post.norm,post_theta)</span>
<span id="cb308-23"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb308-24"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-24" aria-hidden="true" tabindex="-1"></a>   post.norm<span class="ot">&lt;-</span>post.norm<span class="sc">/</span><span class="fu">sum</span>(post.norm)</span>
<span id="cb308-25"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-25" aria-hidden="true" tabindex="-1"></a>  <span class="do">## need to sample from the posterior</span></span>
<span id="cb308-26"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-26" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb308-27"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb308-27" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(theta,post.norm,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&#39;Normalized posterior&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb309-1" aria-hidden="true" tabindex="-1"></a> samps<span class="ot">&lt;-</span>(<span class="fu">sample</span>(theta,<span class="dv">1000</span>,<span class="at">prob=</span>post.norm,<span class="at">replace=</span>T))</span>
<span id="cb309-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb309-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb309-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb309-3" aria-hidden="true" tabindex="-1"></a>ytilde<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="at">mean=</span>samps,<span class="at">sd=</span><span class="fu">sqrt</span>(true_var)) </span>
<span id="cb309-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb309-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(ytilde)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-63-2.png" width="672" /></p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb310-1" aria-hidden="true" tabindex="-1"></a> mse2<span class="ot">&lt;-</span>(<span class="fu">mean</span>(ytilde)<span class="sc">-</span>true_mu)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb310-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb310-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb310-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb310-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb310-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb310-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;MSE by MLE: &#39;</span>,<span class="fu">round</span>(mse1,<span class="dv">4</span>),<span class="st">&#39; MSE by Bayesian:&#39;</span>,<span class="fu">round</span>(mse2,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## MSE by MLE: 0.7051 MSE by Bayesian:0.0013</code></pre>
<ul>
<li>note that if we increase the sample size to n=100, and keep the variance low, <span class="math inline">\(\sigma=3\)</span>, then the MLE has smaller MSE. if we increase the sample size to 100, but increase the <span class="math inline">\(\sigma=100\)</span>, then the Bayesian estimate has smaller MSE.</li>
</ul>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">8182022</span>)</span>
<span id="cb312-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-2" aria-hidden="true" tabindex="-1"></a> true_mu<span class="ot">&lt;-</span><span class="fl">0.720925</span></span>
<span id="cb312-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-3" aria-hidden="true" tabindex="-1"></a> true_var<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb312-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-4" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb312-5"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-5" aria-hidden="true" tabindex="-1"></a> <span class="co">#observed_y&lt;-sapply(true_var,function(x) rnorm(1,true_mu,sd=sqrt(x)))</span></span>
<span id="cb312-6"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-6" aria-hidden="true" tabindex="-1"></a> <span class="co">#Y&lt;-data.frame(Y=y,var=true_var)</span></span>
<span id="cb312-7"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb312-8"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-8" aria-hidden="true" tabindex="-1"></a> <span class="do">##observed point</span></span>
<span id="cb312-9"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-9" aria-hidden="true" tabindex="-1"></a> observed_y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="at">mean=</span>true_mu,<span class="at">sd=</span><span class="fu">sqrt</span>(true_var)) </span>
<span id="cb312-10"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-10" aria-hidden="true" tabindex="-1"></a> MLE <span class="ot">=</span> <span class="fu">mean</span>(observed_y) <span class="do">## point estimate for n=1</span></span>
<span id="cb312-11"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-11" aria-hidden="true" tabindex="-1"></a> <span class="co"># MSE for 1 data point is just itself</span></span>
<span id="cb312-12"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-12" aria-hidden="true" tabindex="-1"></a>  mse1<span class="ot">=</span>(MLE<span class="sc">-</span>true_mu)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb312-13"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb312-14"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb312-15"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## posterior mean </span></span>
<span id="cb312-16"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## known variance, uniform prior for theta</span></span>
<span id="cb312-17"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-17" aria-hidden="true" tabindex="-1"></a>   <span class="co"># theta| y ~ p(theta)*l(y|theta)</span></span>
<span id="cb312-18"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-18" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.99</span>,<span class="at">by=</span><span class="fl">0.001</span>)</span>
<span id="cb312-19"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-19" aria-hidden="true" tabindex="-1"></a>  post.norm<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb312-20"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> theta){</span>
<span id="cb312-21"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-21" aria-hidden="true" tabindex="-1"></a>  post_theta<span class="ot">&lt;-</span><span class="fu">dunif</span>(i)<span class="sc">*</span><span class="fu">prod</span>(<span class="fu">dnorm</span>(observed_y,<span class="at">mean=</span>i,<span class="at">sd=</span><span class="fu">sqrt</span>(true_var)))</span>
<span id="cb312-22"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-22" aria-hidden="true" tabindex="-1"></a>  post.norm<span class="ot">&lt;-</span><span class="fu">c</span>(post.norm,post_theta)</span>
<span id="cb312-23"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb312-24"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-24" aria-hidden="true" tabindex="-1"></a>   post.norm<span class="ot">&lt;-</span>post.norm<span class="sc">/</span><span class="fu">sum</span>(post.norm)</span>
<span id="cb312-25"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-25" aria-hidden="true" tabindex="-1"></a>  <span class="do">## need to sample from the posterior</span></span>
<span id="cb312-26"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-26" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb312-27"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb312-27" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(theta,post.norm,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&#39;Normalized posterior&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb313-1" aria-hidden="true" tabindex="-1"></a> samps<span class="ot">&lt;-</span>(<span class="fu">sample</span>(theta,<span class="dv">1000</span>,<span class="at">prob=</span>post.norm,<span class="at">replace=</span>T))</span>
<span id="cb313-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb313-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb313-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb313-3" aria-hidden="true" tabindex="-1"></a>ytilde<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="at">mean=</span>samps,<span class="at">sd=</span><span class="fu">sqrt</span>(true_var)) </span>
<span id="cb313-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb313-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(ytilde)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-64-2.png" width="672" /></p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb314-1" aria-hidden="true" tabindex="-1"></a> mse2<span class="ot">&lt;-</span>(<span class="fu">mean</span>(ytilde)<span class="sc">-</span>true_mu)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb314-2"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb314-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb314-3"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb314-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb314-4"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#cb314-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&#39;MSE by MLE: &#39;</span>,<span class="fu">round</span>(mse1,<span class="dv">4</span>),<span class="st">&#39; MSE by Bayesian:&#39;</span>,<span class="fu">round</span>(mse2,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## MSE by MLE: 0.6861 MSE by Bayesian:0.0136</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercises-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="blocks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-Asymptotics-and-connections-to-nonBayesian-approaches.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
