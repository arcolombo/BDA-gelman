<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Single parameter models | Bayesian Data Analysis</title>
  <meta name="description" content="Chapter 2 Single parameter models | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Single parameter models | Bayesian Data Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 2 Single parameter models | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Single parameter models | Bayesian Data Analysis" />
  
  <meta name="twitter:description" content="Chapter 2 Single parameter models | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  

<meta name="author" content="Anthony R. Colombo, Dr. Paul Marjoram" />


<meta name="date" content="2022-06-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fundamentals-of-bayesian-inference.html"/>
<link rel="next" href="parts.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#independent-study"><i class="fa fa-check"></i>Independent study</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#supervised-learning"><i class="fa fa-check"></i>Supervised learning</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html"><i class="fa fa-check"></i><b>1</b> Fundamentals of Bayesian Inference</a>
<ul>
<li class="chapter" data-level="1.1" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#general-notation-for-statistical-inference"><i class="fa fa-check"></i><b>1.1</b> General notation for statistical inference</a>
<ul>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#exchangeability"><i class="fa fa-check"></i>Exchangeability</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#explanatory-variables"><i class="fa fa-check"></i>Explanatory variables</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#hierarchical-modeling"><i class="fa fa-check"></i>Hierarchical modeling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#bayesian-inference"><i class="fa fa-check"></i><b>1.2</b> Bayesian inference</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#subjectivity-and-objectivity"><i class="fa fa-check"></i>Subjectivity and Objectivity</a></li>
<li class="chapter" data-level="1.3" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#simulation-100-times"><i class="fa fa-check"></i>Simulation 100 times</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>2</b> Single parameter models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cross.html"><a href="cross.html#estimating-a-probability-from-binomial-data"><i class="fa fa-check"></i><b>2.1</b> Estimating a probability from binomial data</a></li>
<li class="chapter" data-level="2.2" data-path="cross.html"><a href="cross.html#posterior-as-a-compromise-between-data-and-prior-information"><i class="fa fa-check"></i><b>2.2</b> Posterior as a compromise between data and prior information</a></li>
<li class="chapter" data-level="2.3" data-path="cross.html"><a href="cross.html#summarizing-the-posterior-inference"><i class="fa fa-check"></i><b>2.3</b> Summarizing the posterior inference</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#posterior-quantiles-and-intervals"><i class="fa fa-check"></i>Posterior quantiles and intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="cross.html"><a href="cross.html#informative-prior-distributions"><i class="fa fa-check"></i><b>2.4</b> Informative prior distributions</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#conjugate-prior-distributions"><i class="fa fa-check"></i>Conjugate prior distributions</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#conjugate-prior-distributions-exponential-families-and-sufficient-statistics"><i class="fa fa-check"></i>Conjugate prior, distributions, exponential families, and sufficient statistics</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="cross.html"><a href="cross.html#normal-distribution-with-known-variance"><i class="fa fa-check"></i><b>2.5</b> Normal distribution with known variance</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#likelihood-of-one-data-point"><i class="fa fa-check"></i>Likelihood of one data point</a></li>
<li class="chapter" data-level="2.5.1" data-path="cross.html"><a href="cross.html#conjugate-prior-and-posterior-distributions"><i class="fa fa-check"></i><b>2.5.1</b> Conjugate prior and posterior distributions</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#posterior-predictive-distribution"><i class="fa fa-check"></i>Posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-model-with-multiple-observations"><i class="fa fa-check"></i>Normal model with multiple observations</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="cross.html"><a href="cross.html#other-standard-single-parameter-models"><i class="fa fa-check"></i><b>2.6</b> Other standard single-parameter models</a></li>
<li class="chapter" data-level="2.7" data-path="cross.html"><a href="cross.html#exercises-1"><i class="fa fa-check"></i><b>2.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-1"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-approximation-example"><i class="fa fa-check"></i>Normal approximation example</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-3"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-4"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-8-normal-distribution-with-unknown-mean"><i class="fa fa-check"></i>Question 8 (Normal distribution with unknown mean)</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-10"><i class="fa fa-check"></i>Question 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="parts.html"><a href="parts.html"><i class="fa fa-check"></i><b>3</b> Parts</a></li>
<li class="chapter" data-level="4" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html"><i class="fa fa-check"></i><b>4</b> Footnotes and citations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#footnotes"><i class="fa fa-check"></i><b>4.1</b> Footnotes</a></li>
<li class="chapter" data-level="4.2" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#citations"><i class="fa fa-check"></i><b>4.2</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>5</b> Blocks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="blocks.html"><a href="blocks.html#equations"><i class="fa fa-check"></i><b>5.1</b> Equations</a></li>
<li class="chapter" data-level="5.2" data-path="blocks.html"><a href="blocks.html#theorems-and-proofs"><i class="fa fa-check"></i><b>5.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="5.3" data-path="blocks.html"><a href="blocks.html#callout-blocks"><i class="fa fa-check"></i><b>5.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>6</b> Sharing your book</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>6.1</b> Publishing</a></li>
<li class="chapter" data-level="6.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>6.2</b> 404 pages</a></li>
<li class="chapter" data-level="6.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>6.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cross" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Single parameter models<a href="cross.html#cross" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="estimating-a-probability-from-binomial-data" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Estimating a probability from binomial data<a href="cross.html#estimating-a-probability-from-binomial-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display" id="eq:binomialProb">\[\begin{equation}
p(y  | \theta) = {n \choose y}\theta^y(1-\theta)^{n-y}
\tag{2.1}
\end{equation}\]</span></p>
<p>To perform Bayesian inference we assume <span class="math inline">\(\theta \sim U(0,1)\)</span> where the posterior is</p>
<p><span class="math display" id="eq:binomialPosterior">\[\begin{equation}
p(\theta | y) \propto \theta^y(1-\theta)^{n-y}
\tag{2.2}
\end{equation}\]</span></p>
<p>which is the form of a <code>beta</code> distribution <span class="math inline">\(\theta | y \sim Beta(y+1, n-y+1)\)</span></p>
</div>
<div id="posterior-as-a-compromise-between-data-and-prior-information" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Posterior as a compromise between data and prior information<a href="cross.html#posterior-as-a-compromise-between-data-and-prior-information" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The posterior is less variable than the prior because it incorporates the information from the data.</p>
<p><span class="math display" id="eq:adamsLaw">\[\begin{equation}
E(\theta) = E(E(\theta | y))
\tag{2.3}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:evesLaw">\[\begin{equation}
V(\theta) = E(V(\theta|y)) + V(E(\theta | y))
\tag{2.4}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\theta|y\)</span> is the posterior. So the average of the prior, is the average of the posterior means over the distribution of possible data. The variance of the prior <a href="cross.html#eq:evesLaw">(2.4)</a> says the posterior variance is on average smaller than the prior variance.</p>
</div>
<div id="summarizing-the-posterior-inference" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Summarizing the posterior inference<a href="cross.html#summarizing-the-posterior-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The mean, median, mode, and standard deviation of the posterior distribution summarize the all the current information about a model.</p>
<div id="posterior-quantiles-and-intervals" class="section level3 unnumbered hasAnchor">
<h3>Posterior quantiles and intervals<a href="cross.html#posterior-quantiles-and-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The posterior uncertainty can be reported by presenting the quantiles of the posterior distribution. The interval, a <em>central interval of posterior probability</em> corresponds to the case of 100(<span class="math inline">\(1-\alpha)\%\)</span>, to the range of values above and below which lies exactly 100(<span class="math inline">\(\alpha/2)\%\)</span> of the posterior probability. The interval estimates are <em>posterior intervals</em>. This differences from the confidence interval because the confidence interval is not a probability interval, because either the parameter is within the region or it is not, but the confidence interval provides information in the long run over repeated experimentation as to how many experiments would contain the true parameter.</p>
<p>There is also the <em>highest posterior interval</em> which is a probabilistic interval that is not less than any region outside of the interval.</p>
</div>
</div>
<div id="informative-prior-distributions" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Informative prior distributions<a href="cross.html#informative-prior-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>the property that the posterior distribution follows the same parametric form as the prior distribution is called <em>conjugacy</em>. Where the beta prior distribution is a <em>conjugate family</em> for the binomial likelihood.</p>
<p>so given the binomial likelihood <span class="math inline">\(p(y|\theta)\propto \theta^a(1-\theta)^b\)</span>, and a prior density <span class="math inline">\(p(\theta)\propto \theta^{\alpha-1}(1-\theta)^{\beta-1}\)</span> the posterior is of the beta family.</p>
<p><span class="math display">\[
\begin{aligned}
p(\theta | y) &amp;\propto \theta^y(1-\theta)^{n-y}\theta^{\alpha-1}(1-\theta)^{\beta-1}\\
&amp;= \theta^{y+\alpha-1}(1-\theta)^{n-y+\beta-1}\\
&amp;= Beta(\theta | \alpha+y, \beta+n-y)
\end{aligned}
\]</span></p>
<div id="conjugate-prior-distributions" class="section level3 unnumbered hasAnchor">
<h3>Conjugate prior distributions<a href="cross.html#conjugate-prior-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conjugacy is formally defined as if F is a class of sampling distributions <span class="math inline">\(p(y|\theta)\)</span>, and P is a class of prior distributions for <span class="math inline">\(\theta\)</span>, then the class P is conjugate for F if <span class="math inline">\(p(\theta | y) \in P\)</span> for all <span class="math inline">\(p(.|\theta)\in F\)</span> and <span class="math inline">\(p(.)\in P\)</span>.</p>
</div>
<div id="conjugate-prior-distributions-exponential-families-and-sufficient-statistics" class="section level3 unnumbered hasAnchor">
<h3>Conjugate prior, distributions, exponential families, and sufficient statistics<a href="cross.html#conjugate-prior-distributions-exponential-families-and-sufficient-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Posterior distributions can be derived using sufficient statistics from exponential families. The exponential family is defined as</p>
<p><span class="math display">\[
\begin{aligned}
p(y_i | \theta)=f(y_i)g(\theta)e^{\phi(\theta)^Tu(y_i)}
\end{aligned}
\]</span>
Where <span class="math inline">\(\phi(\theta), u(y_i)\)</span> are vectors of equal dimension to that of <span class="math inline">\(\theta\)</span>. The <span class="math inline">\(\phi(\theta)\)</span> is called the <em>natural parameter</em> for the family (F). The likelihood of a sequence <span class="math inline">\(y=(y_1,...,y_n)\)</span> iid is</p>
<p><span class="math display">\[
\begin{aligned}
p(y | \theta)&amp;= (\prod_{i=1}^n f(y_i)) g(\theta)^n exp(\phi(\theta)^T \sum_{i=1}^n u(y_i)) \\
  &amp;\propto g(\theta)^ne^{\phi(\theta)^Tt(y)}, t(y)=\sum_{y=1}^n u(y_i)
\end{aligned}
\]</span></p>
<p>The <em>sufficient statistic</em> for <span class="math inline">\(\theta\)</span> is <span class="math inline">\(t(y)\)</span> because the likelihood for $depends on the data, y, only through the value of t(y).</p>
<p>Sufficient statistics benefit posterior distributions because if the prior density is specified as
<span class="math display">\[
\begin{aligned}
p(\theta)&amp;\propto g(\theta)^{\eta} e^{\phi(\theta)^T \nu} \\
\end{aligned}
\]</span>
Then the posterior density using sufficient statistics is</p>
<p><span class="math display">\[
\begin{aligned}
p(\theta | y ) &amp;\propto g(\theta)^{\eta+n} e^{\phi(\theta)^T (\nu+t(y))} \\
\end{aligned}
\]</span></p>
<p>Exponential families are the only classes of distributions that have natural conjugate prior distributions.</p>
</div>
</div>
<div id="normal-distribution-with-known-variance" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Normal distribution with known variance<a href="cross.html#normal-distribution-with-known-variance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The normal distribution is foundational to statistical modeling, with the central limit theorem (CLT) allowing for the use of normal likelihood in many statistical problems which can approximate complex likelihoods. If the normal distribution does not provide a good model fit, finite mixtures of distributions can identify useful solutions.</p>
<div id="likelihood-of-one-data-point" class="section level3 unnumbered hasAnchor">
<h3>Likelihood of one data point<a href="cross.html#likelihood-of-one-data-point" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With mean <span class="math inline">\(\theta\)</span> and known variance <span class="math inline">\(\sigma^2\)</span> the sampling distribution of a given point is defined</p>
<p><span class="math inline">\(p(y|\theta) = \frac{1}{\sqrt{2*\pi*\sigma^2}}e^{-\frac{1}{2\sigma^2} (y-\theta)^2}\)</span></p>
</div>
<div id="conjugate-prior-and-posterior-distributions" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Conjugate prior and posterior distributions<a href="cross.html#conjugate-prior-and-posterior-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The prior has the exponential family form given as <span class="math inline">\(\theta \sim N(\mu_0, \tau_0^2)\)</span></p>
<p><span class="math display">\[
\begin{aligned}
p(\theta ) &amp;\propto exp( \frac{1}{2\tau_0^2}(\theta-\mu_0)^2) \\
\end{aligned}
\]</span></p>
<p>WHere completing the square can find the posterior distribution</p>
<p><span class="math display">\[
\begin{aligned}
p(\theta | y ) &amp;\propto exp(-1/2(\frac{(y-\theta)^2}{\sigma^2} +\frac{(\theta-\mu_0)^2}{\tau_0^2} )  ) \\
p(\theta | y ) &amp;\propto exp( \frac{1}{2\tau_1^2}(\theta-\mu_1)^2),  \theta|y \sim N(\mu_1,\tau_1^2)
\end{aligned}
\]</span>
where <span class="math inline">\(\mu_1 = \frac{1/\tau_0^2 \mu_0 + 1/\sigma^2 y}{1/\tau_0^2 + 1/\sigma^2}\)</span> and <span class="math inline">\(1/\tau_1^2 = 1/\tau_0^2 +1/\sigma^2\)</span></p>
<p>In manipulating the distributions the inverse of the variance is defined as the <em>precision</em>. The posterior precision is equal to the prior precision plus the data precision. And the posterior mean is a weighted average of the prior mean and the observed value, y, proportional to the total precision.</p>
</div>
<div id="posterior-predictive-distribution" class="section level3 unnumbered hasAnchor">
<h3>Posterior predictive distribution<a href="cross.html#posterior-predictive-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>the posterior predictive distribution of a future observation, x, p(x|y) can be calculated</p>
<p><span class="math display">\[
\begin{aligned}
p(x|y) &amp;= \int p(x|\theta)p(\theta|y) d\theta
&amp;\propto \int exp(-1/2\sigma^2 (x-\theta)^2) exp(-1/2\tau_1^2 (\theta-\mu_1)^2) d\theta
\end{aligned}
\]</span>
the future observations, x, does not depend on the past observations y given <span class="math inline">\(\theta\)</span>.</p>
</div>
<div id="normal-model-with-multiple-observations" class="section level3 unnumbered hasAnchor">
<h3>Normal model with multiple observations<a href="cross.html#normal-model-with-multiple-observations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For multiple observations, y, the posterior density is formulated as:</p>
<p><span class="math display">\[
\begin{aligned}
p(\theta | y ) &amp;\propto p(\theta)p(y|\theta) \\
   &amp;=p(\theta)\prod_i p(y_i | \theta)\\
   &amp;\propto exp(-1/2\tau_0^2 (\theta-\mu_0)^2)\prod_i exp(-1/2\sigma^2 (y_i -\theta)^2)\\
   &amp;\propto exp(-1/2 (1/\tau_0^2(\theta-\mu_0)^2+ 1/\sigma^2\sum_i(y_i-\theta)^2) )\\
\end{aligned}
\]</span>
Simplfying the algebra shows the posterior depends on y only through the sample mean (sufficient statistic), <span class="math inline">\(\bar{y}\)</span> is the sufficient statistic for <span class="math inline">\(\theta\)</span>, and the final model is <span class="math inline">\(\bar{y} | \theta,\sigma^2 \sim N(\theta, \sigma^2/n)\)</span></p>
</div>
</div>
<div id="other-standard-single-parameter-models" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Other standard single-parameter models<a href="cross.html#other-standard-single-parameter-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="exercises-1" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Exercises<a href="cross.html#exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="question-1" class="section level3 unnumbered hasAnchor">
<h3>Question 1<a href="cross.html#question-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>prior Beta(4,4), where a coin is tossed 10 times and heads appears fewer than 3 times. the exact posterior is Beta(4+y, 4+10-y) for y=0,1,2. Since we don’t know the observed heads, but that <span class="math inline">\(y&lt;3\)</span> we plot the posterior distributions for each possibility. For 2 heads it is closer to the prior, with posterior mean of 0.33, which is closest to the prior mean of 1/2.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="cross.html#cb34-1" aria-hidden="true" tabindex="-1"></a> theta<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb34-2"><a href="cross.html#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="cross.html#cb34-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(theta,<span class="fu">dbeta</span>(theta,<span class="dv">4</span>,<span class="dv">4</span>),<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)) <span class="do">## prior</span></span>
<span id="cb34-4"><a href="cross.html#cb34-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">lines</span>(theta,<span class="fu">dbeta</span>(theta,<span class="dv">4</span><span class="sc">+</span><span class="dv">1</span>,<span class="dv">4</span><span class="sc">+</span><span class="dv">10-1</span>),<span class="at">lty=</span><span class="dv">2</span>) <span class="do">## 1 success</span></span>
<span id="cb34-5"><a href="cross.html#cb34-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">lines</span>(theta,<span class="fu">dbeta</span>(theta,<span class="dv">4</span><span class="sc">+</span><span class="dv">2</span>,<span class="dv">4</span><span class="sc">+</span><span class="dv">10-2</span>),<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>) <span class="do">## 2 succe</span></span>
<span id="cb34-6"><a href="cross.html#cb34-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">lines</span>(theta,<span class="fu">dbeta</span>(theta,<span class="dv">4</span>,<span class="dv">4</span><span class="sc">+</span><span class="dv">10</span>),<span class="at">lty=</span><span class="dv">4</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>)  <span class="do">## 0 successes</span></span>
<span id="cb34-7"><a href="cross.html#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="fl">0.6</span>, <span class="dv">4</span>, </span>
<span id="cb34-8"><a href="cross.html#cb34-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;prior&quot;</span>, <span class="st">&quot;0 H&quot;</span>, <span class="st">&quot;1 H&quot;</span>, <span class="st">&quot;2 H&quot;</span>),</span>
<span id="cb34-9"><a href="cross.html#cb34-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="normal-approximation-example" class="section level3 unnumbered hasAnchor">
<h3>Normal approximation example<a href="cross.html#normal-approximation-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For female births we have beta(438,544) we use the normal approximation. This replicates Gelman’s Figure 2.3 (a, b)</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="cross.html#cb35-1" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="at">from=</span><span class="fl">0.001</span>,<span class="at">to=</span><span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb35-2"><a href="cross.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## example births</span></span>
<span id="cb35-3"><a href="cross.html#cb35-3" aria-hidden="true" tabindex="-1"></a>   postMean <span class="ot">&lt;-</span><span class="cf">function</span>(alpha,beta,y,n){</span>
<span id="cb35-4"><a href="cross.html#cb35-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">return</span>( (alpha<span class="sc">+</span>y)<span class="sc">/</span>(alpha<span class="sc">+</span>beta<span class="sc">+</span>n))</span>
<span id="cb35-5"><a href="cross.html#cb35-5" aria-hidden="true" tabindex="-1"></a>   } </span>
<span id="cb35-6"><a href="cross.html#cb35-6" aria-hidden="true" tabindex="-1"></a>   postVar<span class="ot">&lt;-</span><span class="cf">function</span>(alpha,beta,y,n){</span>
<span id="cb35-7"><a href="cross.html#cb35-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">return</span>( ((alpha<span class="sc">+</span>y)<span class="sc">*</span>(beta<span class="sc">+</span>n<span class="sc">-</span>y))<span class="sc">/</span>( (alpha<span class="sc">+</span>beta<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(alpha<span class="sc">+</span>beta<span class="sc">+</span>n<span class="sc">+</span><span class="dv">1</span>)) )</span>
<span id="cb35-8"><a href="cross.html#cb35-8" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb35-9"><a href="cross.html#cb35-9" aria-hidden="true" tabindex="-1"></a>   sdnorm<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">postVar</span>(<span class="dv">438</span>,<span class="dv">544</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb35-10"><a href="cross.html#cb35-10" aria-hidden="true" tabindex="-1"></a>   logitMean<span class="ot">&lt;-</span><span class="fu">log</span>( <span class="fu">postMean</span>(<span class="dv">438</span>,<span class="dv">544</span>,<span class="dv">0</span>,<span class="dv">0</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">postMean</span>(<span class="dv">438</span>,<span class="dv">544</span>,<span class="dv">0</span>,<span class="dv">0</span>)))</span>
<span id="cb35-11"><a href="cross.html#cb35-11" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb35-12"><a href="cross.html#cb35-12" aria-hidden="true" tabindex="-1"></a>  logitTheta<span class="ot">&lt;-</span><span class="fu">log</span>(theta<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>theta))</span>
<span id="cb35-13"><a href="cross.html#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="cross.html#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb35-15"><a href="cross.html#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(theta,<span class="fu">dbeta</span>(theta,<span class="dv">438</span>,<span class="dv">544</span>),<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.35</span>,<span class="fl">0.55</span>),<span class="at">main=</span><span class="st">&quot;posterior beta&quot;</span>) <span class="do">## prior</span></span>
<span id="cb35-16"><a href="cross.html#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span><span class="fl">0.446</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb35-17"><a href="cross.html#cb35-17" aria-hidden="true" tabindex="-1"></a>  draws<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1000</span>,<span class="dv">438</span>,<span class="dv">544</span>)</span>
<span id="cb35-18"><a href="cross.html#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(logitTheta,<span class="fu">dnorm</span>(logitTheta,<span class="at">mean =</span>logitMean, <span class="at">sd=</span><span class="fu">sd</span>(<span class="fu">log</span>(draws<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>draws))) ),<span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.1</span>),<span class="at">main=</span><span class="st">&quot;Normal approx.&quot;</span>) <span class="do">## prior</span></span>
<span id="cb35-19"><a href="cross.html#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span><span class="sc">-</span><span class="fl">0.22</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="question-3" class="section level3 unnumbered hasAnchor">
<h3>Question 3<a href="cross.html#question-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The prior predictive distributions for the number of 6’s in a fair roll, tossed 1,000 times will follow a beta distribution. Let y be the number of 6’s in 1000 rolls of fair die, the probability for a 6 is 1/6, so the number of 6’s in this trial is approximatley 167, and 833 failures as the prior prediction.</p>
<p>We plot the beta distribution of the expected number of heads in 1000 tosses.</p>
<p>The normal approximation shows the probability of heads in a given 1000 tosses, using a non-informative prior beta(167,833) which has a prior predictive mean of <span class="math inline">\(exp(-1.79)/(1+exp(-1.79)) = 0.143\)</span>. This is not the same for number of success in 1000 tosses.</p>
<p>We find the probability distribution of a given success and the prior probability predictive interval follows a beta with 95% (0.12,0.17) for hte probability of rolling a 6</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="cross.html#cb36-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## based on normal approximation sketch the distribution of y</span></span>
<span id="cb36-2"><a href="cross.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## for normal we use the logit transform</span></span>
<span id="cb36-3"><a href="cross.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## n = 1,000</span></span>
<span id="cb36-4"><a href="cross.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## first lets construct a beta distribution.</span></span>
<span id="cb36-5"><a href="cross.html#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## let the prior be beta(4,4) or even beta(1,1)</span></span>
<span id="cb36-6"><a href="cross.html#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb36-7"><a href="cross.html#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="cross.html#cb36-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">plot</span>(theta,<span class="fu">dbeta</span>(theta,<span class="dv">167</span>,<span class="dv">833</span>),<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>),<span class="at">main=</span><span class="st">&quot;prior beta&quot;</span>) <span class="do">## prior</span></span>
<span id="cb36-9"><a href="cross.html#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot(theta,dbeta(theta,1,5),type=&#39;l&#39;,xlim=c(0.1,0.5), main=&#39;prior beta&#39;) </span></span>
<span id="cb36-10"><a href="cross.html#cb36-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">abline</span>(<span class="at">v=</span><span class="fl">0.167</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>) <span class="do">## </span></span>
<span id="cb36-11"><a href="cross.html#cb36-11" aria-hidden="true" tabindex="-1"></a>   <span class="co">#  qbeta(c(0.05,0.25,0.5,0.75,0.95),167,833)</span></span>
<span id="cb36-12"><a href="cross.html#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="do">## predictive on normal scale.</span></span>
<span id="cb36-13"><a href="cross.html#cb36-13" aria-hidden="true" tabindex="-1"></a>     draws<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1000</span>,<span class="dv">167</span>,<span class="dv">833</span>)</span>
<span id="cb36-14"><a href="cross.html#cb36-14" aria-hidden="true" tabindex="-1"></a>     logitMean<span class="ot">&lt;-</span><span class="fu">log</span>( <span class="dv">167</span><span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb36-15"><a href="cross.html#cb36-15" aria-hidden="true" tabindex="-1"></a>  sdd<span class="ot">&lt;-</span><span class="fu">sd</span>(<span class="fu">log</span>(draws<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>draws)))</span>
<span id="cb36-16"><a href="cross.html#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="cross.html#cb36-17" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb36-18"><a href="cross.html#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(logitTheta,<span class="fu">dnorm</span>(logitTheta,<span class="at">mean =</span>logitMean, <span class="at">sd=</span>sdd ),<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&quot;Normal approx.of a total heads&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="fl">1.4</span>)) <span class="do">## prior</span></span>
<span id="cb36-19"><a href="cross.html#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span>logitMean,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="cross.html#cb37-1" aria-hidden="true" tabindex="-1"></a>    <span class="do">### the number of heads.    </span></span>
<span id="cb37-2"><a href="cross.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;prior predictive mean:&quot;</span> ,<span class="fu">round</span>( <span class="fu">exp</span>(logitMean)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(logitMean)),<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## prior predictive mean:0.14</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="cross.html#cb39-1" aria-hidden="true" tabindex="-1"></a> qx<span class="ot">&lt;-</span>(<span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>,<span class="fl">0.95</span>),<span class="at">mean =</span>logitMean, <span class="at">sd=</span>sdd ))</span>
<span id="cb39-2"><a href="cross.html#cb39-2" aria-hidden="true" tabindex="-1"></a> <span class="do">## this is the probability of landing 6 for theta</span></span>
<span id="cb39-3"><a href="cross.html#cb39-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">exp</span>(qx)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(qx))</span></code></pre></div>
<pre><code>## [1] 0.1268384 0.1362323 0.1431020 0.1502578 0.1610662</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="cross.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## wald 95% prior interval</span></span>
<span id="cb41-2"><a href="cross.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="fu">exp</span>(logitMean<span class="fl">-1.96</span><span class="sc">*</span>sdd)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(logitMean<span class="fl">-1.96</span><span class="sc">*</span>sdd)),<span class="fu">exp</span>(logitMean<span class="fl">+1.96</span><span class="sc">*</span>sdd)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(logitMean<span class="fl">+1.96</span><span class="sc">*</span>sdd)))</span></code></pre></div>
<pre><code>## [1] 0.1239089 0.1647091</code></pre>
</div>
<div id="question-4" class="section level3 unnumbered hasAnchor">
<h3>Question 4<a href="cross.html#question-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have a mixture of 3 normal distributions, and show the central intervals for 5,25,50,75, and 95<span class="math inline">\(\%\)</span> predictive probabilities. The question gives <span class="math inline">\(\theta\)</span> as the probability of a 6 on a die, possibly unfair, in 1,000 tosses. we have <span class="math inline">\(\theta= 1/12,1/6, 1/4\)</span> types of biased die. Using the normal approximation, the predictive prior probability is <span class="math inline">\(\sum_{\theta}p(\theta)p(y| \theta)\)</span> where the likelihood is approximated using a normal distribution <span class="math inline">\(\mu = n*\theta_i, \sigma = n*\theta_i(1-\theta_i)\)</span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="cross.html#cb43-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>)<span class="sc">-</span><span class="fl">0.5</span> <span class="co"># continuity correction.</span></span>
<span id="cb43-2"><a href="cross.html#cb43-2" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb43-3"><a href="cross.html#cb43-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb43-4"><a href="cross.html#cb43-4" aria-hidden="true" tabindex="-1"></a>normLikelihood<span class="ot">&lt;-</span><span class="cf">function</span>(x,n,p){</span>
<span id="cb43-5"><a href="cross.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  mean<span class="ot">&lt;-</span>n<span class="sc">*</span>p</span>
<span id="cb43-6"><a href="cross.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  varz<span class="ot">&lt;-</span>n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb43-7"><a href="cross.html#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">dnorm</span>(x,<span class="at">mean=</span>mean,<span class="at">sd=</span><span class="fu">sqrt</span>(varz)))</span>
<span id="cb43-8"><a href="cross.html#cb43-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-9"><a href="cross.html#cb43-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-10"><a href="cross.html#cb43-10" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span>n<span class="sc">*</span>theta[<span class="dv">1</span>],<span class="at">sd=</span><span class="fu">sqrt</span>(n<span class="sc">*</span>theta[<span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>theta[<span class="dv">1</span>]))  )</span>
<span id="cb43-11"><a href="cross.html#cb43-11" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span>n<span class="sc">*</span>theta[<span class="dv">2</span>],<span class="at">sd=</span><span class="fu">sqrt</span>(n<span class="sc">*</span>theta[<span class="dv">2</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>theta[<span class="dv">2</span>]))  )</span>
<span id="cb43-12"><a href="cross.html#cb43-12" aria-hidden="true" tabindex="-1"></a>c<span class="ot">&lt;-</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span>n<span class="sc">*</span>theta[<span class="dv">3</span>],<span class="at">sd=</span><span class="fu">sqrt</span>(n<span class="sc">*</span>theta[<span class="dv">3</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>theta[<span class="dv">3</span>]))  )</span>
<span id="cb43-13"><a href="cross.html#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="cross.html#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="cross.html#cb43-15" aria-hidden="true" tabindex="-1"></a>mypri<span class="ot">&lt;-</span>a<span class="sc">*</span><span class="fl">0.25</span><span class="sc">+</span>b<span class="sc">*</span><span class="fl">0.5</span><span class="sc">+</span>c<span class="sc">*</span><span class="fl">0.25</span></span>
<span id="cb43-16"><a href="cross.html#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="cross.html#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(mypri) <span class="do">## sums to 1 it is a distribution</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="cross.html#cb45-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb45-2"><a href="cross.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,mypri,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&#39;predictive prior number of heads&#39;</span>)</span>
<span id="cb45-3"><a href="cross.html#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="cross.html#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="cross.html#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="cross.html#cb45-6" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">p=</span>mypri)</span>
<span id="cb45-7"><a href="cross.html#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="cross.html#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="do">## highest probability interval</span></span>
<span id="cb45-9"><a href="cross.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 95%</span></span>
<span id="cb45-10"><a href="cross.html#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="cross.html#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,mypri,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&#39; 95% predictive prior number of heads&#39;</span>)</span>
<span id="cb45-12"><a href="cross.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">max</span>(data[<span class="fu">which</span>(<span class="fu">cumsum</span>(data<span class="sc">$</span>p)<span class="sc">&lt;</span><span class="fl">0.025</span>),<span class="dv">1</span>])</span>
<span id="cb45-13"><a href="cross.html#cb45-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-14"><a href="cross.html#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">max</span>(data[<span class="fu">which</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">cumsum</span>(data<span class="sc">$</span>p)<span class="sc">&gt;</span><span class="fl">0.025</span>),<span class="dv">1</span>]))</span>
<span id="cb45-15"><a href="cross.html#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="cross.html#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,mypri,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&#39;75% predictive prior number of heads&#39;</span>)</span>
<span id="cb45-17"><a href="cross.html#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">max</span>(data[<span class="fu">which</span>(<span class="fu">cumsum</span>(data<span class="sc">$</span>p)<span class="sc">&lt;</span><span class="fl">0.125</span>),<span class="dv">1</span>]))</span>
<span id="cb45-18"><a href="cross.html#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">max</span>(data[<span class="fu">which</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">cumsum</span>(data<span class="sc">$</span>p)<span class="sc">&gt;</span><span class="fl">0.125</span>),<span class="dv">1</span>])</span>
<span id="cb45-19"><a href="cross.html#cb45-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-20"><a href="cross.html#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="cross.html#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,mypri,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&#39;50% predictive prior number of heads&#39;</span>)</span>
<span id="cb45-22"><a href="cross.html#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">max</span>(data[<span class="fu">which</span>(<span class="fu">cumsum</span>(data<span class="sc">$</span>p)<span class="sc">&lt;</span><span class="fl">0.25</span>),<span class="dv">1</span>]))</span>
<span id="cb45-23"><a href="cross.html#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">max</span>(data[<span class="fu">which</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">cumsum</span>(data<span class="sc">$</span>p)<span class="sc">&gt;</span><span class="fl">0.25</span>),<span class="dv">1</span>])</span>
<span id="cb45-24"><a href="cross.html#cb45-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-25"><a href="cross.html#cb45-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-26"><a href="cross.html#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,mypri,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&#39;25% predictive prior number of heads&#39;</span>)</span>
<span id="cb45-27"><a href="cross.html#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">max</span>(data[<span class="fu">which</span>(<span class="fu">cumsum</span>(data<span class="sc">$</span>p)<span class="sc">&lt;</span><span class="fl">0.375</span>),<span class="dv">1</span>]))</span>
<span id="cb45-28"><a href="cross.html#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">max</span>(data[<span class="fu">which</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">cumsum</span>(data<span class="sc">$</span>p)<span class="sc">&gt;</span><span class="fl">0.375</span>),<span class="dv">1</span>])</span>
<span id="cb45-29"><a href="cross.html#cb45-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-30"><a href="cross.html#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="cross.html#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,mypri,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&#39;5% predictive prior number of heads&#39;</span>)</span>
<span id="cb45-32"><a href="cross.html#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">max</span>(data[<span class="fu">which</span>(<span class="fu">cumsum</span>(data<span class="sc">$</span>p)<span class="sc">&lt;</span><span class="fl">0.475</span>),<span class="dv">1</span>]))</span>
<span id="cb45-33"><a href="cross.html#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">max</span>(data[<span class="fu">which</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">cumsum</span>(data<span class="sc">$</span>p)<span class="sc">&gt;</span><span class="fl">0.475</span>),<span class="dv">1</span>])</span>
<span id="cb45-34"><a href="cross.html#cb45-34" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="question-8-normal-distribution-with-unknown-mean" class="section level3 unnumbered hasAnchor">
<h3>Question 8 (Normal distribution with unknown mean)<a href="cross.html#question-8-normal-distribution-with-unknown-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A random sample of n students is drawn from a large population, and weights are measured. The average height of the n sampled students is <span class="math inline">\(\bar{y}= 150\)</span> lbs. Assume the weights in the population are normally distribution with unknown mean, <span class="math inline">\(\theta\)</span>, and known standard deviation 20 lbs. Suppose the prior for <span class="math inline">\(\theta \sim N(180, 40^2)\)</span></p>
<p>For known variance, the limit of the posterior is <span class="math inline">\(p(\theta,y)\approx N(\theta| \bar{y}, \sigma^2/n)\)</span>. And the direct formulation is <span class="math inline">\(p(\theta | \bar{y})= N(\theta | \mu_n,\tau_n^2).\)</span> using equations 2.12.</p>
<p>For a posterior predictive interval, the marginal distribution for new data <span class="math inline">\(p(\tilde{y} | y) \sim N(\mu_n, \sigma^2+\tau_n^2)\)</span></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="cross.html#cb46-1" aria-hidden="true" tabindex="-1"></a>mu_n<span class="ot">&lt;-</span><span class="cf">function</span>(mu0,ybar,n,tau02,sigma2){</span>
<span id="cb46-2"><a href="cross.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  mun<span class="ot">&lt;-</span> (mu0<span class="sc">/</span>tau02 <span class="sc">+</span> (ybar<span class="sc">*</span>n)<span class="sc">/</span>sigma2)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span>tau02 <span class="sc">+</span> n<span class="sc">/</span>sigma2)</span>
<span id="cb46-3"><a href="cross.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mun)</span>
<span id="cb46-4"><a href="cross.html#cb46-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-5"><a href="cross.html#cb46-5" aria-hidden="true" tabindex="-1"></a>taun2<span class="ot">&lt;-</span><span class="cf">function</span>(tau02,n,sigma2){</span>
<span id="cb46-6"><a href="cross.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  inv.taun2<span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>tau02 <span class="sc">+</span>n<span class="sc">/</span>sigma2</span>
<span id="cb46-7"><a href="cross.html#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>inv.taun2)</span>
<span id="cb46-8"><a href="cross.html#cb46-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-9"><a href="cross.html#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="cross.html#cb46-10" aria-hidden="true" tabindex="-1"></a>ybar<span class="ot">=</span><span class="dv">150</span></span>
<span id="cb46-11"><a href="cross.html#cb46-11" aria-hidden="true" tabindex="-1"></a>sigma2<span class="ot">=</span><span class="dv">20</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb46-12"><a href="cross.html#cb46-12" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">=</span><span class="dv">180</span></span>
<span id="cb46-13"><a href="cross.html#cb46-13" aria-hidden="true" tabindex="-1"></a>  tau02<span class="ot">=</span><span class="dv">40</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb46-14"><a href="cross.html#cb46-14" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb46-15"><a href="cross.html#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="cross.html#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="do">## posterior interval n=10</span></span>
<span id="cb46-17"><a href="cross.html#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#lower&lt;-round(qnorm(0.025,mu_n(mu0,ybar,tau02,10,sigma2),sd=sqrt(taun2(tau02,10,sigma2))),2)</span></span>
<span id="cb46-18"><a href="cross.html#cb46-18" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="fu">mu_n</span>(mu0,ybar,tau02,<span class="dv">10</span>,sigma2),<span class="at">sd=</span><span class="fu">sqrt</span>(<span class="fu">taun2</span>(tau02,<span class="dv">10</span>,sigma2))),<span class="dv">2</span>)</span>
<span id="cb46-19"><a href="cross.html#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="cross.html#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;posterior interval n=10: &quot;</span>,upper[<span class="dv">1</span>],<span class="st">&quot; &quot;</span>,upper[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## posterior interval n=10: 138.49 162.98</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="cross.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## posterior predictive interval</span></span>
<span id="cb48-2"><a href="cross.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  upper2<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="fu">mu_n</span>(mu0,ybar,tau02,<span class="dv">10</span>,sigma2),<span class="at">sd=</span><span class="fu">sqrt</span>(<span class="fu">taun2</span>(tau02,<span class="dv">10</span>,sigma2)<span class="sc">+</span>sigma2) ),<span class="dv">2</span>)</span>
<span id="cb48-3"><a href="cross.html#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="cross.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;posterior predictive interval n=10: &quot;</span>,upper2[<span class="dv">1</span>],<span class="st">&quot; &quot;</span>,upper2[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## posterior predictive interval n=10: 109.66 191.8</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="cross.html#cb50-1" aria-hidden="true" tabindex="-1"></a> lower<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">qnorm</span>(<span class="fl">0.025</span>,<span class="fu">mu_n</span>(mu0,ybar,tau02,<span class="dv">100</span>,sigma2),<span class="at">sd=</span><span class="fu">sqrt</span>(<span class="fu">taun2</span>(tau02,<span class="dv">100</span>,sigma2))),<span class="dv">2</span>)</span>
<span id="cb50-2"><a href="cross.html#cb50-2" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>,<span class="fu">mu_n</span>(mu0,ybar,tau02,<span class="dv">100</span>,sigma2),<span class="at">sd=</span><span class="fu">sqrt</span>(<span class="fu">taun2</span>(tau02,<span class="dv">100</span>,sigma2))),<span class="dv">2</span>)</span>
<span id="cb50-3"><a href="cross.html#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="cross.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;posterior interval n=100: &quot;</span>,lower,<span class="st">&quot; &quot;</span>,upper)</span></code></pre></div>
<pre><code>## posterior interval n=100: 146.16 153.99</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="cross.html#cb52-1" aria-hidden="true" tabindex="-1"></a> <span class="do">## this approximately equals the limit</span></span>
<span id="cb52-2"><a href="cross.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;The asymptotic approximation&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The asymptotic approximation&quot;</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="cross.html#cb54-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="at">mean=</span><span class="dv">150</span>, sigma2<span class="sc">/</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 142.1601 157.8399</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="cross.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="do">## posterior predictive interval</span></span>
<span id="cb56-2"><a href="cross.html#cb56-2" aria-hidden="true" tabindex="-1"></a> lower2<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">qnorm</span>(<span class="fl">0.025</span>,<span class="fu">mu_n</span>(mu0,ybar,tau02,<span class="dv">100</span>,sigma2),<span class="at">sd=</span><span class="fu">sqrt</span>(<span class="fu">taun2</span>(tau02,<span class="dv">100</span>,sigma2)<span class="sc">+</span>sigma2) ),<span class="dv">2</span>)</span>
<span id="cb56-3"><a href="cross.html#cb56-3" aria-hidden="true" tabindex="-1"></a>    upper2<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>,<span class="fu">mu_n</span>(mu0,ybar,tau02,<span class="dv">100</span>,sigma2),<span class="at">sd=</span><span class="fu">sqrt</span>(<span class="fu">taun2</span>(tau02,<span class="dv">100</span>,sigma2)<span class="sc">+</span>sigma2) ),<span class="dv">2</span>)</span>
<span id="cb56-4"><a href="cross.html#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="cross.html#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;posterior predictive interval n=100: &quot;</span>,lower2,<span class="st">&quot; &quot;</span>,upper2)</span></code></pre></div>
<pre><code>## posterior predictive interval n=100: 110.68 189.47</code></pre>
</div>
<div id="question-10" class="section level3 unnumbered hasAnchor">
<h3>Question 10<a href="cross.html#question-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>suppose y1,…,y5 are iid Cauchy(<span class="math inline">\(\theta,1\)</span>) r.vs. and the prior distribution for<span class="math inline">\(\theta \sim U[0,100]\)</span>. the given observations are y=43,44,45,46.5,47.5.</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>compute the unnormalized posterior density on a grid of points <span class="math inline">\(\theta=0 1/m, 2/m, ... 100\)</span>. using the grid approximation, compute and plot the posterior density as a function of <span class="math inline">\(\theta\)</span></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="cross.html#cb58-1" aria-hidden="true" tabindex="-1"></a> y<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">45</span>,<span class="fl">46.5</span>,<span class="fl">47.5</span>)</span>
<span id="cb58-2"><a href="cross.html#cb58-2" aria-hidden="true" tabindex="-1"></a> m<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb58-3"><a href="cross.html#cb58-3" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">100000</span>)<span class="sc">/</span>m</span>
<span id="cb58-4"><a href="cross.html#cb58-4" aria-hidden="true" tabindex="-1"></a> <span class="do">## p(theta | y) ~ p(y|theta)*p(theta)</span></span>
<span id="cb58-5"><a href="cross.html#cb58-5" aria-hidden="true" tabindex="-1"></a> unnorm.post<span class="ot">&lt;-</span><span class="fu">dcauchy</span>(y,<span class="at">location=</span>theta,<span class="at">scale=</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">dunif</span>(theta,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">100</span>) <span class="do">## un norm post</span></span>
<span id="cb58-6"><a href="cross.html#cb58-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb58-7"><a href="cross.html#cb58-7" aria-hidden="true" tabindex="-1"></a> post<span class="ot">&lt;-</span>unnorm.post<span class="sc">/</span><span class="fu">sum</span>(unnorm.post)</span>
<span id="cb58-8"><a href="cross.html#cb58-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb58-9"><a href="cross.html#cb58-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(theta,post,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">main=</span><span class="st">&#39;Normalized posterior&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<ul>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Sample 1000 draws from theta from posterior density and plot histogram
we sample from theta [0,100] using the grid approximation, and the probability is from the posterior distribution.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="cross.html#cb59-1" aria-hidden="true" tabindex="-1"></a>  samps<span class="ot">&lt;-</span>(<span class="fu">sample</span>(theta,<span class="dv">1000</span>,<span class="at">prob=</span>post,<span class="at">replace=</span>T))</span>
<span id="cb59-2"><a href="cross.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(samps,<span class="at">main=</span><span class="fu">mean</span>(samps))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="cross.html#cb60-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">##sample mean is close to the mean of the observed.</span></span></code></pre></div>
<ul>
<li><ol start="3" style="list-style-type: lower-alpha">
<li>Using the previous 1000 samples of <span class="math inline">\(\theta\)</span> to obtain 1000 samples from the predictive distribution of a future observation <span class="math inline">\(y_6\)</span>, and plot the predictive draws.
we use the sampled thetas from the posterior to sample from the Cauchy distribution. The predictive probability follows <span class="math inline">\(p(x|y) =\int p(x|\theta)p(\theta|y)d\theta\)</span> where <span class="math inline">\(p(x|\theta)\)</span> follows from the Cauchy distribution, and we have the posterior values for each theta (given the uniform grid of thetas). then for each predictive value, we sum the total probability across all thetas to compute the predictive probability. The maximum predictive value probability 44.745 with probability of 0.10.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="cross.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## predictive distribution ? ?? </span></span>
<span id="cb61-2"><a href="cross.html#cb61-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># p(x | y) = int p(x|theta)*p(theta|y ) dtheta</span></span>
<span id="cb61-3"><a href="cross.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="do">## the posterior is p(theta|y) </span></span>
<span id="cb61-4"><a href="cross.html#cb61-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># the likelihood p(x|theta)  ## we use the sampled thetas using the posterior</span></span>
<span id="cb61-5"><a href="cross.html#cb61-5" aria-hidden="true" tabindex="-1"></a> ytilde<span class="ot">&lt;-</span><span class="fu">rcauchy</span>(<span class="dv">1000</span>,<span class="at">location=</span>samps,<span class="at">scale=</span><span class="dv">1</span>) </span>
<span id="cb61-6"><a href="cross.html#cb61-6" aria-hidden="true" tabindex="-1"></a> <span class="do">## probability of the samples </span></span>
<span id="cb61-7"><a href="cross.html#cb61-7" aria-hidden="true" tabindex="-1"></a> <span class="co">#prob_samp&lt;-post[match(samps,theta)]</span></span>
<span id="cb61-8"><a href="cross.html#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(ytilde) <span class="do">## we have a wide distribution of predictive values.</span></span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -156.02   42.75   45.20   48.98   47.83 3328.92</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="cross.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">## for all predictive values,  find the total probability  </span></span>
<span id="cb63-2"><a href="cross.html#cb63-2" aria-hidden="true" tabindex="-1"></a>   <span class="do">## int p(x|theta)*p(theta|y) d\theta  note that p(x|theta) is a function of theta, so we input hte theta grid.</span></span>
<span id="cb63-3"><a href="cross.html#cb63-3" aria-hidden="true" tabindex="-1"></a> pred.prob<span class="ot">&lt;-</span><span class="fu">sapply</span>(ytilde,<span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">dcauchy</span>(x,<span class="at">location=</span>theta,<span class="at">scale=</span><span class="dv">1</span>)<span class="sc">*</span>post))  </span>
<span id="cb63-4"><a href="cross.html#cb63-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-5"><a href="cross.html#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(ytilde,pred.prob, <span class="at">main=</span><span class="st">&#39;predictive distribution&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="cross.html#cb64-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## maximum predictive probability</span></span>
<span id="cb64-2"><a href="cross.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&#39;max pred. prob &#39;</span>, <span class="fu">round</span>(ytilde[<span class="fu">which</span>(pred.prob<span class="sc">==</span><span class="fu">max</span>(pred.prob))],<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## max pred. prob 44.74</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fundamentals-of-bayesian-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="parts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-single-parameter-models.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
