<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Exercises | Bayesian Data Analysis</title>
  <meta name="description" content="Exercises | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Exercises | Bayesian Data Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Exercises | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Exercises | Bayesian Data Analysis" />
  
  <meta name="twitter:description" content="Exercises | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  

<meta name="author" content="Anthony R. Colombo, Dr. Paul Marjoram" />


<meta name="date" content="2022-08-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-3.html"/>
<link rel="next" href="asymptotics-and-connections-to-non-bayesian-approaches.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#independent-study"><i class="fa fa-check"></i>Independent study</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#supervised-learning"><i class="fa fa-check"></i>Supervised learning</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html"><i class="fa fa-check"></i><b>1</b> Fundamentals of Bayesian Inference</a>
<ul>
<li class="chapter" data-level="1.1" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#general-notation-for-statistical-inference"><i class="fa fa-check"></i><b>1.1</b> General notation for statistical inference</a>
<ul>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#exchangeability"><i class="fa fa-check"></i>Exchangeability</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#explanatory-variables"><i class="fa fa-check"></i>Explanatory variables</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#hierarchical-modeling"><i class="fa fa-check"></i>Hierarchical modeling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#bayesian-inference"><i class="fa fa-check"></i><b>1.2</b> Bayesian inference</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#subjectivity-and-objectivity"><i class="fa fa-check"></i>Subjectivity and Objectivity</a></li>
<li class="chapter" data-level="1.3" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#simulation-100-times"><i class="fa fa-check"></i>Simulation 100 times</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>2</b> Single parameter models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cross.html"><a href="cross.html#estimating-a-probability-from-binomial-data"><i class="fa fa-check"></i><b>2.1</b> Estimating a probability from binomial data</a></li>
<li class="chapter" data-level="2.2" data-path="cross.html"><a href="cross.html#posterior-as-a-compromise-between-data-and-prior-information"><i class="fa fa-check"></i><b>2.2</b> Posterior as a compromise between data and prior information</a></li>
<li class="chapter" data-level="2.3" data-path="cross.html"><a href="cross.html#summarizing-the-posterior-inference"><i class="fa fa-check"></i><b>2.3</b> Summarizing the posterior inference</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#posterior-quantiles-and-intervals"><i class="fa fa-check"></i>Posterior quantiles and intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="cross.html"><a href="cross.html#informative-prior-distributions"><i class="fa fa-check"></i><b>2.4</b> Informative prior distributions</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#conjugate-prior-distributions"><i class="fa fa-check"></i>Conjugate prior distributions</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#conjugate-prior-distributions-exponential-families-and-sufficient-statistics"><i class="fa fa-check"></i>Conjugate prior, distributions, exponential families, and sufficient statistics</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="cross.html"><a href="cross.html#normal-distribution-with-known-variance"><i class="fa fa-check"></i><b>2.5</b> Normal distribution with known variance</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#likelihood-of-one-data-point"><i class="fa fa-check"></i>Likelihood of one data point</a></li>
<li class="chapter" data-level="2.5.1" data-path="cross.html"><a href="cross.html#conjugate-prior-and-posterior-distributions"><i class="fa fa-check"></i><b>2.5.1</b> Conjugate prior and posterior distributions</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#posterior-predictive-distribution"><i class="fa fa-check"></i>Posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-model-with-multiple-observations"><i class="fa fa-check"></i>Normal model with multiple observations</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="cross.html"><a href="cross.html#other-standard-single-parameter-models"><i class="fa fa-check"></i><b>2.6</b> Other standard single-parameter models</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-distribution-with-known-mean-but-unknown-variance"><i class="fa fa-check"></i>Normal distribution with known mean but unknown variance</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#poisson-model"><i class="fa fa-check"></i>Poisson model</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#negative-binomial-distribution"><i class="fa fa-check"></i>Negative Binomial distribution</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#exponential-distribution"><i class="fa fa-check"></i>Exponential distribution</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#constructing-a-prior-distribution"><i class="fa fa-check"></i>Constructing a prior distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="cross.html"><a href="cross.html#noninformative-prior-distributions"><i class="fa fa-check"></i><b>2.7</b> Noninformative prior distributions</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="cross.html"><a href="cross.html#jeffreys-invariance-principle"><i class="fa fa-check"></i><b>2.7.1</b> Jeffreys’ invariance principle</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#difficulties-with-noninformative-prior-distributions"><i class="fa fa-check"></i>Difficulties with noninformative prior distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="cross.html"><a href="cross.html#exercises-1"><i class="fa fa-check"></i><b>2.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-1"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-approximation-example"><i class="fa fa-check"></i>Normal approximation example</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-3"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-4"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-7"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-8-normal-distribution-with-unknown-mean"><i class="fa fa-check"></i>Question 8 (Normal distribution with unknown mean)</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-10"><i class="fa fa-check"></i>Question 10</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-11"><i class="fa fa-check"></i>Question 11</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-12"><i class="fa fa-check"></i>Question 12</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-13"><i class="fa fa-check"></i>Question 13</a></li>
<li class="chapter" data-level="2.8.1" data-path="cross.html"><a href="cross.html#question-21"><i class="fa fa-check"></i><b>2.8.1</b> Question 21</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3.html"><a href="chapter-3.html"><i class="fa fa-check"></i><b>3</b> Chapter 3</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="3.1" data-path="exercises-2.html"><a href="exercises-2.html#question-1-1"><i class="fa fa-check"></i><b>3.1</b> Question 1</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-2"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-3-1"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-4-independent-binomial"><i class="fa fa-check"></i>Question 4 (independent binomial)</a>
<ul>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-4-dirichlet"><i class="fa fa-check"></i>Question 4 (dirichlet)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-5"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-7-1"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-8"><i class="fa fa-check"></i>question 8</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-9"><i class="fa fa-check"></i>question 9</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-11-1"><i class="fa fa-check"></i>Question 11</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html"><i class="fa fa-check"></i><b>4</b> Asymptotics and connections to non-Bayesian approaches</a>
<ul>
<li class="chapter" data-level="4.1" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#normal-approximations-to-the-posterior-distribution"><i class="fa fa-check"></i><b>4.1</b> Normal approximations to the posterior distribution</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#summarizing-posterior-distributions-by-point-estimates-and-standard-errors"><i class="fa fa-check"></i>Summarizing posterior distributions by point estimates and standard errors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#large-sample-theory"><i class="fa fa-check"></i><b>4.2</b> Large-sample theory</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#asymptotic-normality-and-consistency"><i class="fa fa-check"></i>Asymptotic normality and consistency</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#frequency-evaluations-of-bayesian-inferences"><i class="fa fa-check"></i><b>4.3</b> Frequency evaluations of Bayesian inferences</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#large-sample-correspondence"><i class="fa fa-check"></i>Large sample correspondence</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#point-estimation-consistency-and-efficiency"><i class="fa fa-check"></i>Point estimation, consistency, and efficiency</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#confidence-coverage"><i class="fa fa-check"></i>Confidence coverage</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#exercises-3"><i class="fa fa-check"></i><b>4.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-1-2"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="4.4.1" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-4.2-using-the-posterior-sampling-via-grid-approach"><i class="fa fa-check"></i><b>4.4.1</b> Question 4.2 using the posterior sampling via grid approach</a></li>
<li class="chapter" data-level="4.4.2" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#taylor-series-approximation-of-the-information-matrix"><i class="fa fa-check"></i><b>4.4.2</b> Taylor series approximation of the information matrix</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-4-1"><i class="fa fa-check"></i>Question 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>5</b> Blocks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="blocks.html"><a href="blocks.html#equations"><i class="fa fa-check"></i><b>5.1</b> Equations</a></li>
<li class="chapter" data-level="5.2" data-path="blocks.html"><a href="blocks.html#theorems-and-proofs"><i class="fa fa-check"></i><b>5.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="5.3" data-path="blocks.html"><a href="blocks.html#callout-blocks"><i class="fa fa-check"></i><b>5.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>6</b> Sharing your book</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>6.1</b> Publishing</a></li>
<li class="chapter" data-level="6.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>6.2</b> 404 pages</a></li>
<li class="chapter" data-level="6.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>6.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="7" data-path="parts.html"><a href="parts.html"><i class="fa fa-check"></i><b>7</b> Parts</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercises-2" class="section level1 unnumbered hasAnchor">
<h1>Exercises<a href="exercises-2.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="question-1-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Question 1<a href="exercises-2.html#question-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>find the marginal posterior of <span class="math inline">\(\alpha = \theta_1/(\theta_1+\theta_2)\)</span>
We need to find the joint posterior of <span class="math inline">\(\theta_1, \theta_2\)</span> and then perform a change of variables to (<span class="math inline">\(\alpha,\beta)\)</span>. Let the prior <span class="math inline">\(p(\theta)=Diri(a_1,...,a_J)\)</span> where y follows a multinomial likelihood.
<span class="math display">\[
\begin{aligned}
p(\theta | y) &amp;= \prod \theta_j^{y_j}\theta_j^{a_j-1}\\
&amp;= \prod \theta_j^{y_j+a_j-1}\\
&amp; \sim Diri(y_j+a_j)\\
\end{aligned}
\]</span>
The posterior follows a Dirichlet distribution, but we are interested only in the <span class="math inline">\(\theta_1,\theta_2\)</span> parameters and need to find the marginal posterior of these subvectors. The prior marginal follows for <span class="math inline">\(a_0= \sum a_i\)</span> and <span class="math inline">\(y_0= \sum y_i\)</span></li>
</ol></li>
</ul>
<p>From the Appendix A the joint posterior of the sub vector is
<span class="math display">\[
\begin{aligned}
(\theta_1, \theta_2, 1-\theta_1-\theta_2| y ) &amp;\sim Diri(y_1+a_1,y_2+a_2, a_0+y_0-y_1-y_2-a_1-a_2)\\
&amp;p(\theta_1,\theta_2,1-\theta_1-\theta_2) \propto \theta_1^{y_1+a_1-1}\theta_2^{y_2+a_2-1}(1-\theta_1-\theta_2)^{a_0+y_0-y_1-y_2-a_1-a_2-1}\\
\end{aligned}
\]</span>
In order to find the distribution of <span class="math inline">\(\theta_1/(\theta_1+\theta_2)\)</span> we need the jacobian, let (<span class="math inline">\(\alpha,\beta) = (\theta_1/(\theta_1+\theta_2) , \theta_1+\theta_2)\)</span>.
Rearranging the terms we have <span class="math inline">\(\theta_1 = \alpha*\beta\)</span> , and <span class="math inline">\(\theta_2= \beta(1-\alpha)\)</span>
<span class="math display">\[
\begin{aligned}
|J| &amp;= \begin{bmatrix}
\beta &amp; \alpha \\
-\beta &amp; (1-\alpha)\\
\end{bmatrix} \\
&amp;=|\beta|\\
\end{aligned}
\]</span>
where <span class="math inline">\(a&#39;_0 = \sum a_i -a_1 -a_2\)</span>, and <span class="math inline">\(y&#39;_0 =\sum y_i-y_1-y_2\)</span>
<span class="math display">\[
\begin{aligned}
p(\alpha,\beta) &amp;= (\alpha*\beta)^{y_1+a_1-1}(\beta(1-\alpha))^{y_2+a_2-1}(1-\alpha*\beta-\beta(1-\alpha))^{a&#39;_0+y&#39;_0-1}|\beta|\\
&amp;=\alpha^{y_1+a_1-1}(1-\alpha)^{y_2+a_2-1}\beta^{y_1+a_1+y_2+a_2-1}(1-\beta)^{a&#39;_0+y&#39;_0-1}\\
&amp;= Beta(y_1+a_1,y_2+a_2)Beta(y_1+a_1+y_2+a_2, a&#39;_0+y&#39;_0)\\
\end{aligned}
\]</span>
By factorization we integrate out with respect <span class="math inline">\(\beta\)</span> which yields the marginal posterior for <span class="math inline">\(\alpha \sim Beta(y_1+a_1,y_2+a_2)\)</span></p>
<ul>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>To show the relation with binomial let the likelihood <span class="math inline">\(p(y|\alpha) \propto \alpha^y_1 (1-\alpha)^y_2\)</span> and a p(<span class="math inline">\(\alpha)=Beta(a_1,a_2)\)</span> then the posterior is
<span class="math display">\[
\begin{aligned}
p(\alpha | y) &amp;= p(y|\alpha)p(\alpha)\\
&amp;= \alpha^{y_1+a_1-1}(1-\alpha)^{y_2+a_2-1}\\
&amp;= Beta(y_1+a_1,y_2+a_2)
\end{aligned}
\]</span></li>
</ol></li>
</ul>
</div>
<div id="question-2" class="section level2 unnumbered hasAnchor">
<h2>Question 2<a href="exercises-2.html#question-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>639 were polled before the debate and 639 different persons were polled afterward. we let j=1,2 let <span class="math inline">\(\alpha_j\)</span> be proprtion of voters who preferred Bush out of those who had a preference for bush or Dukakis at the time of the survey j. we need to model two different multinomial distributions, and find the posterior probability in <span class="math inline">\(\alpha_2-\alpha_1\)</span>. what was the posterior probability for support of Bush?</p>
<p>There was a 0.355 probability of a shift toward Bush after both debates.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="exercises-2.html#cb184-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(ggplot2)</span>
<span id="cb184-2"><a href="exercises-2.html#cb184-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(magrittr)</span>
<span id="cb184-3"><a href="exercises-2.html#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb184-4"><a href="exercises-2.html#cb184-4" aria-hidden="true" tabindex="-1"></a>debate<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">survey=</span><span class="fu">c</span>(<span class="st">&quot;pre&quot;</span>,<span class="st">&quot;post&quot;</span>), <span class="at">bush=</span><span class="fu">c</span>(<span class="dv">294</span>,<span class="dv">288</span>), <span class="at">dukakis=</span><span class="fu">c</span>(<span class="dv">307</span>,<span class="dv">332</span>),<span class="at">none=</span><span class="fu">c</span>(<span class="dv">38</span>,<span class="dv">19</span>),<span class="at">total=</span><span class="fu">c</span>(<span class="dv">639</span>,<span class="dv">639</span>))</span>
<span id="cb184-5"><a href="exercises-2.html#cb184-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-6"><a href="exercises-2.html#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="co"># we have 3 outcomes bush,duk, none</span></span>
<span id="cb184-7"><a href="exercises-2.html#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="do">## we examine the proportion.</span></span>
<span id="cb184-8"><a href="exercises-2.html#cb184-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-9"><a href="exercises-2.html#cb184-9" aria-hidden="true" tabindex="-1"></a><span class="co"># need to set a theta parameter with sum theta =1</span></span>
<span id="cb184-10"><a href="exercises-2.html#cb184-10" aria-hidden="true" tabindex="-1"></a> theta1<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.45</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb184-11"><a href="exercises-2.html#cb184-11" aria-hidden="true" tabindex="-1"></a> theta2<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.45</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.01</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb184-12"><a href="exercises-2.html#cb184-12" aria-hidden="true" tabindex="-1"></a> theta3<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>(theta1<span class="sc">+</span>theta2)</span>
<span id="cb184-13"><a href="exercises-2.html#cb184-13" aria-hidden="true" tabindex="-1"></a> <span class="fu">all</span>(theta1<span class="sc">+</span>theta2<span class="sc">+</span>theta3 <span class="sc">==</span><span class="dv">1</span>) <span class="do">## sums to  1 for each j</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="exercises-2.html#cb186-1" aria-hidden="true" tabindex="-1"></a> theta<span class="ot">&lt;-</span><span class="fu">data.frame</span>(theta1,theta2,theta3)</span>
<span id="cb186-2"><a href="exercises-2.html#cb186-2" aria-hidden="true" tabindex="-1"></a> <span class="do">## need the pre posterior</span></span>
<span id="cb186-3"><a href="exercises-2.html#cb186-3" aria-hidden="true" tabindex="-1"></a> <span class="do">## the prior alpha1, alpha2 =0 for improper prior</span></span>
<span id="cb186-4"><a href="exercises-2.html#cb186-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(gtools)</span>
<span id="cb186-5"><a href="exercises-2.html#cb186-5" aria-hidden="true" tabindex="-1"></a>  pre.post<span class="ot">&lt;-</span><span class="fu">rdirichlet</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="fu">as.numeric</span>(debate[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])))</span>
<span id="cb186-6"><a href="exercises-2.html#cb186-6" aria-hidden="true" tabindex="-1"></a>   p.post<span class="ot">&lt;-</span><span class="fu">rdirichlet</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="fu">as.numeric</span>(debate[<span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])))</span>
<span id="cb186-7"><a href="exercises-2.html#cb186-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## differences between bush post .vs pre</span></span>
<span id="cb186-8"><a href="exercises-2.html#cb186-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">hist</span>(p.post[,<span class="dv">1</span>]<span class="sc">-</span>pre.post[,<span class="dv">1</span>],<span class="at">main=</span><span class="st">&#39;bush&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="exercises-2.html#cb187-1" aria-hidden="true" tabindex="-1"></a>   <span class="fu">table</span>((p.post[,<span class="dv">1</span>]<span class="sc">-</span>pre.post[,<span class="dv">1</span>])<span class="sc">&gt;</span><span class="dv">0</span>) <span class="do">## 0.355% supported bush post debate.</span></span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   623   377</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="exercises-2.html#cb189-1" aria-hidden="true" tabindex="-1"></a> pre.post2<span class="ot">&lt;-</span><span class="fu">apply</span>(theta,<span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">ddirichlet</span>(x,<span class="fu">as.numeric</span>(debate[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])))</span>
<span id="cb189-2"><a href="exercises-2.html#cb189-2" aria-hidden="true" tabindex="-1"></a> post.post2<span class="ot">&lt;-</span><span class="fu">apply</span>(theta,<span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">ddirichlet</span>(x,<span class="fu">as.numeric</span>(debate[<span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])))</span>
<span id="cb189-3"><a href="exercises-2.html#cb189-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb189-4"><a href="exercises-2.html#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(theta[,<span class="dv">1</span>],pre.post2,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb189-5"><a href="exercises-2.html#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(theta[,<span class="dv">1</span>],post.post2,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-2.png" width="672" /></p>
</div>
<div id="question-3-1" class="section level2 unnumbered hasAnchor">
<h2>Question 3<a href="exercises-2.html#question-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>we are given two independent normal random variables with unknown variances and unknown true means.
- (a) Assume a uniform prior on <span class="math inline">\((\mu_c, \mu_t, log(\sigma_c),log(\sigma_t))\)</span> find the posterior of <span class="math inline">\(\mu_c\)</span> and <span class="math inline">\(\mu_t\)</span>.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="exercises-2.html#cb190-1" aria-hidden="true" tabindex="-1"></a> nc <span class="ot">=</span><span class="dv">32</span></span>
<span id="cb190-2"><a href="exercises-2.html#cb190-2" aria-hidden="true" tabindex="-1"></a> nt<span class="ot">=</span> <span class="dv">36</span></span>
<span id="cb190-3"><a href="exercises-2.html#cb190-3" aria-hidden="true" tabindex="-1"></a> mc <span class="ot">=</span> <span class="fl">1.013</span></span>
<span id="cb190-4"><a href="exercises-2.html#cb190-4" aria-hidden="true" tabindex="-1"></a> sdc <span class="ot">=</span> <span class="fl">0.24</span></span>
<span id="cb190-5"><a href="exercises-2.html#cb190-5" aria-hidden="true" tabindex="-1"></a> mt <span class="ot">=</span> <span class="fl">1.173</span></span>
<span id="cb190-6"><a href="exercises-2.html#cb190-6" aria-hidden="true" tabindex="-1"></a> sdt <span class="ot">=</span> <span class="fl">0.24</span></span>
<span id="cb190-7"><a href="exercises-2.html#cb190-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb190-8"><a href="exercises-2.html#cb190-8" aria-hidden="true" tabindex="-1"></a> <span class="do">### unknow true mean/variances  we only have sample data.</span></span>
<span id="cb190-9"><a href="exercises-2.html#cb190-9" aria-hidden="true" tabindex="-1"></a> <span class="do">## we have two unknowns and need to find the joint posterior distribution.</span></span>
<span id="cb190-10"><a href="exercises-2.html#cb190-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb190-11"><a href="exercises-2.html#cb190-11" aria-hidden="true" tabindex="-1"></a> <span class="co"># the marginal posterior of mc follows a t-dist.</span></span>
<span id="cb190-12"><a href="exercises-2.html#cb190-12" aria-hidden="true" tabindex="-1"></a>  mc_range<span class="ot">&lt;-</span><span class="fu">c</span>(mc<span class="sc">-</span>sdc<span class="sc">/</span><span class="fu">sqrt</span>(nc)<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>nc<span class="dv">-1</span>),mc<span class="sc">+</span>sdc<span class="sc">/</span><span class="fu">sqrt</span>(nc)<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>nc<span class="dv">-1</span>))</span>
<span id="cb190-13"><a href="exercises-2.html#cb190-13" aria-hidden="true" tabindex="-1"></a>   mt_range<span class="ot">&lt;-</span><span class="fu">c</span>(mt<span class="sc">-</span>sdt<span class="sc">/</span><span class="fu">sqrt</span>(nt)<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>nt<span class="dv">-1</span>),mt<span class="sc">+</span>sdt<span class="sc">/</span><span class="fu">sqrt</span>(nt)<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>nt<span class="dv">-1</span>))</span>
<span id="cb190-14"><a href="exercises-2.html#cb190-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-15"><a href="exercises-2.html#cb190-15" aria-hidden="true" tabindex="-1"></a><span class="do">## to sample from the posterior we use 3.5 and 3.3 equations</span></span>
<span id="cb190-16"><a href="exercises-2.html#cb190-16" aria-hidden="true" tabindex="-1"></a>   posterior_sample<span class="ot">&lt;-</span><span class="cf">function</span>( <span class="at">mc=</span><span class="dv">1</span>, <span class="at">sdc=</span><span class="dv">1</span>, <span class="at">nc=</span><span class="dv">10</span>){</span>
<span id="cb190-17"><a href="exercises-2.html#cb190-17" aria-hidden="true" tabindex="-1"></a>   invx2<span class="ot">&lt;-</span>((nc<span class="dv">-1</span>)<span class="sc">*</span>sdc<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">rchisq</span>(<span class="dv">1</span>,nc<span class="dv">-1</span>)</span>
<span id="cb190-18"><a href="exercises-2.html#cb190-18" aria-hidden="true" tabindex="-1"></a>    post.mu<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>mc,<span class="at">sd=</span><span class="fu">sqrt</span>(invx2<span class="sc">/</span>nc))</span>
<span id="cb190-19"><a href="exercises-2.html#cb190-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(post.mu)</span>
<span id="cb190-20"><a href="exercises-2.html#cb190-20" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb190-21"><a href="exercises-2.html#cb190-21" aria-hidden="true" tabindex="-1"></a>   post_mc<span class="ot">&lt;-</span><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,<span class="cf">function</span>(x) <span class="fu">posterior_sample</span>(<span class="at">mc=</span>mc,<span class="at">sdc=</span>sdc,<span class="at">nc=</span>nc))</span>
<span id="cb190-22"><a href="exercises-2.html#cb190-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(post_mc,<span class="at">main=</span><span class="st">&#39;posterior marginal control&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="exercises-2.html#cb191-1" aria-hidden="true" tabindex="-1"></a>    post_mt<span class="ot">&lt;-</span><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,<span class="cf">function</span>(x) <span class="fu">posterior_sample</span>(<span class="at">mc=</span>mt,<span class="at">sdc=</span>sdt,<span class="at">nc=</span>nt))</span>
<span id="cb191-2"><a href="exercises-2.html#cb191-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">hist</span>(post_mt,<span class="at">main=</span><span class="st">&#39;posterior marginal treat&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-2.png" width="672" /></p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="exercises-2.html#cb192-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&quot;95% posterior margin control:&quot;</span>, <span class="fu">round</span>(mc_range[<span class="dv">1</span>],<span class="dv">2</span>),<span class="st">&quot; &quot;</span>,<span class="fu">round</span>(mc_range[<span class="dv">2</span>],<span class="dv">2</span>)) </span></code></pre></div>
<pre><code>## 95% posterior margin control:0.93 1.1</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="exercises-2.html#cb194-1" aria-hidden="true" tabindex="-1"></a>        <span class="fu">message</span>(<span class="st">&quot;95% posterior margin control:&quot;</span>, <span class="fu">round</span>(mt_range[<span class="dv">1</span>],<span class="dv">2</span>),<span class="st">&quot; &quot;</span>,<span class="fu">round</span>(mt_range[<span class="dv">2</span>],<span class="dv">2</span>)) </span></code></pre></div>
<pre><code>## 95% posterior margin control:1.09 1.25</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="exercises-2.html#cb196-1" aria-hidden="true" tabindex="-1"></a>        <span class="fu">quantile</span>(post_mc,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.9289259 1.1003646</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="exercises-2.html#cb198-1" aria-hidden="true" tabindex="-1"></a>        <span class="fu">quantile</span>(post_mt,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##     2.5%    97.5% 
## 1.089285 1.252860</code></pre>
<ul>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>what is <span class="math inline">\(\mu_t - \mu_c\)</span></li>
</ol></li>
</ul>
<p>The posterior interval (central) of the differences between 2 independent t-distributoins is 0.16 (0.04, 0.28), which closely matches the posterior simulation interval (0.0338, 0.281). Here since both are independent we use <span class="math inline">\(X-Y\sim N(\mu_x-\mu_y, sd_x+sd_y)\)</span> as the sampling distribution.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="exercises-2.html#cb200-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(post_mt<span class="sc">-</span>post_mc, <span class="at">main =</span> <span class="st">&#39; Difference between sampled posteriors&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="exercises-2.html#cb201-1" aria-hidden="true" tabindex="-1"></a>         <span class="fu">quantile</span>(post_mt<span class="sc">-</span>post_mc,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## 0.04272829 0.27060943</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="exercises-2.html#cb203-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## diff</span></span>
<span id="cb203-2"><a href="exercises-2.html#cb203-2" aria-hidden="true" tabindex="-1"></a>         post_diff<span class="ot">&lt;-</span><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,<span class="cf">function</span>(x) <span class="fu">posterior_sample</span>(<span class="at">mc=</span>mt<span class="sc">-</span>mc,<span class="at">sdc=</span>sdt<span class="sc">+</span>sdc,<span class="at">nc=</span>nt<span class="sc">+</span>nc))</span>
<span id="cb203-3"><a href="exercises-2.html#cb203-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(post_diff, <span class="at">main=</span><span class="st">&#39;simulated difference&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-2.png" width="672" /></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="exercises-2.html#cb204-1" aria-hidden="true" tabindex="-1"></a>             <span class="fu">quantile</span>(post_diff,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## 0.03802761 0.27289044</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="exercises-2.html#cb206-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## theoretical (two independent t distributions)</span></span>
<span id="cb206-2"><a href="exercises-2.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  md <span class="ot">=</span> mt<span class="sc">-</span>mc</span>
<span id="cb206-3"><a href="exercises-2.html#cb206-3" aria-hidden="true" tabindex="-1"></a>  sdd <span class="ot">=</span> sdt<span class="sc">+</span>sdc</span>
<span id="cb206-4"><a href="exercises-2.html#cb206-4" aria-hidden="true" tabindex="-1"></a>  nd <span class="ot">=</span> nt<span class="sc">+</span>nc</span>
<span id="cb206-5"><a href="exercises-2.html#cb206-5" aria-hidden="true" tabindex="-1"></a>  d_range<span class="ot">&lt;-</span><span class="fu">c</span>(md<span class="sc">-</span>sdd<span class="sc">/</span><span class="fu">sqrt</span>(nd)<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>nd<span class="dv">-1</span>),md<span class="sc">+</span>sdd<span class="sc">/</span><span class="fu">sqrt</span>(nd)<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>nd<span class="dv">-1</span>))</span>
<span id="cb206-6"><a href="exercises-2.html#cb206-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(d_range)</span></code></pre></div>
<pre><code>## [1] 0.04381525 0.27618475</code></pre>
</div>
<div id="question-4-independent-binomial" class="section level2 unnumbered hasAnchor">
<h2>Question 4 (independent binomial)<a href="exercises-2.html#question-4-independent-binomial" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>so using the multinomial is not correct because we do not have k outcomes, instead we have 2 independent binomial processes (as the question states!) so we modeled the independent likelihoods, which is a product of independent beta distributions.</p>
<p><span class="math inline">\(p(p_0,p_1) \propto p(x| p_0,p_1)p(p_0,p_1) = p_0^{38.5}(1-p_0)^{634.5}p_1^{21.5}(1-p_1)^{657.5}\)</span></p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="exercises-2.html#cb208-1" aria-hidden="true" tabindex="-1"></a>p0<span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.99</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb208-2"><a href="exercises-2.html#cb208-2" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.99</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb208-3"><a href="exercises-2.html#cb208-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-4"><a href="exercises-2.html#cb208-4" aria-hidden="true" tabindex="-1"></a>post.bin<span class="ot">&lt;-</span><span class="cf">function</span>(p0,p1){</span>
<span id="cb208-5"><a href="exercises-2.html#cb208-5" aria-hidden="true" tabindex="-1"></a>  pos<span class="ot">&lt;-</span> p0<span class="sc">^</span>(<span class="fl">38.5</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p0)<span class="sc">^</span>(<span class="fl">634.5</span>)<span class="sc">*</span>p1<span class="sc">^</span>(<span class="fl">21.5</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">^</span>(<span class="fl">657.5</span>)</span>
<span id="cb208-6"><a href="exercises-2.html#cb208-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pos)</span>
<span id="cb208-7"><a href="exercises-2.html#cb208-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb208-8"><a href="exercises-2.html#cb208-8" aria-hidden="true" tabindex="-1"></a> posts<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb208-9"><a href="exercises-2.html#cb208-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb208-10"><a href="exercises-2.html#cb208-10" aria-hidden="true" tabindex="-1"></a>p0p1<span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(p0, p1)</span>
<span id="cb208-11"><a href="exercises-2.html#cb208-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-12"><a href="exercises-2.html#cb208-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p0p1)){</span>
<span id="cb208-13"><a href="exercises-2.html#cb208-13" aria-hidden="true" tabindex="-1"></a>  posts[i]<span class="ot">&lt;-</span><span class="fu">post.bin</span>(p0p1[i,<span class="st">&quot;Var1&quot;</span>],p0p1[i,<span class="st">&quot;Var2&quot;</span>]) </span>
<span id="cb208-14"><a href="exercises-2.html#cb208-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb208-15"><a href="exercises-2.html#cb208-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-16"><a href="exercises-2.html#cb208-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(p0p1)<span class="sc">+</span></span>
<span id="cb208-17"><a href="exercises-2.html#cb208-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">z =</span> posts), <span class="at">bins =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<ul>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>summarize the odds ratio
Note that using a 2x2 table the OR is 0.54 and the independent binomials do approximate well.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="exercises-2.html#cb209-1" aria-hidden="true" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="fu">sapply</span>(p0,<span class="cf">function</span>(x) <span class="fu">pbeta</span>(x,<span class="fl">38.5</span>,<span class="fl">634.5</span>))</span>
<span id="cb209-2"><a href="exercises-2.html#cb209-2" aria-hidden="true" tabindex="-1"></a> post.control<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="fl">38.5</span>,<span class="fl">634.5</span>)</span>
<span id="cb209-3"><a href="exercises-2.html#cb209-3" aria-hidden="true" tabindex="-1"></a>  post.treat<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="fl">21.5</span>,<span class="fl">657.5</span>)</span>
<span id="cb209-4"><a href="exercises-2.html#cb209-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-5"><a href="exercises-2.html#cb209-5" aria-hidden="true" tabindex="-1"></a>  or<span class="ot">&lt;-</span>(post.treat<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>post.treat))<span class="sc">/</span>(post.control<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>post.control))</span>
<span id="cb209-6"><a href="exercises-2.html#cb209-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(or,<span class="at">main=</span><span class="st">&#39;treatment odds empriical posterior&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="exercises-2.html#cb210-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(or)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2077  0.4439  0.5374  0.5612  0.6582  1.3765</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="exercises-2.html#cb212-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;the empricial OR: &quot;</span>, <span class="fu">round</span>((<span class="dv">22</span><span class="sc">*</span><span class="dv">635</span>)<span class="sc">/</span>(<span class="dv">39</span><span class="sc">*</span><span class="dv">658</span>),<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## the empricial OR: 0.54</code></pre>
<ul>
<li><ol start="3" style="list-style-type: lower-alpha">
<li>the sensitivity of the noninformative prior density
If we use the prior Beta(1,1) as the uniform prior we do see marginal changes to the posterior mean 0.5639.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="exercises-2.html#cb214-1" aria-hidden="true" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="fu">sapply</span>(p0,<span class="cf">function</span>(x) <span class="fu">pbeta</span>(x,<span class="fl">39.5</span>,<span class="fl">635.5</span>))</span>
<span id="cb214-2"><a href="exercises-2.html#cb214-2" aria-hidden="true" tabindex="-1"></a> post.control<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="fl">39.5</span>,<span class="fl">635.5</span>)</span>
<span id="cb214-3"><a href="exercises-2.html#cb214-3" aria-hidden="true" tabindex="-1"></a>  post.treat<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="fl">22.5</span>,<span class="fl">658.5</span>)</span>
<span id="cb214-4"><a href="exercises-2.html#cb214-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-5"><a href="exercises-2.html#cb214-5" aria-hidden="true" tabindex="-1"></a>  or<span class="ot">&lt;-</span>(post.treat<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>post.treat))<span class="sc">/</span>(post.control<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>post.control))</span>
<span id="cb214-6"><a href="exercises-2.html#cb214-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(or,<span class="at">main=</span><span class="st">&#39;treatment odds empriical posterior&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="exercises-2.html#cb215-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(or)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2105  0.4548  0.5445  0.5640  0.6546  1.2273</code></pre>
<div id="question-4-dirichlet" class="section level3 unnumbered hasAnchor">
<h3>Question 4 (dirichlet)<a href="exercises-2.html#question-4-dirichlet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>(4a) set up a noninformative prior on <span class="math inline">\((p_0,p_1)\)</span> and obtain posterior simulations. Assume outcomes are independent and binomially distributed. The posterior for probability of death is Diri(39+1, 22+1, 675,681)</li>
<li>the dirichlet is the event of rolling a 4 sided die, whereas this problem is rolling independent 2 sided die, however the dirichlet does approximate independnet binomial processes well.</li>
</ul>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="exercises-2.html#cb217-1" aria-hidden="true" tabindex="-1"></a> nc<span class="ot">=</span> <span class="dv">674</span></span>
<span id="cb217-2"><a href="exercises-2.html#cb217-2" aria-hidden="true" tabindex="-1"></a> dc<span class="ot">=</span> <span class="dv">39</span></span>
<span id="cb217-3"><a href="exercises-2.html#cb217-3" aria-hidden="true" tabindex="-1"></a> nt <span class="ot">=</span> <span class="dv">680</span></span>
<span id="cb217-4"><a href="exercises-2.html#cb217-4" aria-hidden="true" tabindex="-1"></a> dt <span class="ot">=</span> <span class="dv">22</span></span>
<span id="cb217-5"><a href="exercises-2.html#cb217-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-6"><a href="exercises-2.html#cb217-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb217-7"><a href="exercises-2.html#cb217-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb217-8"><a href="exercises-2.html#cb217-8" aria-hidden="true" tabindex="-1"></a> <span class="do">## we have two categories Control ~Bin(p0) and Treat~Bin(p1) we use multinomial</span></span>
<span id="cb217-9"><a href="exercises-2.html#cb217-9" aria-hidden="true" tabindex="-1"></a> <span class="do">## non-informative prior Diri(a1=1, a2=1)</span></span>
<span id="cb217-10"><a href="exercises-2.html#cb217-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(gtools)</span>
<span id="cb217-11"><a href="exercises-2.html#cb217-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## p( p0, p1) = Diri( 1,1) noninfom prior</span></span>
<span id="cb217-12"><a href="exercises-2.html#cb217-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p( p0,p1 | y) = Diri(  39+1, 22+1) ##  posterior</span></span>
<span id="cb217-13"><a href="exercises-2.html#cb217-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb217-14"><a href="exercises-2.html#cb217-14" aria-hidden="true" tabindex="-1"></a> treat.post<span class="ot">&lt;-</span><span class="fu">rdirichlet</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">39</span><span class="sc">+</span><span class="dv">1</span>,<span class="dv">22</span><span class="sc">+</span><span class="dv">1</span>, <span class="dv">674</span><span class="sc">+</span><span class="dv">1</span>,<span class="dv">680</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb217-15"><a href="exercises-2.html#cb217-15" aria-hidden="true" tabindex="-1"></a> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb217-16"><a href="exercises-2.html#cb217-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(treat.post[,<span class="dv">1</span>],<span class="at">main=</span><span class="st">&quot;post control&quot;</span>)</span>
<span id="cb217-17"><a href="exercises-2.html#cb217-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(treat.post[,<span class="dv">2</span>],<span class="at">main=</span><span class="st">&#39;post treat&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<ul>
<li>(4b) The posterior odds has a mean of 0.58 using non-informative prior. Using the empirical odds ratio we see the odds of death is 0.546 comparing treatment to controls.</li>
</ul>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="exercises-2.html#cb218-1" aria-hidden="true" tabindex="-1"></a> <span class="do">## data table</span></span>
<span id="cb218-2"><a href="exercises-2.html#cb218-2" aria-hidden="true" tabindex="-1"></a> dd<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">none=</span><span class="fu">c</span>(<span class="dv">674-39</span>,<span class="dv">680-22</span>),<span class="at">outcome=</span><span class="fu">c</span>(<span class="dv">39</span>,<span class="dv">22</span>),<span class="at">row.names=</span><span class="fu">c</span>(<span class="st">&#39;unexp&#39;</span>,<span class="st">&#39;exp&#39;</span>))</span>
<span id="cb218-3"><a href="exercises-2.html#cb218-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(epitools)</span>
<span id="cb218-4"><a href="exercises-2.html#cb218-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">oddsratio</span>(<span class="fu">as.matrix</span>(dd))<span class="sc">$</span>measure</span></code></pre></div>
<pre><code>##                         NA
## odds ratio with 95% C.I.  estimate     lower     upper
##                    unexp 1.0000000        NA        NA
##                    exp   0.5463245 0.3147296 0.9249902</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="exercises-2.html#cb220-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## b</span></span>
<span id="cb220-2"><a href="exercises-2.html#cb220-2" aria-hidden="true" tabindex="-1"></a>  or<span class="ot">&lt;-</span>(treat.post[,<span class="dv">2</span>]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>treat.post[,<span class="dv">2</span>]))<span class="sc">/</span>(treat.post[,<span class="dv">1</span>]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>treat.post[,<span class="dv">1</span>]))</span>
<span id="cb220-3"><a href="exercises-2.html#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(or)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2030  0.4674  0.5592  0.5808  0.6711  1.2856</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="exercises-2.html#cb222-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(or,<span class="at">main=</span><span class="st">&#39;treatment odds&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<ul>
<li>(4c) showing the improper prior (a=0), the posterior odds is 0.5793 which is very robust and similar to the noninformative. Using the emprical prior that sets the prior hyperparameters to the cohort expected number of deaths <span class="math inline">\((39/674)*Total = 79\)</span>, and <span class="math inline">\((22/658)*Total = 45\)</span> and a prior cohort size of 677 =(674+680)/2, yields a similar posterior mean of approximately 0.57 for the odds ratio. Hence the posterior is robust to the choice of prior but does not match well with the empirical non-parametric odds.</li>
</ul>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="exercises-2.html#cb223-1" aria-hidden="true" tabindex="-1"></a> treat.post<span class="ot">&lt;-</span><span class="fu">rdirichlet</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">39</span>,<span class="dv">22</span>,<span class="dv">674</span>,<span class="dv">680</span>))</span>
<span id="cb223-2"><a href="exercises-2.html#cb223-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb223-3"><a href="exercises-2.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb223-4"><a href="exercises-2.html#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## b</span></span>
<span id="cb223-5"><a href="exercises-2.html#cb223-5" aria-hidden="true" tabindex="-1"></a>  or<span class="ot">&lt;-</span>(treat.post[,<span class="dv">2</span>]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>treat.post[,<span class="dv">2</span>]))<span class="sc">/</span>(treat.post[,<span class="dv">1</span>]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>treat.post[,<span class="dv">1</span>]))</span>
<span id="cb223-6"><a href="exercises-2.html#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(or,<span class="at">main=</span><span class="st">&#39;treatment odds &#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="exercises-2.html#cb224-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(or)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2172  0.4620  0.5548  0.5725  0.6663  1.2539</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="exercises-2.html#cb226-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## empirical</span></span>
<span id="cb226-2"><a href="exercises-2.html#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># control = (39/674)*1354 = 78.34718</span></span>
<span id="cb226-3"><a href="exercises-2.html#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># treat = (22/658)*1354 = 45.27052</span></span>
<span id="cb226-4"><a href="exercises-2.html#cb226-4" aria-hidden="true" tabindex="-1"></a>  treat.post<span class="ot">&lt;-</span><span class="fu">rdirichlet</span>(<span class="dv">1000</span>, <span class="fu">c</span>(<span class="dv">39</span><span class="sc">+</span><span class="dv">79</span>,<span class="dv">22</span><span class="sc">+</span><span class="dv">46</span>,<span class="dv">674</span><span class="sc">+</span><span class="dv">677</span>,<span class="dv">680</span><span class="sc">+</span><span class="dv">677</span>))</span>
<span id="cb226-5"><a href="exercises-2.html#cb226-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb226-6"><a href="exercises-2.html#cb226-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb226-7"><a href="exercises-2.html#cb226-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## b</span></span>
<span id="cb226-8"><a href="exercises-2.html#cb226-8" aria-hidden="true" tabindex="-1"></a>  or<span class="ot">&lt;-</span>(treat.post[,<span class="dv">2</span>]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>treat.post[,<span class="dv">2</span>]))<span class="sc">/</span>(treat.post[,<span class="dv">1</span>]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>treat.post[,<span class="dv">1</span>]))</span>
<span id="cb226-9"><a href="exercises-2.html#cb226-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(or,<span class="at">main=</span><span class="st">&#39;treatment odds empriical posterior&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="exercises-2.html#cb227-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(or)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.3307  0.5078  0.5602  0.5693  0.6246  0.9831</code></pre>
</div>
</div>
<div id="question-5" class="section level2 unnumbered hasAnchor">
<h2>Question 5<a href="exercises-2.html#question-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Give the posterior distribution of <span class="math inline">\(\mu, \sigma^2\)</span> obtained by pretending the observations are exact, unrounded, measurements. we choose a prior for <span class="math inline">\(\theta \sim Gamma(0.1,0.01)\)</span> which has a mean and variance of 10.4 and 1000. Using a Poisson likelihood, the mean is 10.4 and variance 2.2 from the posterior.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="exercises-2.html#cb229-1" aria-hidden="true" tabindex="-1"></a> obs<span class="ot">=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">11</span>,<span class="dv">9</span>)</span>
<span id="cb229-2"><a href="exercises-2.html#cb229-2" aria-hidden="true" tabindex="-1"></a> <span class="do">### under the exact model, we can not use a binomial because we do not have a proportion (p0) that we can estimate. we do not have a r.v. for &#39;successes&#39;.</span></span>
<span id="cb229-3"><a href="exercises-2.html#cb229-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># we can use the Poisson distribution </span></span>
<span id="cb229-4"><a href="exercises-2.html#cb229-4" aria-hidden="true" tabindex="-1"></a> <span class="do">## not sure how to use jeffreys prior</span></span>
<span id="cb229-5"><a href="exercises-2.html#cb229-5" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fl">0.1</span></span>
<span id="cb229-6"><a href="exercises-2.html#cb229-6" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span><span class="fl">0.01</span></span>
<span id="cb229-7"><a href="exercises-2.html#cb229-7" aria-hidden="true" tabindex="-1"></a>  pois.post<span class="ot">&lt;-</span><span class="fu">rgamma</span>(<span class="dv">1000</span>,a<span class="sc">+</span><span class="dv">5</span><span class="sc">*</span><span class="fu">mean</span>(obs),b<span class="sc">+</span><span class="dv">5</span>)</span>
<span id="cb229-8"><a href="exercises-2.html#cb229-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(pois.post,<span class="at">main=</span><span class="st">&#39;count posterior&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="exercises-2.html#cb230-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># post summary  mean : 8.8,  var= 1.47</span></span>
<span id="cb230-2"><a href="exercises-2.html#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(pois.post)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   5.516   9.361  10.290  10.356  11.274  16.963</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="exercises-2.html#cb232-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(pois.post)</span></code></pre></div>
<pre><code>## [1] 10.35623</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="exercises-2.html#cb234-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span>(pois.post)</span></code></pre></div>
<pre><code>## [1] 2.064425</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="exercises-2.html#cb236-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">density</span>(pois.post),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>),<span class="at">main=</span><span class="st">&#39;pois posterior&#39;</span>)</span>
<span id="cb236-2"><a href="exercises-2.html#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(obs),<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-2.png" width="672" /></p>
<ul>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Give the correct posterior distribution treating the measurements as rounded
Using non informative prior for both unknowns, the posterior mean is 10.4 and posterior variance is 0.433</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="exercises-2.html#cb237-1" aria-hidden="true" tabindex="-1"></a> <span class="do">## normal with 2 unknowns.</span></span>
<span id="cb237-2"><a href="exercises-2.html#cb237-2" aria-hidden="true" tabindex="-1"></a> <span class="do">## joint poisterior</span></span>
<span id="cb237-3"><a href="exercises-2.html#cb237-3" aria-hidden="true" tabindex="-1"></a> <span class="do">## need the  sigma2 | y ~ inv-x2(n-1,s2)</span></span>
<span id="cb237-4"><a href="exercises-2.html#cb237-4" aria-hidden="true" tabindex="-1"></a>  nu <span class="ot">=</span> <span class="fu">length</span>(obs)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb237-5"><a href="exercises-2.html#cb237-5" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">=</span> <span class="fu">var</span>(obs)</span>
<span id="cb237-6"><a href="exercises-2.html#cb237-6" aria-hidden="true" tabindex="-1"></a>  chi2<span class="ot">=</span> <span class="fu">rchisq</span>(<span class="dv">1000</span>, nu)</span>
<span id="cb237-7"><a href="exercises-2.html#cb237-7" aria-hidden="true" tabindex="-1"></a>   <span class="do">## inv-chi2  v*s^2/X  (Appendix A)</span></span>
<span id="cb237-8"><a href="exercises-2.html#cb237-8" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="ot">=</span> nu<span class="sc">*</span>s2<span class="sc">/</span>chi2</span>
<span id="cb237-9"><a href="exercises-2.html#cb237-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## posterior prob   =  p(m | sigma2, y)p(sigma2|y)</span></span>
<span id="cb237-10"><a href="exercises-2.html#cb237-10" aria-hidden="true" tabindex="-1"></a>   <span class="do">## for each variance term  draw   N( ybar,  sd= sqrt(sigma2/n))</span></span>
<span id="cb237-11"><a href="exercises-2.html#cb237-11" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">sapply</span>(sigma2,<span class="cf">function</span>(x) <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean=</span><span class="fu">mean</span>(obs), <span class="at">sd=</span><span class="fu">sqrt</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">5</span>)))</span>
<span id="cb237-12"><a href="exercises-2.html#cb237-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(y,<span class="at">main=</span><span class="st">&#39;posterior normal&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="exercises-2.html#cb238-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">density</span>(y),<span class="at">main=</span><span class="st">&#39;posterior normal density&#39;</span>)</span>
<span id="cb238-2"><a href="exercises-2.html#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(obs),<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-2.png" width="672" />
- (c) how do the correct/incorrect differ, compare means/variances</p>
<p>The difference in means is approximately 0, with a variance (residual) of 2.7.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="exercises-2.html#cb239-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">mean</span>( y <span class="sc">-</span> pois.post) <span class="co"># 0.002926538</span></span></code></pre></div>
<pre><code>## [1] 0.06914787</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="exercises-2.html#cb241-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">var</span>( y <span class="sc">-</span> pois.post) <span class="co"># 2.7</span></span></code></pre></div>
<pre><code>## [1] 2.462133</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="exercises-2.html#cb243-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(y<span class="sc">-</span>pois.post)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="exercises-2.html#cb244-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(y,pois.post,<span class="at">main=</span><span class="st">&quot;normal vs. pois likelihoods&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-2.png" width="672" /></p>
<ul>
<li><ol start="4" style="list-style-type: lower-alpha">
<li>Let z=(z1,z2,z3,z4,z5) be the original unrounded measurements corresponding to the five observations above. draw simulations of z and compare the posterior <span class="math inline">\((z1-z2)^2\)</span>.</li>
</ol></li>
</ul>
<p>For this we sample from the normal posterior distribution, conditioned on the rounded values to match the observed. For each sample of the posterior, the rounded values are conditioned to match the observed data. The mean difference of (<span class="math inline">\(z_1-z_2)^2\)</span> is 0.14, with variance of 0.03.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="exercises-2.html#cb245-1" aria-hidden="true" tabindex="-1"></a> generateObs<span class="ot">&lt;-</span><span class="cf">function</span>(obs){</span>
<span id="cb245-2"><a href="exercises-2.html#cb245-2" aria-hidden="true" tabindex="-1"></a>   z<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb245-3"><a href="exercises-2.html#cb245-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb245-4"><a href="exercises-2.html#cb245-4" aria-hidden="true" tabindex="-1"></a> zi<span class="ot">=</span> <span class="fu">sample</span>(y,<span class="dv">1</span>)</span>
<span id="cb245-5"><a href="exercises-2.html#cb245-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>( <span class="fu">round</span>(zi)<span class="sc">!=</span>obs[i]){</span>
<span id="cb245-6"><a href="exercises-2.html#cb245-6" aria-hidden="true" tabindex="-1"></a>    zi<span class="ot">=</span><span class="fu">sample</span>(y,<span class="dv">1</span>)</span>
<span id="cb245-7"><a href="exercises-2.html#cb245-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb245-8"><a href="exercises-2.html#cb245-8" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">c</span>(z,zi)</span>
<span id="cb245-9"><a href="exercises-2.html#cb245-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb245-10"><a href="exercises-2.html#cb245-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">round</span>(z)<span class="sc">==</span>obs))</span>
<span id="cb245-11"><a href="exercises-2.html#cb245-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(z)</span>
<span id="cb245-12"><a href="exercises-2.html#cb245-12" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb245-13"><a href="exercises-2.html#cb245-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb245-14"><a href="exercises-2.html#cb245-14" aria-hidden="true" tabindex="-1"></a> ERR<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb245-15"><a href="exercises-2.html#cb245-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-16"><a href="exercises-2.html#cb245-16" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb245-17"><a href="exercises-2.html#cb245-17" aria-hidden="true" tabindex="-1"></a>   <span class="do">## generate z samples such that round(z) == obs</span></span>
<span id="cb245-18"><a href="exercises-2.html#cb245-18" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">generateObs</span>(obs)</span>
<span id="cb245-19"><a href="exercises-2.html#cb245-19" aria-hidden="true" tabindex="-1"></a>  err<span class="ot">&lt;-</span> (z[<span class="dv">1</span>]<span class="sc">-</span>z[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb245-20"><a href="exercises-2.html#cb245-20" aria-hidden="true" tabindex="-1"></a> ERR<span class="ot">&lt;-</span><span class="fu">c</span>(ERR,err)</span>
<span id="cb245-21"><a href="exercises-2.html#cb245-21" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb245-22"><a href="exercises-2.html#cb245-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="st">&quot;mean error:&quot;</span>,<span class="fu">mean</span>(ERR))</span></code></pre></div>
<pre><code>## mean error:0.147969012944691</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="exercises-2.html#cb247-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(ERR)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-1.png" width="672" />
## Question 6{-}
Consider data y1,…,yn modeled as independent Bin(N,<span class="math inline">\(\theta\)</span>) with both N and <span class="math inline">\(\theta\)</span> unknown.</p>
<p>First we examine that <span class="math inline">\(p(\lambda,\theta)\propto 1/\lambda\)</span> described by Raftery (1988). We take the product of a vague prior for <span class="math inline">\(\lambda\)</span> and the uniform prior for <span class="math inline">\(\theta\)</span>. let <span class="math inline">\(\theta \sim U[0,1]\)</span> be uniform and use the uniform prior for <span class="math inline">\(\lambda\)</span> as a vague prior. The motivation here is to use a uniform vague prior on the hyperparameter. Alternatively we can use Jeffreys’ Prior for Pois(<span class="math inline">\(\lambda) = 1/\sqrt{\lambda}\)</span> where the <span class="math inline">\(-E(\partial l^2 / \partial \lambda^2) = 1/\lambda\)</span> is known for the Poisson.
<span class="math display">\[
\begin{aligned}
p(\lambda,\theta) &amp;\propto (1)1/\lambda\\
&amp;\propto \lambda^{-1}\\
\end{aligned}
\]</span>
- (a) to write the prior N<span class="math inline">\(\sim P(\lambda)\)</span> as a sampling distribution, but we can let N follow a Gamma, with a Gamma(0,0) vague prior initially and independent of <span class="math inline">\(\theta\)</span>. where <span class="math inline">\(\theta \sim U(0,1)\)</span> as a uniform probability. Then <span class="math inline">\(P(N,\theta) = P(N|\theta)p(\theta)\)</span>. Note this is an improprer prior.<br />
<span class="math display">\[
\begin{aligned}
p(N,\theta) &amp;\propto (1)e^{-\beta*N}N^{\alpha-1}\\
&amp;\propto N^{-1}, \text{for  } \alpha,\beta =0\\
\end{aligned}
\]</span>
We can solve for <span class="math inline">\(p(N,\theta)\)</span> using the prior <span class="math inline">\(p(\lambda,\theta)\propto \lambda^{-1}\)</span>. and <span class="math inline">\(N\sim Pois(\lambda)\)</span>.
<span class="math display">\[
\begin{aligned}
p(N,\lambda,\theta) &amp;= p(N|\lambda,\theta)p(\lambda,\theta) \to p(N,\theta) = \int p(N,\lambda,\theta)d\lambda \\
&amp;= \int \frac{(\lambda/N)^Ne^{-\lambda/\theta}}{N!}(\frac{1}{\lambda}) d\lambda\\
&amp;= \frac{1}{N! \theta^N} \int \lambda^{N-1}e^{-\lambda/\theta}d\lambda\\
&amp;= \frac{1}{N! \theta^N}\frac{\Gamma{(N)}}{1/\theta^N} = 1/N\\
\end{aligned}
\]</span>
So we can let N follow vague prior from the Gamma(0,0) distribution, or call N a uniform on (0,N) and independent of <span class="math inline">\(\lambda\)</span> to derive p(N,<span class="math inline">\(\theta)\)</span>.</p>
<ul>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>we need to find the marginal posterior of N, first we find the joint posterior which follows a Beta distribution</li>
</ol></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
p(\theta,N | y) &amp;=  p(y | N,\theta)p(N,\theta) \\
&amp;\propto \theta^{\sum y_i} (1-\theta)^{nN-\sum y_i}(1/N)\\
&amp;\propto (1/N)Beta(\sum y_i+1, nN-\sum y_i +1)\\
\end{aligned}
\]</span>
Then we integrate with respect to <span class="math inline">\(\theta\)</span> to find the marginal posterior, where the integrand is the kernel for the Beta distribution, and we have the beta coefficient that remains in the marginal equation.</p>
<p><span class="math display">\[
\begin{aligned}
p(N| y) &amp;= \int (1/N) \prod {N \choose y_i} \theta^{S}(1-\theta)^{nN-S}d\theta, S=\sum y_i \\
&amp; = (1/N) \prod {N \choose y_i} \int \theta^{S}(1-\theta)^{nN-S}d\theta \\
&amp; = (1/N) \prod {N \choose y_i} Beta(S+1, nN-S+1)\\
\end{aligned}
\]</span>
The maximum probability is 122 trials with the highest marginal,</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="exercises-2.html#cb248-1" aria-hidden="true" tabindex="-1"></a> x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">53</span>,<span class="dv">57</span>,<span class="dv">66</span>,<span class="dv">67</span>,<span class="dv">72</span>)</span>
<span id="cb248-2"><a href="exercises-2.html#cb248-2" aria-hidden="true" tabindex="-1"></a> totalN<span class="ot">=</span><span class="fu">seq</span>(<span class="fu">max</span>(x),<span class="dv">1000</span>)</span>
<span id="cb248-3"><a href="exercises-2.html#cb248-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb248-4"><a href="exercises-2.html#cb248-4" aria-hidden="true" tabindex="-1"></a> marginal.post<span class="ot">&lt;-</span><span class="cf">function</span>(N,x){</span>
<span id="cb248-5"><a href="exercises-2.html#cb248-5" aria-hidden="true" tabindex="-1"></a>   n<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb248-6"><a href="exercises-2.html#cb248-6" aria-hidden="true" tabindex="-1"></a>   S<span class="ot">=</span><span class="fu">sum</span>(x)</span>
<span id="cb248-7"><a href="exercises-2.html#cb248-7" aria-hidden="true" tabindex="-1"></a>   <span class="co"># choose on the log scale</span></span>
<span id="cb248-8"><a href="exercises-2.html#cb248-8" aria-hidden="true" tabindex="-1"></a>   a<span class="ot">&lt;-</span><span class="fu">sum</span>( <span class="fu">lchoose</span>(N,x))</span>
<span id="cb248-9"><a href="exercises-2.html#cb248-9" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">=</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(N)</span>
<span id="cb248-10"><a href="exercises-2.html#cb248-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># b=0</span></span>
<span id="cb248-11"><a href="exercises-2.html#cb248-11" aria-hidden="true" tabindex="-1"></a>   c <span class="ot">=</span> <span class="fu">lbeta</span>( S<span class="sc">+</span><span class="dv">1</span>, n<span class="sc">*</span>N<span class="sc">-</span> S <span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb248-12"><a href="exercises-2.html#cb248-12" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb248-13"><a href="exercises-2.html#cb248-13" aria-hidden="true" tabindex="-1"></a>   <span class="co">#rez&lt;-(a*b)/c</span></span>
<span id="cb248-14"><a href="exercises-2.html#cb248-14" aria-hidden="true" tabindex="-1"></a>   rez<span class="ot">&lt;-</span>a<span class="sc">+</span>b<span class="sc">+</span>c</span>
<span id="cb248-15"><a href="exercises-2.html#cb248-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">exp</span>(rez))</span>
<span id="cb248-16"><a href="exercises-2.html#cb248-16" aria-hidden="true" tabindex="-1"></a> } <span class="do">## problems here</span></span>
<span id="cb248-17"><a href="exercises-2.html#cb248-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb248-18"><a href="exercises-2.html#cb248-18" aria-hidden="true" tabindex="-1"></a> <span class="do">## can we condition we can derive the analytic form of the joint posterior.</span></span>
<span id="cb248-19"><a href="exercises-2.html#cb248-19" aria-hidden="true" tabindex="-1"></a> <span class="do">## </span></span>
<span id="cb248-20"><a href="exercises-2.html#cb248-20" aria-hidden="true" tabindex="-1"></a>  marg.n<span class="ot">&lt;-</span><span class="fu">sapply</span>(totalN,<span class="cf">function</span>(y) <span class="fu">marginal.post</span>(y,x))</span>
<span id="cb248-21"><a href="exercises-2.html#cb248-21" aria-hidden="true" tabindex="-1"></a> <span class="do">## we use a grid approach to theta</span></span>
<span id="cb248-22"><a href="exercises-2.html#cb248-22" aria-hidden="true" tabindex="-1"></a>totalN[<span class="fu">which.max</span>(<span class="fu">exp</span>(marg.n))]</span></code></pre></div>
<pre><code>## [1] 122</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="exercises-2.html#cb250-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb250-2"><a href="exercises-2.html#cb250-2" aria-hidden="true" tabindex="-1"></a>norm.n<span class="ot">&lt;-</span>marg.n<span class="sc">/</span><span class="fu">sum</span>(marg.n)</span>
<span id="cb250-3"><a href="exercises-2.html#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(totalN,norm.n)</span>
<span id="cb250-4"><a href="exercises-2.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>totalN[<span class="fu">which.max</span>(<span class="fu">exp</span>(marg.n))])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-1.png" width="672" />
The joint posterior distribution given the data and N=122 (which was maximal marginal) has the maximum theta = 0.52.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="exercises-2.html#cb251-1" aria-hidden="true" tabindex="-1"></a> theta<span class="ot">=</span><span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.99</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb251-2"><a href="exercises-2.html#cb251-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-3"><a href="exercises-2.html#cb251-3" aria-hidden="true" tabindex="-1"></a> posterior.joint<span class="ot">&lt;-</span><span class="fu">dbeta</span>(theta, <span class="fu">sum</span>(x)<span class="sc">+</span><span class="dv">1</span>, <span class="dv">5</span><span class="sc">*</span><span class="dv">122</span><span class="sc">-</span><span class="fu">sum</span>(x)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">122</span></span>
<span id="cb251-4"><a href="exercises-2.html#cb251-4" aria-hidden="true" tabindex="-1"></a> norm.post<span class="ot">&lt;-</span>posterior.joint<span class="sc">/</span><span class="fu">sum</span>(posterior.joint)</span>
<span id="cb251-5"><a href="exercises-2.html#cb251-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(theta,norm.post, <span class="at">main=</span><span class="st">&#39;joint posterior N=122&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="exercises-2.html#cb252-1" aria-hidden="true" tabindex="-1"></a>  theta[<span class="fu">which.max</span>(norm.post)]</span></code></pre></div>
<pre><code>## [1] 0.52</code></pre>
<ul>
<li>(b ii) and for P<span class="math inline">\((N&gt;100) \approx 0.95\)</span>. We had to use the normalized marginal posterior distribution to correctly compute the probability.</li>
</ul>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="exercises-2.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(norm.n[totalN<span class="sc">&lt;=</span><span class="dv">100</span>])</span></code></pre></div>
<pre><code>## [1] 0.9518952</code></pre>
<ul>
<li><ol start="4" style="list-style-type: lower-alpha">
<li>the poisson distribution using <span class="math inline">\(\mu\)</span> for N only gives the probability for N as a fixed realization, however we want to study the uncertainity over all possible N values.</li>
</ol></li>
</ul>
</div>
<div id="question-7-1" class="section level2 unnumbered hasAnchor">
<h2>Question 7<a href="exercises-2.html#question-7-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>for 2 independent poisson distributions for x and y with <span class="math inline">\(\lambda_1,\lambda_2\)</span>. And the outcome <span class="math inline">\(X\)</span> has a binomial distribution with N=x+y and unknown p. show that the two models have the same likelihood.</p>
<p>We need to solve for the conditional probability of X given X+Y using the Poisson likelihoods. Here if you input the Poisson likelihoods, and use X+Y <span class="math inline">\(\sim Poi(\lambda_1+\lambda_2)\)</span> this returns to a Binomial(n, <span class="math inline">\(\lambda_1/(\lambda_1+\lambda_2))\)</span>.
<span class="math display">\[
\begin{aligned}
p(X =k| X+Y=n) &amp;= \frac{P(X+Y=n | X=k)P(X=k)}{P(X+Y=n)} \\
&amp;=  \frac{P(Y=n-k)P(X=k)}{P(X+Y=n)} \\
\end{aligned}
\]</span></p>
</div>
<div id="question-8" class="section level2 unnumbered hasAnchor">
<h2>question 8<a href="exercises-2.html#question-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>notes: dirichlet distribution?
- (a) For a given block there are only two outcomes, bicycles, and other vehicles. So a binomial distribution is appropriate (2 outcomes only). We model y and binomial <span class="math inline">\((N_y,\theta_y)\)</span> independent of z<span class="math inline">\(\sim Binomial(N_z,\theta_z)\)</span>.</p>
<p>We assume <span class="math inline">\(\theta_y,\theta_z\)</span> are independent, so the posteriors are independent Beta models.
<span class="math display">\[
\begin{aligned}
p(\theta_y,\theta_z| y,z) &amp;= p(\theta_y | y)p(\theta_z|z) \\
&amp;= Beta(\theta_y  | 1/2 +\sum y_i, 1/2+N_y-\sum y_i)*Beta(\theta_z  | 1/2 +\sum z_i, 1/2+N_z-\sum z_i)\\
\end{aligned}
\]</span>
- (b) the prior uses Jeffreys’ Beta(1/2,1/2) for each parameter independently.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="exercises-2.html#cb256-1" aria-hidden="true" tabindex="-1"></a>rez.lane.bike<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">18</span>,<span class="dv">17</span>,<span class="dv">35</span>,<span class="dv">55</span>)</span>
<span id="cb256-2"><a href="exercises-2.html#cb256-2" aria-hidden="true" tabindex="-1"></a>rez.lane.other<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">58</span>,<span class="dv">90</span>,<span class="dv">48</span>,<span class="dv">57</span>,<span class="dv">103</span>,<span class="dv">57</span>,<span class="dv">86</span>,<span class="dv">112</span>,<span class="dv">273</span>,<span class="dv">64</span>)</span>
<span id="cb256-3"><a href="exercises-2.html#cb256-3" aria-hidden="true" tabindex="-1"></a>NY<span class="ot">&lt;-</span>(rez.lane.bike<span class="sc">+</span>rez.lane.other)</span>
<span id="cb256-4"><a href="exercises-2.html#cb256-4" aria-hidden="true" tabindex="-1"></a>rez.lane.p<span class="ot">&lt;-</span>rez.lane.bike<span class="sc">/</span>(rez.lane.bike<span class="sc">+</span>rez.lane.other)</span>
<span id="cb256-5"><a href="exercises-2.html#cb256-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-6"><a href="exercises-2.html#cb256-6" aria-hidden="true" tabindex="-1"></a>rez.nolane.bike<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">8</span>)</span>
<span id="cb256-7"><a href="exercises-2.html#cb256-7" aria-hidden="true" tabindex="-1"></a>rez.nolane.other<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">113</span>,<span class="dv">18</span>,<span class="dv">14</span>,<span class="dv">44</span>,<span class="dv">208</span>,<span class="dv">67</span>,<span class="dv">29</span>,<span class="dv">154</span>)</span>
<span id="cb256-8"><a href="exercises-2.html#cb256-8" aria-hidden="true" tabindex="-1"></a>NZ<span class="ot">&lt;-</span>(rez.nolane.bike<span class="sc">+</span>rez.nolane.other)</span>
<span id="cb256-9"><a href="exercises-2.html#cb256-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-10"><a href="exercises-2.html#cb256-10" aria-hidden="true" tabindex="-1"></a>rez.nolane.p<span class="ot">&lt;-</span>rez.nolane.bike<span class="sc">/</span>(rez.nolane.bike<span class="sc">+</span>rez.nolane.other)</span></code></pre></div>
<ul>
<li><ol start="3" style="list-style-type: lower-alpha">
<li>we determine the posterior distribution using the beta distribution by sampline independently. Using a grid a pproach we see the contour map centered around 0.18 and 0.09 which is equivalent to the MLEs.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="exercises-2.html#cb257-1" aria-hidden="true" tabindex="-1"></a>bike.post<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1000</span>, (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sum</span>(rez.lane.bike)), (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="fu">sum</span>(rez.lane.other)))</span>
<span id="cb257-2"><a href="exercises-2.html#cb257-2" aria-hidden="true" tabindex="-1"></a>bike.post2<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1000</span>, (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sum</span>(rez.nolane.bike)), (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="fu">sum</span>(rez.nolane.other)))</span>
<span id="cb257-3"><a href="exercises-2.html#cb257-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-4"><a href="exercises-2.html#cb257-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-5"><a href="exercises-2.html#cb257-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-6"><a href="exercises-2.html#cb257-6" aria-hidden="true" tabindex="-1"></a>p0<span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.99</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb257-7"><a href="exercises-2.html#cb257-7" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.99</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb257-8"><a href="exercises-2.html#cb257-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-9"><a href="exercises-2.html#cb257-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-10"><a href="exercises-2.html#cb257-10" aria-hidden="true" tabindex="-1"></a>post.bike<span class="ot">&lt;-</span><span class="cf">function</span>(p0,p1,y,z,ny,nz){</span>
<span id="cb257-11"><a href="exercises-2.html#cb257-11" aria-hidden="true" tabindex="-1"></a>  pos<span class="ot">&lt;-</span> p0<span class="sc">^</span>(<span class="fu">sum</span>(y))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p0)<span class="sc">^</span>(<span class="fu">sum</span>(ny)<span class="sc">-</span><span class="fu">sum</span>(y))<span class="sc">*</span>p1<span class="sc">^</span>(<span class="fu">sum</span>(z))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">^</span>(<span class="fu">sum</span>(nz)<span class="sc">-</span><span class="fu">sum</span>(z))<span class="sc">*</span><span class="fu">dbeta</span>(p0,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">dbeta</span>(p1,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb257-12"><a href="exercises-2.html#cb257-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pos)</span>
<span id="cb257-13"><a href="exercises-2.html#cb257-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb257-14"><a href="exercises-2.html#cb257-14" aria-hidden="true" tabindex="-1"></a> posts<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb257-15"><a href="exercises-2.html#cb257-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb257-16"><a href="exercises-2.html#cb257-16" aria-hidden="true" tabindex="-1"></a>p0p1<span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(p0, p1)</span>
<span id="cb257-17"><a href="exercises-2.html#cb257-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-18"><a href="exercises-2.html#cb257-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p0p1)){</span>
<span id="cb257-19"><a href="exercises-2.html#cb257-19" aria-hidden="true" tabindex="-1"></a>  posts[i]<span class="ot">&lt;-</span><span class="fu">post.bike</span>(p0p1[i,<span class="st">&quot;Var1&quot;</span>],p0p1[i,<span class="st">&quot;Var2&quot;</span>], rez.lane.bike,rez.nolane.bike, NY,NZ) </span>
<span id="cb257-20"><a href="exercises-2.html#cb257-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb257-21"><a href="exercises-2.html#cb257-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(ggplot2)</span>
<span id="cb257-22"><a href="exercises-2.html#cb257-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(p0p1)<span class="sc">+</span></span>
<span id="cb257-23"><a href="exercises-2.html#cb257-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">z =</span> posts), <span class="at">bins =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<ul>
<li><ol start="4" style="list-style-type: lower-alpha">
<li>expected difference and the posterior distribution
we find the difference in the posterior distribution which is approximately 0.11 higher proportions in bike routes.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="exercises-2.html#cb258-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(bike.post<span class="sc">-</span>bike.post2)</span>
<span id="cb258-2"><a href="exercises-2.html#cb258-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(bike.post)<span class="sc">-</span><span class="fu">mean</span>(bike.post2))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="exercises-2.html#cb259-1" aria-hidden="true" tabindex="-1"></a> meany <span class="ot">=</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sum</span>(rez.lane.bike))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sum</span>(rez.lane.bike)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="fu">sum</span>(rez.lane.other))) <span class="do">## theoretical mean</span></span>
<span id="cb259-2"><a href="exercises-2.html#cb259-2" aria-hidden="true" tabindex="-1"></a>  meanz <span class="ot">=</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sum</span>(rez.nolane.bike))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sum</span>(rez.nolane.bike)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="fu">sum</span>(rez.nolane.other))) <span class="do">## theoretical mean</span></span></code></pre></div>
</div>
<div id="question-9" class="section level2 unnumbered hasAnchor">
<h2>question 9<a href="exercises-2.html#question-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We need to derive the posterior of <span class="math inline">\(p(\mu^2, \sigma^2 | y)\)</span>. <span class="math inline">\(p(\mu,\sigma^2 | y) = p(y|\mu,\sigma^2)*p(\mu , \sigma^2)\)</span></p>
<p><span class="math display">\[
\begin{aligned}
p(\mu, \sigma^2 |y)&amp;=\sigma^{-1}(\sigma^2)^{-(\nu_0/2 +1)}exp(-1/2\sigma^2 (\nu_0\sigma_0^2 + k_0(\mu-\mu_0)^2)) \times (\sigma^2)^{-n/2}exp(-1/2\sigma^2 ((n-1)s^2 + n(\mu-\bar{y})^2))\\
&amp;= \sigma^{-1}(\sigma^2)^{-((\nu_0+n)/2 +1)} exp(-1/2\sigma^2( \nu_0\sigma_0^2 +(n-1)s^2 +\mu^2(k_0+n) +\mu(-2\mu_0k_0 -2\bar{y}n) + \mu_0^2k_0 +n\bar{y}^2)\\
\end{aligned}
\]</span>
Where we factor the inside using <span class="math inline">\(\mu_n = k_0\mu_0/(k_0+n) +n\bar{y}/(k_0+n)\)</span>
<span class="math display">\[
\begin{aligned}
&amp;\to \mu^2(k_0+n) +\mu(-2\mu_0k_0 -2\bar{y}n) + \mu_0^2k_0 +n\bar{y}^2 \\
&amp;= (k_0+n)(\mu^2 - 2\mu( \mu_0k_0/(k_0+n) +\bar{y}n/(k_0+n)) + \mu_0^2k_0/(k_0+n) + n\bar{y}^2/(k_0+n)) \\
&amp;= (k_0+n)(\mu^2 - 2\mu( k_0\mu_0/(k_0+n) +n\bar{y}/(k_0+n)) + \frac{\mu_0^2k_0(k_0+n)}{(k_0+n)^2} + \frac{n\bar{y}^2(k_0+n)}{(k_0+n)^2} +\frac{2k_0\mu_0n\bar{y}}{(k_0+n)^2} -\frac{2k_0\mu_0n\bar{y}}{(k_0+n)^2})\\
&amp;= (k_0+n)(\mu^2 - 2\mu( k_0\mu_0/(k_0+n) +n\bar{y}/(k_0+n)) + \frac{\mu_0^2k_0^2}{(k_0+n)^2} +\frac{\mu_0^2k_0*n}{(k_0+n)^2}+ \frac{n^2\bar{y}^2}{(k_0+n)^2} + \frac{n\bar{y}^2k_0}{(k_0+n)^2}+\frac{2k_0\mu_0n\bar{y}}{(k_0+n)^2} -\frac{2k_0\mu_0n\bar{y}}{(k_0+n)^2}) \\
&amp;= (k_0+n)(\mu^2 + -2\mu\mu_n +\mu_n^2  +\frac{\mu_0^2k_0*n}{(k_0+n)^2}+ \frac{n\bar{y}^2k_0}{(k_0+n)^2} -\frac{2k_0\mu_0n\bar{y}}{(k_0+n)^2})\\
&amp;= (k_0+n)( (\mu-\mu_n)^2 + (k_0*n)/(k_0+n)^2( \mu_0^2+\bar{y}^2 -2\mu_0\bar{y}) \\
&amp;=  (k_0+n)( (\mu-\mu_n)^2 + (k_0*n)/(k_0+n)( \mu_0-\bar{y})^2\\
\end{aligned}
\]</span></p>
<p>putting the factorization into the posterior and derived the formula for each updated term.</p>
<p>here we see that <span class="math inline">\(\sigma^2_n ,\mu_n\)</span> are sufficient statistics for <span class="math inline">\(\mu,\sigma^2\)</span> by the factorization theorem because the posterior depends on parameters only through the summary statistics.</p>
<p><span class="math display">\[
\begin{aligned}
p(\mu, \sigma^2 |y)&amp;=\sigma^{-1}(\sigma^2)^{-((\nu_0+n)/2 +1)} exp(-1/2\sigma^2+ ( \nu_0\sigma_0^2 +(n-1)s^2 +(k_0+n)( (\mu-\mu_n)^2 + (k_0*n)/(k_0+n)( \mu_0-\bar{y})^2)\\
&amp;= \sigma^{-1}(\sigma^2)^{-((\nu_0+n)/2 +1)} exp(-1/2\sigma^2+ ( \nu_n\sigma_n^2 +(k_n)( (\mu-\mu_n)^2 )\\
&amp; = \sigma^{-1}(\sigma^2)^{-((\nu_n)/2 +1)} exp(-1/2\sigma^2 ( \nu_n\sigma_n^2 +(k_n)( (\mu-\mu_n)^2 )\\
\end{aligned}
\]</span>
# Question 10{-}
To show the F-distribution we prove it directly, using a change of variables. Although there is a theorem (definition) that for <span class="math inline">\(X\sim N(a,b)\)</span> and <span class="math inline">\(Y\sim N(c,d)\)</span> then F= <span class="math inline">\(S_X^2/\sigma^2_X / (S_Y^2 / \sigma_Y^2)\)</span> follows an F-distribution.</p>
<p>For <span class="math inline">\((n-1)S^2/\sigma^2 \sim X_{n-1}^2\)</span> we let <span class="math inline">\(U \sim \chi_p^2, V\sim \chi_q^2\)</span>. We let <span class="math inline">\(Z = (U/p)/(V/q)\)</span> and <span class="math inline">\(W=V/q\)</span>.</p>
<p><span class="math display">\[
J=
\begin{bmatrix}
\partial u/\partial z &amp; \partial u/\partial w \\
\partial v/\partial z &amp; \partial v/\partial w  
\end{bmatrix} =
\begin{bmatrix}
q &amp; 0 \\
  zp&amp; pw  \\
\end{bmatrix} = qpw
\]</span></p>
<p>For V = wq, and U = zpw. Note that after combining terms we have the Gamma kernel with <span class="math inline">\(\alpha = p+q/2 -1\)</span> and <span class="math inline">\(\beta= 1/2(pz+q)\)</span> which is the F-distribution.<br />
<span class="math display">\[
\begin{aligned}
f(z,w)&amp;= f(u)f(v)|J| \\
&amp;= \frac{1}{\Gamma(p/2)2^{p/2}}(pzw)^{p/2-1}e^{-pzw/2}/frac{1}{\Gamma(q/2)2^{q/2}}(wq)^{q/2-1}e^{-wq/2}|pwq| \\
&amp;=\frac{z^{p/2-1}}{\Gamma(p/2)2^{p+q/2}\Gamma(q/2)}(p)^{p/2}q^{q/2}w^{(p+q/2 -1)} e^{-w/2(pz+q/2)} \\
&amp; = \frac{z^{p/2-1}}{\Gamma(p/2)2^{p+q/2}\Gamma(q/2)}(p)^{p/2}q^{q/2}[\frac{\Gamma(p+q/2)}{(1/2(pz+q))^{p+q/2}}]\\
&amp;= \frac{z^{p/2-1}}{\Gamma(p/2)\Gamma(q/2)}(p)^{p/2}q^{q/2}[\frac{\Gamma(p+q/2)}{(q^{p+q/2(pz/q+1))^{p+q/2}}}]\\
&amp;=\frac{z^{p/2-1}\Gamma(p+q/2)}{\Gamma(p/2)\Gamma(q/2)}(p/q)^{p/2}\frac{1}{(pz/q+1)^{p+q/2}} \\
\end{aligned}
\]</span></p>
<p>We showed that for U, V as Chi-square variables, their ratio is the F-distribution, In order to show that the posterior distribution F= <span class="math inline">\(S_X^2/\sigma^2_X / (S_Y^2 / \sigma_Y^2)\)</span> is F. The posterior <span class="math inline">\(Y \sim \sigma^2 | y \sim Inv-\chi^2(\nu, \sigma^2)\)</span>. where Y =<span class="math inline">\(\frac{(n-1)S^2}{\chi_{n-1}^2}\)</span>. So The inverse chi-square distribution can be re-arranged to follow a Chi-square. Then the variable Z in terms of Chi-square variables can be expressed using Inv-Chisquare variables.</p>
</div>
<div id="question-11-1" class="section level2 unnumbered hasAnchor">
<h2>Question 11<a href="exercises-2.html#question-11-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>the model is defined as <span class="math inline">\(p(\alpha,\beta,y,n,x) \propto p(\alpha,\beta)\prod_{i=1}^{4}p(y_i | \alpha,\beta,n_i,x_i)\)</span>, where <span class="math inline">\((\alpha,\beta)\)</span> follows a joint normal prior with <span class="math inline">\(\alpha \sim N(0, 2^2)\)</span> and <span class="math inline">\(\beta \sim N(10,10^2)\)</span> and corr(<span class="math inline">\(\alpha,\beta) = 0.5\)</span>.</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>we repeat the computations of this data</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>and overlay the contour with the posterior distribution</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="exercises-2.html#cb260-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(mvtnorm)</span>
<span id="cb260-2"><a href="exercises-2.html#cb260-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(magrittr)</span>
<span id="cb260-3"><a href="exercises-2.html#cb260-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(dplyr)</span>
<span id="cb260-4"><a href="exercises-2.html#cb260-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(ggplot2)</span>
<span id="cb260-5"><a href="exercises-2.html#cb260-5" aria-hidden="true" tabindex="-1"></a> assay<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.86</span>,<span class="sc">-</span><span class="fl">0.30</span>,<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">0.73</span>), <span class="at">n=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb260-6"><a href="exercises-2.html#cb260-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-7"><a href="exercises-2.html#cb260-7" aria-hidden="true" tabindex="-1"></a> <span class="do">## the point a,b by MLE is (0.8,7.7) so we grid around these solution.</span></span>
<span id="cb260-8"><a href="exercises-2.html#cb260-8" aria-hidden="true" tabindex="-1"></a> a0<span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">10</span>,<span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb260-9"><a href="exercises-2.html#cb260-9" aria-hidden="true" tabindex="-1"></a> b1<span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">40</span>,<span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb260-10"><a href="exercises-2.html#cb260-10" aria-hidden="true" tabindex="-1"></a>  a0b1<span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(a0, b1)</span>
<span id="cb260-11"><a href="exercises-2.html#cb260-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-12"><a href="exercises-2.html#cb260-12" aria-hidden="true" tabindex="-1"></a>logit<span class="ot">&lt;-</span><span class="cf">function</span>(theta){</span>
<span id="cb260-13"><a href="exercises-2.html#cb260-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">log</span>(theta<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>theta)))</span>
<span id="cb260-14"><a href="exercises-2.html#cb260-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb260-15"><a href="exercises-2.html#cb260-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-16"><a href="exercises-2.html#cb260-16" aria-hidden="true" tabindex="-1"></a>inv.logit<span class="ot">&lt;-</span><span class="cf">function</span>(theta){</span>
<span id="cb260-17"><a href="exercises-2.html#cb260-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( (<span class="fu">exp</span>(theta)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(theta)))  )</span>
<span id="cb260-18"><a href="exercises-2.html#cb260-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb260-19"><a href="exercises-2.html#cb260-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-20"><a href="exercises-2.html#cb260-20" aria-hidden="true" tabindex="-1"></a><span class="do">## alpha, beta come from multivariate normal.</span></span>
<span id="cb260-21"><a href="exercises-2.html#cb260-21" aria-hidden="true" tabindex="-1"></a> <span class="do">## \prod_(i=1)^5 p(y|theta) ~ \theta^y (1-theta)^n-y ## kth dose. </span></span>
<span id="cb260-22"><a href="exercises-2.html#cb260-22" aria-hidden="true" tabindex="-1"></a>  <span class="do">### logit(theta) = alpha+ beta*x</span></span>
<span id="cb260-23"><a href="exercises-2.html#cb260-23" aria-hidden="true" tabindex="-1"></a>logit.likelihood<span class="ot">&lt;-</span><span class="cf">function</span>(alpha,beta,x,y,n){</span>
<span id="cb260-24"><a href="exercises-2.html#cb260-24" aria-hidden="true" tabindex="-1"></a>   theta_approx<span class="ot">&lt;-</span> alpha<span class="sc">+</span>beta<span class="sc">*</span>x</span>
<span id="cb260-25"><a href="exercises-2.html#cb260-25" aria-hidden="true" tabindex="-1"></a>   bin.like<span class="ot">&lt;-</span>(<span class="fu">inv.logit</span>(theta_approx))<span class="sc">^</span>y<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">inv.logit</span>(theta_approx))<span class="sc">^</span>(n<span class="sc">-</span>y)</span>
<span id="cb260-26"><a href="exercises-2.html#cb260-26" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(bin.like)</span>
<span id="cb260-27"><a href="exercises-2.html#cb260-27" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb260-28"><a href="exercises-2.html#cb260-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-29"><a href="exercises-2.html#cb260-29" aria-hidden="true" tabindex="-1"></a> <span class="do">## the alpha,beta stem from the grid, and we return the probability mass from the prior.</span></span>
<span id="cb260-30"><a href="exercises-2.html#cb260-30" aria-hidden="true" tabindex="-1"></a> joint.prior<span class="ot">&lt;-</span><span class="cf">function</span>(alpha,beta){</span>
<span id="cb260-31"><a href="exercises-2.html#cb260-31" aria-hidden="true" tabindex="-1"></a>  cormat<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="fl">0.5</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span><span class="dv">10</span>,<span class="fl">0.5</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span><span class="dv">10</span>,<span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb260-32"><a href="exercises-2.html#cb260-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">dmvnorm</span>(<span class="fu">c</span>(alpha,beta), <span class="at">mean=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="at">sigma=</span>cormat))</span>
<span id="cb260-33"><a href="exercises-2.html#cb260-33" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb260-34"><a href="exercises-2.html#cb260-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb260-35"><a href="exercises-2.html#cb260-35" aria-hidden="true" tabindex="-1"></a> posterior_density<span class="ot">&lt;-</span><span class="cf">function</span>(alpha,beta,assay){</span>
<span id="cb260-36"><a href="exercises-2.html#cb260-36" aria-hidden="true" tabindex="-1"></a>   joint_density<span class="ot">&lt;-</span><span class="fu">joint.prior</span>(alpha,beta)</span>
<span id="cb260-37"><a href="exercises-2.html#cb260-37" aria-hidden="true" tabindex="-1"></a>   probs<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb260-38"><a href="exercises-2.html#cb260-38" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(assay)){</span>
<span id="cb260-39"><a href="exercises-2.html#cb260-39" aria-hidden="true" tabindex="-1"></a>     p<span class="ot">&lt;-</span><span class="fu">logit.likelihood</span>(alpha,beta,assay<span class="sc">$</span>x[k],assay<span class="sc">$</span>y[k],assay<span class="sc">$</span>n[k])</span>
<span id="cb260-40"><a href="exercises-2.html#cb260-40" aria-hidden="true" tabindex="-1"></a>     probs<span class="ot">&lt;-</span><span class="fu">c</span>(probs,p)</span>
<span id="cb260-41"><a href="exercises-2.html#cb260-41" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb260-42"><a href="exercises-2.html#cb260-42" aria-hidden="true" tabindex="-1"></a>   totalLikelihood<span class="ot">&lt;-</span><span class="fu">prod</span>(probs)</span>
<span id="cb260-43"><a href="exercises-2.html#cb260-43" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>( joint_density<span class="sc">*</span>totalLikelihood)</span>
<span id="cb260-44"><a href="exercises-2.html#cb260-44" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb260-45"><a href="exercises-2.html#cb260-45" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb260-46"><a href="exercises-2.html#cb260-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-47"><a href="exercises-2.html#cb260-47" aria-hidden="true" tabindex="-1"></a> posts<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb260-48"><a href="exercises-2.html#cb260-48" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb260-49"><a href="exercises-2.html#cb260-49" aria-hidden="true" tabindex="-1"></a> <span class="do">## unnormalized posterior over grid which covers (a,b)</span></span>
<span id="cb260-50"><a href="exercises-2.html#cb260-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(a0b1)){</span>
<span id="cb260-51"><a href="exercises-2.html#cb260-51" aria-hidden="true" tabindex="-1"></a>  posts[i]<span class="ot">&lt;-</span><span class="fu">posterior_density</span>(a0b1[i,<span class="st">&quot;Var1&quot;</span>],a0b1[i,<span class="st">&quot;Var2&quot;</span>],assay) </span>
<span id="cb260-52"><a href="exercises-2.html#cb260-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb260-53"><a href="exercises-2.html#cb260-53" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb260-54"><a href="exercises-2.html#cb260-54" aria-hidden="true" tabindex="-1"></a> posts_norm<span class="ot">&lt;-</span>posts<span class="sc">/</span><span class="fu">sum</span>(posts)</span>
<span id="cb260-55"><a href="exercises-2.html#cb260-55" aria-hidden="true" tabindex="-1"></a> a0b1<span class="sc">$</span>joint.prob<span class="ot">&lt;-</span>posts_norm</span>
<span id="cb260-56"><a href="exercises-2.html#cb260-56" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb260-57"><a href="exercises-2.html#cb260-57" aria-hidden="true" tabindex="-1"></a> <span class="do">## grid sampling procedure</span></span>
<span id="cb260-58"><a href="exercises-2.html#cb260-58" aria-hidden="true" tabindex="-1"></a>  marginal.post_a<span class="ot">&lt;-</span> a0b1<span class="sc">%&gt;%</span><span class="fu">group_by</span>(Var1)<span class="sc">%&gt;%</span><span class="fu">summarise</span>(<span class="at">p=</span><span class="fu">sum</span>(joint.prob))<span class="sc">%&gt;%</span>data.frame</span>
<span id="cb260-59"><a href="exercises-2.html#cb260-59" aria-hidden="true" tabindex="-1"></a>    A<span class="ot">&lt;-</span>B<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb260-60"><a href="exercises-2.html#cb260-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb260-61"><a href="exercises-2.html#cb260-61" aria-hidden="true" tabindex="-1"></a>    a_s<span class="ot">&lt;-</span><span class="fu">sample</span>(marginal.post_a<span class="sc">$</span>Var1,<span class="dv">1</span>,<span class="at">prob=</span>marginal.post_a<span class="sc">$</span>p)</span>
<span id="cb260-62"><a href="exercises-2.html#cb260-62" aria-hidden="true" tabindex="-1"></a>    p.a_s<span class="ot">&lt;-</span>marginal.post_a[<span class="fu">which</span>(marginal.post_a<span class="sc">$</span>Var1<span class="sc">==</span>a_s),<span class="st">&#39;p&#39;</span>]</span>
<span id="cb260-63"><a href="exercises-2.html#cb260-63" aria-hidden="true" tabindex="-1"></a>    marginal.post_b<span class="ot">&lt;-</span>a0b1[<span class="fu">which</span>(a0b1<span class="sc">$</span>Var1<span class="sc">==</span>a_s),]</span>
<span id="cb260-64"><a href="exercises-2.html#cb260-64" aria-hidden="true" tabindex="-1"></a>    marginal.post_b<span class="sc">$</span>cond.prob<span class="ot">&lt;-</span>marginal.post_b<span class="sc">$</span>joint.prob<span class="sc">/</span>p.a_s</span>
<span id="cb260-65"><a href="exercises-2.html#cb260-65" aria-hidden="true" tabindex="-1"></a>    b_s<span class="ot">&lt;-</span><span class="fu">sample</span>(marginal.post_b<span class="sc">$</span>Var2,<span class="dv">1</span>,<span class="at">prob=</span>marginal.post_b<span class="sc">$</span>cond.prob)</span>
<span id="cb260-66"><a href="exercises-2.html#cb260-66" aria-hidden="true" tabindex="-1"></a>    A<span class="ot">&lt;-</span><span class="fu">c</span>(A,a_s)</span>
<span id="cb260-67"><a href="exercises-2.html#cb260-67" aria-hidden="true" tabindex="-1"></a>    B<span class="ot">&lt;-</span><span class="fu">c</span>(B,b_s)</span>
<span id="cb260-68"><a href="exercises-2.html#cb260-68" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb260-69"><a href="exercises-2.html#cb260-69" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb260-70"><a href="exercises-2.html#cb260-70" aria-hidden="true" tabindex="-1"></a>    <span class="do">### need to add a random jitter around each point.</span></span>
<span id="cb260-71"><a href="exercises-2.html#cb260-71" aria-hidden="true" tabindex="-1"></a>    A<span class="ot">&lt;-</span>A<span class="sc">+</span><span class="fu">runif</span>(<span class="fu">length</span>(A),<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="fl">0.1</span>)</span>
<span id="cb260-72"><a href="exercises-2.html#cb260-72" aria-hidden="true" tabindex="-1"></a>    B<span class="ot">&lt;-</span>B<span class="sc">+</span><span class="fu">runif</span>(<span class="fu">length</span>(B),<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="fl">0.1</span>)</span>
<span id="cb260-73"><a href="exercises-2.html#cb260-73" aria-hidden="true" tabindex="-1"></a>   ab.post<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">A=</span>A,<span class="at">B=</span>B)</span>
<span id="cb260-74"><a href="exercises-2.html#cb260-74" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(a0b1)<span class="sc">+</span></span>
<span id="cb260-75"><a href="exercises-2.html#cb260-75" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">z =</span> posts), <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb260-76"><a href="exercises-2.html#cb260-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> ab.post, <span class="fu">aes</span>(<span class="at">x =</span> A, <span class="at">y =</span> B), <span class="at">pch =</span> <span class="dv">21</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/q11-1.png" width="672" /></p>
<ul>
<li>(bii) the LD50 is summarized ensuring the B&gt;0 for a positive dose-response.</li>
</ul>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="exercises-2.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="sc">-</span>A<span class="sc">/</span>B, <span class="at">main=</span><span class="st">&#39;LD50&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="exercises-2.html#cb262-1" aria-hidden="true" tabindex="-1"></a> <span class="do">##  probability of dose-response being responsive to the dose.  negative means dose-response has negative response and is harmful.</span></span>
<span id="cb262-2"><a href="exercises-2.html#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(B<span class="sc">&gt;</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
## TRUE 
## 1000</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="asymptotics-and-connections-to-non-bayesian-approaches.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-introduction-to-multiparameter-models.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
