<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Fundamentals of Bayesian Inference | Bayesian Data Analysis</title>
  <meta name="description" content="Chapter 1 Fundamentals of Bayesian Inference | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Fundamentals of Bayesian Inference | Bayesian Data Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 1 Fundamentals of Bayesian Inference | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Fundamentals of Bayesian Inference | Bayesian Data Analysis" />
  
  <meta name="twitter:description" content="Chapter 1 Fundamentals of Bayesian Inference | Bayesian Data Analysis review by Andrew Gelman, supervised by Dr. Paul Marjoram" />
  

<meta name="author" content="Anthony R. Colombo, Dr. Paul Marjoram" />


<meta name="date" content="2022-08-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="cross.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#independent-study"><i class="fa fa-check"></i>Independent study</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#supervised-learning"><i class="fa fa-check"></i>Supervised learning</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html"><i class="fa fa-check"></i><b>1</b> Fundamentals of Bayesian Inference</a>
<ul>
<li class="chapter" data-level="1.1" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#general-notation-for-statistical-inference"><i class="fa fa-check"></i><b>1.1</b> General notation for statistical inference</a>
<ul>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#exchangeability"><i class="fa fa-check"></i>Exchangeability</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#explanatory-variables"><i class="fa fa-check"></i>Explanatory variables</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#hierarchical-modeling"><i class="fa fa-check"></i>Hierarchical modeling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#bayesian-inference"><i class="fa fa-check"></i><b>1.2</b> Bayesian inference</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#subjectivity-and-objectivity"><i class="fa fa-check"></i>Subjectivity and Objectivity</a></li>
<li class="chapter" data-level="1.3" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-bayesian-inference.html"><a href="fundamentals-of-bayesian-inference.html#simulation-100-times"><i class="fa fa-check"></i>Simulation 100 times</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>2</b> Single parameter models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cross.html"><a href="cross.html#estimating-a-probability-from-binomial-data"><i class="fa fa-check"></i><b>2.1</b> Estimating a probability from binomial data</a></li>
<li class="chapter" data-level="2.2" data-path="cross.html"><a href="cross.html#posterior-as-a-compromise-between-data-and-prior-information"><i class="fa fa-check"></i><b>2.2</b> Posterior as a compromise between data and prior information</a></li>
<li class="chapter" data-level="2.3" data-path="cross.html"><a href="cross.html#summarizing-the-posterior-inference"><i class="fa fa-check"></i><b>2.3</b> Summarizing the posterior inference</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#posterior-quantiles-and-intervals"><i class="fa fa-check"></i>Posterior quantiles and intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="cross.html"><a href="cross.html#informative-prior-distributions"><i class="fa fa-check"></i><b>2.4</b> Informative prior distributions</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#conjugate-prior-distributions"><i class="fa fa-check"></i>Conjugate prior distributions</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#conjugate-prior-distributions-exponential-families-and-sufficient-statistics"><i class="fa fa-check"></i>Conjugate prior, distributions, exponential families, and sufficient statistics</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="cross.html"><a href="cross.html#normal-distribution-with-known-variance"><i class="fa fa-check"></i><b>2.5</b> Normal distribution with known variance</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#likelihood-of-one-data-point"><i class="fa fa-check"></i>Likelihood of one data point</a></li>
<li class="chapter" data-level="2.5.1" data-path="cross.html"><a href="cross.html#conjugate-prior-and-posterior-distributions"><i class="fa fa-check"></i><b>2.5.1</b> Conjugate prior and posterior distributions</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#posterior-predictive-distribution"><i class="fa fa-check"></i>Posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-model-with-multiple-observations"><i class="fa fa-check"></i>Normal model with multiple observations</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="cross.html"><a href="cross.html#other-standard-single-parameter-models"><i class="fa fa-check"></i><b>2.6</b> Other standard single-parameter models</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-distribution-with-known-mean-but-unknown-variance"><i class="fa fa-check"></i>Normal distribution with known mean but unknown variance</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#poisson-model"><i class="fa fa-check"></i>Poisson model</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#negative-binomial-distribution"><i class="fa fa-check"></i>Negative Binomial distribution</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#exponential-distribution"><i class="fa fa-check"></i>Exponential distribution</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#constructing-a-prior-distribution"><i class="fa fa-check"></i>Constructing a prior distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="cross.html"><a href="cross.html#noninformative-prior-distributions"><i class="fa fa-check"></i><b>2.7</b> Noninformative prior distributions</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="cross.html"><a href="cross.html#jeffreys-invariance-principle"><i class="fa fa-check"></i><b>2.7.1</b> Jeffreys’ invariance principle</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#difficulties-with-noninformative-prior-distributions"><i class="fa fa-check"></i>Difficulties with noninformative prior distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="cross.html"><a href="cross.html#exercises-1"><i class="fa fa-check"></i><b>2.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-1"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#normal-approximation-example"><i class="fa fa-check"></i>Normal approximation example</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-3"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-4"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-7"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-8-normal-distribution-with-unknown-mean"><i class="fa fa-check"></i>Question 8 (Normal distribution with unknown mean)</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-10"><i class="fa fa-check"></i>Question 10</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-11"><i class="fa fa-check"></i>Question 11</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-12"><i class="fa fa-check"></i>Question 12</a></li>
<li class="chapter" data-level="" data-path="cross.html"><a href="cross.html#question-13"><i class="fa fa-check"></i>Question 13</a></li>
<li class="chapter" data-level="2.8.1" data-path="cross.html"><a href="cross.html#question-21"><i class="fa fa-check"></i><b>2.8.1</b> Question 21</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-3.html"><a href="chapter-3.html"><i class="fa fa-check"></i><b>3</b> Chapter 3</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="3.1" data-path="exercises-2.html"><a href="exercises-2.html#question-1-1"><i class="fa fa-check"></i><b>3.1</b> Question 1</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-2"><i class="fa fa-check"></i>Question 2</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-3-1"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-4-independent-binomial"><i class="fa fa-check"></i>Question 4 (independent binomial)</a>
<ul>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-4-dirichlet"><i class="fa fa-check"></i>Question 4 (dirichlet)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-5"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-7-1"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-8"><i class="fa fa-check"></i>question 8</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-9"><i class="fa fa-check"></i>question 9</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#question-11-1"><i class="fa fa-check"></i>Question 11</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html"><i class="fa fa-check"></i><b>4</b> Asymptotics and connections to non-Bayesian approaches</a>
<ul>
<li class="chapter" data-level="4.1" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#normal-approximations-to-the-posterior-distribution"><i class="fa fa-check"></i><b>4.1</b> Normal approximations to the posterior distribution</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#summarizing-posterior-distributions-by-point-estimates-and-standard-errors"><i class="fa fa-check"></i>Summarizing posterior distributions by point estimates and standard errors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#large-sample-theory"><i class="fa fa-check"></i><b>4.2</b> Large-sample theory</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#asymptotic-normality-and-consistency"><i class="fa fa-check"></i>Asymptotic normality and consistency</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#frequency-evaluations-of-bayesian-inferences"><i class="fa fa-check"></i><b>4.3</b> Frequency evaluations of Bayesian inferences</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#large-sample-correspondence"><i class="fa fa-check"></i>Large sample correspondence</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#point-estimation-consistency-and-efficiency"><i class="fa fa-check"></i>Point estimation, consistency, and efficiency</a></li>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#confidence-coverage"><i class="fa fa-check"></i>Confidence coverage</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#exercises-3"><i class="fa fa-check"></i><b>4.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="asymptotics-and-connections-to-non-bayesian-approaches.html"><a href="asymptotics-and-connections-to-non-bayesian-approaches.html#question-1-2"><i class="fa fa-check"></i>Question 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>5</b> Blocks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="blocks.html"><a href="blocks.html#equations"><i class="fa fa-check"></i><b>5.1</b> Equations</a></li>
<li class="chapter" data-level="5.2" data-path="blocks.html"><a href="blocks.html#theorems-and-proofs"><i class="fa fa-check"></i><b>5.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="5.3" data-path="blocks.html"><a href="blocks.html#callout-blocks"><i class="fa fa-check"></i><b>5.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>6</b> Sharing your book</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>6.1</b> Publishing</a></li>
<li class="chapter" data-level="6.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>6.2</b> 404 pages</a></li>
<li class="chapter" data-level="6.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>6.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="7" data-path="parts.html"><a href="parts.html"><i class="fa fa-check"></i><b>7</b> Parts</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fundamentals-of-bayesian-inference" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Fundamentals of Bayesian Inference<a href="fundamentals-of-bayesian-inference.html#fundamentals-of-bayesian-inference" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The first few chapters of Gelman’s text are introductory, and we attempt to highlight the key definitions and summarize each chapter. At the end of each chapter we attempt several problems. Probability and inference is defined using three steps</p>
<ol style="list-style-type: decimal">
<li>setting up the full probability model for a joint distribution for all observable and unobservable quantities.</li>
<li>Conditioning on observed data: computing the appropriate <em>posterior</em> distribution, the conditional probability distribution of the unobserved quantities of oltimate interest, given the observed data.</li>
<li>Evaluating the fit of the model.</li>
</ol>
<div id="general-notation-for-statistical-inference" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> General notation for statistical inference<a href="fundamentals-of-bayesian-inference.html#general-notation-for-statistical-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are two different kinds of estimands, the first are potentially observable quantities, such as future observations of a process, and the second are quantities that are not directly observable, namely the parameters that govern a process being investigated.</p>
<div id="exchangeability" class="section level3 unnumbered hasAnchor">
<h3>Exchangeability<a href="fundamentals-of-bayesian-inference.html#exchangeability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One key assumption is that the n values <span class="math inline">\(y_i\)</span> are regarded as <em>exchangeable</em>, meaning that the uncertainty can be expressed as a joint probability <span class="math inline">\(p(y_1,...,y_n)\)</span> that is invariant to permutations of indexes. Often times the exchangeable distribution is modeled as <em>iid</em>.</p>
</div>
<div id="explanatory-variables" class="section level3 unnumbered hasAnchor">
<h3>Explanatory variables<a href="fundamentals-of-bayesian-inference.html#explanatory-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is common to have observations on each unit which have non-random variables called <em>explanatory variables</em> or <em>covariates</em>. The explanatory variables are usually denoted by X. However treating X as random then exchangeability can be extended <span class="math inline">\((x,y)_i\)</span> which is invariant to permutations of the indexes. Further, it is always appropriate to assume exchangeability of y, conditioned on sufficient information of X, where the indexes can be thought of as randomly assigned. It follows that if two units have the same value of x, then the distributions of y are the same.</p>
</div>
<div id="hierarchical-modeling" class="section level3 unnumbered hasAnchor">
<h3>Hierarchical modeling<a href="fundamentals-of-bayesian-inference.html#hierarchical-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>for a model across patients across different cities, we can assume exchangability to patients within a city. Further conditioned on the explanatory variables at the individual, the conditional distribution given these explanatory variables would be exchangeable.</p>
</div>
</div>
<div id="bayesian-inference" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Bayesian inference<a href="fundamentals-of-bayesian-inference.html#bayesian-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The prior, p(<span class="math inline">\(\theta\)</span>), and the sampling distribution, or the <em>data distribution</em>, <span class="math inline">\(p(y|\theta)\)</span> is related to the joint distribution by</p>
<p><span class="math display">\[ p(\theta,y) = p(\theta)p(y | \theta)\]</span></p>
<p>Where using Bayes’ rule the posterior distribution
<span class="math display" id="eq:bayes">\[\begin{equation}
p(\theta | y ) = \frac{p(\theta)p(y| \theta)}{p(y)}
\tag{1.1}
\end{equation}\]</span></p>
<p>Where <span class="math inline">\(p(y) = \int p(\theta)p(y | \theta)d\theta\)</span>, or a sum in discrete case. An equivalent form of <a href="fundamentals-of-bayesian-inference.html#eq:bayes">(1.1)</a> is the <em>unnormalized posterior density</em> given as</p>
<p><span class="math display" id="eq:unnorm">\[\begin{equation}
p(\theta | y ) \propto p(\theta)p(y | \theta)
\tag{1.2}
\end{equation}\]</span></p>
<p>Note that <span class="math inline">\(p(y | \theta)\)</span> is taken as a function of <span class="math inline">\(\theta\)</span>, not of y.</p>
</div>
<div id="prediction" class="section level2 unnumbered hasAnchor">
<h2>Prediction<a href="fundamentals-of-bayesian-inference.html#prediction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Inferences about an unknown <em>observable</em> variable, are called predictive inferences. Before the data y are considered, the distribution of the unknown, observable, y is <span class="math display">\[ p(y) = \int p(y,\theta)d\theta = \int p(\theta)p(y | \theta)d\theta\]</span></p>
<p>this is defined as the marginal distribution of y, and also called <em>prior predictive distribution</em>. Prior refers that the data is not conditional on any previous observation, and predictive refers to the data being observable.</p>
<p>The <em>posterior predictive distribution</em> is conditional on the observed y, but is predictive because it is predicting observable values.</p>
<p><span class="math display" id="eq:postpred">\[\begin{equation}
\begin{split}
p(\hat{y} | y) &amp;= \int p(\hat{y}, \theta | y) d\theta \\
&amp;= \int p(\hat{y} |\theta, y) p(\theta|y) d\theta \\
&amp; = \int p(\hat{y}| \theta) p(\theta | y) d\theta \\
\end{split}
\tag{1.3}
\end{equation}\]</span></p>
</div>
<div id="likelihood" class="section level2 unnumbered hasAnchor">
<h2>Likelihood<a href="fundamentals-of-bayesian-inference.html#likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The data <em>y</em> affects the posterior inference only through <a href="fundamentals-of-bayesian-inference.html#eq:unnorm">(1.2)</a> likelihood function <span class="math inline">\(p(y| \theta)\)</span> which is regarded as a function of <span class="math inline">\(\theta\)</span> for fixed y. The <em>likelihood function</em> is defined as <span class="math inline">\(p(y | \theta)\)</span>, and the <em>likelihood principle</em> is for any given sample, and any two likelihood models <span class="math inline">\(p(y | \theta)\)</span>, two models with the same likelihood will have the same inference for <span class="math inline">\(\theta\)</span>.</p>
</div>
<div id="subjectivity-and-objectivity" class="section level2 unnumbered hasAnchor">
<h2>Subjectivity and Objectivity<a href="fundamentals-of-bayesian-inference.html#subjectivity-and-objectivity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The frequentist models, MLEs, have subjectivity in their assumptions because they rely on long sequence of identical trials, that are iid. The Bayesian model relies on the prior distribution. If any experiment is repeatable and can replicated, the the prior distribution can be estimated from the data themselves and the analysis is more ‘objective’. Replication increases objectivity of a given model. However the Bayesian approach allows for (1) the ability to combine information from multiple sources (allowing for greater objectivity) and (2) more encompassing by accounting for uncertainity about the unknowns in a statistical problem.</p>
<p>It is important to include as much background information as possible</p>
</div>
<div id="exercises" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Exercises<a href="fundamentals-of-bayesian-inference.html#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Suppose for <span class="math inline">\(\theta=1\)</span>, then y<span class="math inline">\(\sim N(1,\sigma)\)</span>, and if <span class="math inline">\(\theta=2, y\sim N(2,\sigma)\)</span>. Where P(<span class="math inline">\(\theta=1)=P(\theta=2)=0.5\)</span>.
<ol style="list-style-type: lower-alpha">
<li>For <span class="math inline">\(\sigma=2\)</span>; we must write the formula for the pdf of y. <span class="math inline">\(p(y) = \sum_\theta p(y|\theta)p(\theta) = (1/2)N(1,\sigma^2)+ (1/2)N(2,\sigma^2)\)</span> as the marginal density.</li>
</ol></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="fundamentals-of-bayesian-inference.html#cb1-1" aria-hidden="true" tabindex="-1"></a> fy<span class="ot">&lt;-</span><span class="cf">function</span>(y) {<span class="fu">return</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">dnorm</span>(y,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">dnorm</span>(y,<span class="dv">2</span>,<span class="at">sd=</span><span class="dv">2</span>))}    </span></code></pre></div>
<pre><code>(b) $P(\theta=1 | y=1) = \frac{p(\theta=1)p(y|\theta=1)}{p(y)}= \frac{(1/2)N(1,4)}{(1/2)N(1,\sigma^2)+ (1/2)N(2,\sigma^2)}$ = 0.53 </code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="fundamentals-of-bayesian-inference.html#cb3-1" aria-hidden="true" tabindex="-1"></a>dy<span class="ot">&lt;-</span><span class="cf">function</span>(y){ <span class="fu">return</span>( (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">dnorm</span>(y,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">fy</span>(y))}</span>
<span id="cb3-2"><a href="fundamentals-of-bayesian-inference.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dy</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.5312094</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>twelve games with point spread of 8 points.
<ol style="list-style-type: lower-alpha">
<li>Using relative frequency, P(favorite wins <span class="math inline">\(|\)</span> point spread =8) = 0.67.<br />
P(favorite wins by at least 8 <span class="math inline">\(|\)</span> point spread =8) = 0.42.<br />
and P(fav. wins by at least 8 <span class="math inline">\(|\)</span> spread =8, favorite team wins) = 0.62.</li>
</ol></li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="fundamentals-of-bayesian-inference.html#cb5-1" aria-hidden="true" tabindex="-1"></a>spread<span class="ot">&lt;-</span><span class="dv">8</span></span>
<span id="cb5-2"><a href="fundamentals-of-bayesian-inference.html#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="fundamentals-of-bayesian-inference.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">## outcome of the games favor score - underdog score</span></span>
<span id="cb5-4"><a href="fundamentals-of-bayesian-inference.html#cb5-4" aria-hidden="true" tabindex="-1"></a> games<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">7</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">20</span>,<span class="dv">21</span>)</span>
<span id="cb5-5"><a href="fundamentals-of-bayesian-inference.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">## frequentist approach</span></span>
<span id="cb5-6"><a href="fundamentals-of-bayesian-inference.html#cb5-6" aria-hidden="true" tabindex="-1"></a> fav.wins<span class="ot">&lt;-</span>  <span class="fu">mean</span>(games<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb5-7"><a href="fundamentals-of-bayesian-inference.html#cb5-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&quot;(frequentist): fav wins: &quot;</span>, <span class="fu">round</span>(fav.wins,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## (frequentist): fav wins: 0.67</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="fundamentals-of-bayesian-inference.html#cb7-1" aria-hidden="true" tabindex="-1"></a> fav.by<span class="fl">.8</span><span class="ot">&lt;-</span> <span class="fu">mean</span>((games<span class="sc">&gt;</span><span class="dv">8</span>))</span>
<span id="cb7-2"><a href="fundamentals-of-bayesian-inference.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&quot;(frequentist): fav wins by 8: &quot;</span>, <span class="fu">round</span>(fav.by<span class="fl">.8</span>,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## (frequentist): fav wins by 8: 0.42</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="fundamentals-of-bayesian-inference.html#cb9-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## P( fav. wins &gt;8 | fav. wins) = P(fav. wins &gt; 8, fav. wins )/ P(fav. wins)</span></span>
<span id="cb9-2"><a href="fundamentals-of-bayesian-inference.html#cb9-2" aria-hidden="true" tabindex="-1"></a> cond<span class="ot">&lt;-</span><span class="fu">sum</span>(games<span class="sc">&gt;</span><span class="dv">8</span> <span class="sc">&amp;</span> games<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">/</span><span class="fu">sum</span>(games<span class="sc">&gt;</span><span class="dv">0</span>)   </span>
<span id="cb9-3"><a href="fundamentals-of-bayesian-inference.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span>fav.by<span class="fl">.8</span><span class="sc">/</span>fav.wins</span>
<span id="cb9-4"><a href="fundamentals-of-bayesian-inference.html#cb9-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&quot;(frequentist): fav wins by 8 given fav. wins: &quot;</span>, <span class="fu">round</span>(cond,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## (frequentist): fav wins by 8 given fav. wins: 0.62</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>now we assume a normal distribution with <span class="math inline">\(d|x \sim N(-1.25, 10.10)\)</span>. So <span class="math inline">\(P(d &gt; -x)= P(Z\sigma+\mu &gt; -x)=P(Z &gt; -x-\mu / \sigma)\)</span></li>
<li>Probablity fav team wins is 0.75</li>
</ol>
<ol start="2" style="list-style-type: lower-roman">
<li>fav team wins by 8 (beats the spread) is 0.45, we expect this to be 0.5 (the middle of the normal distribution because we centered on the spread)</li>
<li>P(wins by 8 <span class="math inline">\(|\)</span> favorite team wins) = P(favorite team wins <span class="math inline">\(|\)</span> wins by 8)P(wins by 8)/P(favorite team wins) = P(wins by 8)/P(fav. team wins) since the conditional prob. =1 given the favorite team wins. The prob. that they win by at least 8 is 0.6.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="fundamentals-of-bayesian-inference.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## part b</span></span>
<span id="cb11-2"><a href="fundamentals-of-bayesian-inference.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span>games<span class="dv">-8</span></span>
<span id="cb11-3"><a href="fundamentals-of-bayesian-inference.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  sample.mean <span class="ot">&lt;-</span><span class="fu">mean</span>(d)</span>
<span id="cb11-4"><a href="fundamentals-of-bayesian-inference.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  sample.sd<span class="ot">&lt;-</span><span class="fu">sd</span>(d)</span>
<span id="cb11-5"><a href="fundamentals-of-bayesian-inference.html#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## assume  d|x ~ N(0,10.10)</span></span>
<span id="cb11-6"><a href="fundamentals-of-bayesian-inference.html#cb11-6" aria-hidden="true" tabindex="-1"></a>  fav.wins.norm<span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">8</span>,<span class="at">mean=</span>sample.mean,<span class="at">sd=</span>sample.sd)</span>
<span id="cb11-7"><a href="fundamentals-of-bayesian-inference.html#cb11-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&quot;(normal): fav wins: &quot;</span>, <span class="fu">round</span>(fav.wins.norm,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## (normal): fav wins: 0.75</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="fundamentals-of-bayesian-inference.html#cb13-1" aria-hidden="true" tabindex="-1"></a>  fav.by.<span class="fl">8.</span>norm<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">0</span>,<span class="at">mean=</span>sample.mean,<span class="at">sd=</span>sample.sd)</span>
<span id="cb13-2"><a href="fundamentals-of-bayesian-inference.html#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&quot;(normal): fav wins by 8: &quot;</span>, <span class="fu">round</span>(fav.by.<span class="fl">8.</span>norm,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## (normal): fav wins by 8: 0.45</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="fundamentals-of-bayesian-inference.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Pr(Wins by 8 | Fav. wins) = P(Fav. wins | wins by 8)P(wins by 8) / P(fav. wins)</span></span>
<span id="cb15-2"><a href="fundamentals-of-bayesian-inference.html#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="do">## P(Fav. wins | wins by 8) = 1</span></span>
<span id="cb15-3"><a href="fundamentals-of-bayesian-inference.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  cond.norm<span class="ot">&lt;-</span>fav.by.<span class="fl">8.</span>norm<span class="sc">/</span>fav.wins.norm</span>
<span id="cb15-4"><a href="fundamentals-of-bayesian-inference.html#cb15-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&quot;(normal): fav wins by 8 given fav. wins: &quot;</span>, <span class="fu">round</span>(cond.norm,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## (normal): fav wins by 8 given fav. wins: 0.6</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>We need to estimate the probability that there is at least one congressional election that is tied in the next U.S. election. There are 435 senate elections.
<ol style="list-style-type: lower-alpha">
<li>The parameters of interest are <span class="math inline">\(\theta_i\)</span> the true probability that the election is tied. We can let the <em>prior</em> <span class="math inline">\(\theta \sim Beta(\alpha,\beta)\)</span>. The <em>likelihood</em> is <span class="math inline">\(y|\theta_i \sim Binomial(435,\theta_i) = \theta^{\sum y_i}(1-\theta)^{435-\sum y_i}\)</span> follows a Binomial distribution (ignoring the binomial coefficient) where we assume each election is independent. Hence the posterior for theta <span class="math inline">\(f(\theta | y) \sim Beta(\sum y_i +\alpha, n-\sum y_i +\beta)\)</span>. where <span class="math inline">\(\alpha,\beta\)</span> are set to 1 for the uniform prior. For this case we set <span class="math inline">\(\alpha, \beta\)</span> equal to 1, 10 which has a prior mean of 0.09.</li>
</ol></li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="fundamentals-of-bayesian-inference.html#cb17-1" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">01</span>)</span>
<span id="cb17-2"><a href="fundamentals-of-bayesian-inference.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta,<span class="fu">dbeta</span>(theta,<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>In the period of 1900-1992, there were 20,597 elections, out of which 6 were decided by less than 10 votes, and 49 were decided by less than 100 votes.<br />
we can estimate the probability of a tie to be less than 6/20,597 and bounded by 49/20,597. So for the Binomial trials the sum of the successes is 6, and n=20,597, so the posterior could be <span class="math inline">\(\theta | y \sim Beta(1+6, 10+20,597 -6)\)</span> is the posterior for <span class="math inline">\(\theta\)</span>. This assumes that 10 votes is within the neighborhood of an election tie.<br />
The question asks to compute at least one election tie, from a total of 435 elections. This follows a Binomial(435, <span class="math inline">\(\hat{\theta})\)</span>. Where we use the posterior mean to estimate <span class="math inline">\(\theta\)</span>. The posterior mean using the Beta(7,20601) yields a mean of <span class="math inline">\(\hat{\theta}=\frac{7}{20608} = 3.4e-04\)</span> as the posterior mean.</li>
</ol>
<p>Then the probability that at least 1 election is tied, from 435 total elections will follow a Binomial(435, <span class="math inline">\(\hat{\theta})\)</span>, where we can use the posterior distribution for <span class="math inline">\(\theta | y\)</span> in the Binomial likelihood <span class="math inline">\(P(X\geq 1 | \hat{\theta})= 1-P(X\leq0 | \hat{\theta})\)</span> which has a probability of 0.14 of at least 1 election tie.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="fundamentals-of-bayesian-inference.html#cb18-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># the posterior for theta is Beta(1+6,10+20597-6)</span></span>
<span id="cb18-2"><a href="fundamentals-of-bayesian-inference.html#cb18-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(theta,<span class="fu">dbeta</span>(theta,<span class="dv">7</span>,<span class="dv">10</span><span class="sc">+</span><span class="dv">20597-6</span>),<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="fundamentals-of-bayesian-inference.html#cb19-1" aria-hidden="true" tabindex="-1"></a> <span class="do">## posterior mean is 7/(20601)</span></span>
<span id="cb19-2"><a href="fundamentals-of-bayesian-inference.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">## then P(X&gt;=1) = 1-P(X&lt;=0 | p)</span></span>
<span id="cb19-3"><a href="fundamentals-of-bayesian-inference.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">0</span>,<span class="dv">435</span>,<span class="at">prob=</span><span class="dv">7</span><span class="sc">/</span><span class="dv">20608</span>)</span></code></pre></div>
<pre><code>## [1] 0.1373819</code></pre>
<ol start="9" style="list-style-type: decimal">
<li><p>A clinic has three doctors. Patients come into the clinic at random, starting at 9 a.m. according to a Poisson process, with a time parameter, t, of 10 minutes; that is after opening the first patient appears follows an exponential distribution with average waiting time of 10 minutes. Then the next patient arrives with a waiting time of an expected 10 minutes as iid exponential distribution. After a patient arrives, the patient waits until a doctor is available, and the doctor visits a patitient uniformly between 5-20 minutes. The clinic stops admitting patients at 4 pm, and closes after the last patient is completed with the visit.</p>
<ol style="list-style-type: lower-alpha">
<li>Simulate this process once. how many patients visited the office? how many had to wait for a doctor? what was the average wait? when did office close?</li>
</ol></li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="fundamentals-of-bayesian-inference.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">### waiting time for a new patient to arrive in the clinic</span></span>
<span id="cb21-2"><a href="fundamentals-of-bayesian-inference.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="do">###########################################################</span></span>
<span id="cb21-3"><a href="fundamentals-of-bayesian-inference.html#cb21-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># patientList is the data frame of all patients</span></span>
<span id="cb21-4"><a href="fundamentals-of-bayesian-inference.html#cb21-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># closeTime is the time to stop admitting (420 minutes)</span></span>
<span id="cb21-5"><a href="fundamentals-of-bayesian-inference.html#cb21-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># currentPatient Number </span></span>
<span id="cb21-6"><a href="fundamentals-of-bayesian-inference.html#cb21-6" aria-hidden="true" tabindex="-1"></a> <span class="co"># current time is the running total of time</span></span>
<span id="cb21-7"><a href="fundamentals-of-bayesian-inference.html#cb21-7" aria-hidden="true" tabindex="-1"></a>  newPatientArrival<span class="ot">&lt;-</span><span class="cf">function</span>(patientList,</span>
<span id="cb21-8"><a href="fundamentals-of-bayesian-inference.html#cb21-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">closeTime=</span>timeToClose,</span>
<span id="cb21-9"><a href="fundamentals-of-bayesian-inference.html#cb21-9" aria-hidden="true" tabindex="-1"></a>                              waitTime,</span>
<span id="cb21-10"><a href="fundamentals-of-bayesian-inference.html#cb21-10" aria-hidden="true" tabindex="-1"></a>                             visitTime,</span>
<span id="cb21-11"><a href="fundamentals-of-bayesian-inference.html#cb21-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">currentPatientNumber=</span><span class="dv">0</span>,</span>
<span id="cb21-12"><a href="fundamentals-of-bayesian-inference.html#cb21-12" aria-hidden="true" tabindex="-1"></a>                             currentTime,</span>
<span id="cb21-13"><a href="fundamentals-of-bayesian-inference.html#cb21-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">assignedDoctor=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb21-14"><a href="fundamentals-of-bayesian-inference.html#cb21-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">completionTime=</span><span class="dv">0</span>){</span>
<span id="cb21-15"><a href="fundamentals-of-bayesian-inference.html#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># waiting time for next patient</span></span>
<span id="cb21-16"><a href="fundamentals-of-bayesian-inference.html#cb21-16" aria-hidden="true" tabindex="-1"></a>     patientTime<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">rexp</span>(<span class="dv">1</span>,<span class="at">rate=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>),<span class="dv">2</span>)</span>
<span id="cb21-17"><a href="fundamentals-of-bayesian-inference.html#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># current time of existing patients</span></span>
<span id="cb21-18"><a href="fundamentals-of-bayesian-inference.html#cb21-18" aria-hidden="true" tabindex="-1"></a>     current<span class="ot">&lt;-</span><span class="fu">max</span>(patientList<span class="sc">$</span>currentTime)</span>
<span id="cb21-19"><a href="fundamentals-of-bayesian-inference.html#cb21-19" aria-hidden="true" tabindex="-1"></a>   <span class="do">## the clinic stops admitting patients at 4pm</span></span>
<span id="cb21-20"><a href="fundamentals-of-bayesian-inference.html#cb21-20" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>( (current<span class="sc">+</span>patientTime)<span class="sc">&lt;=</span>closeTime){</span>
<span id="cb21-21"><a href="fundamentals-of-bayesian-inference.html#cb21-21" aria-hidden="true" tabindex="-1"></a>     <span class="do">## in minutes</span></span>
<span id="cb21-22"><a href="fundamentals-of-bayesian-inference.html#cb21-22" aria-hidden="true" tabindex="-1"></a>   newPatient<span class="ot">&lt;-</span><span class="fu">createPatientChart</span>(currentPatientNumber,patientTime,waitTime,visitTime,currentTime,assignedDoctor,<span class="dv">0</span>)</span>
<span id="cb21-23"><a href="fundamentals-of-bayesian-inference.html#cb21-23" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb21-24"><a href="fundamentals-of-bayesian-inference.html#cb21-24" aria-hidden="true" tabindex="-1"></a>    newPatient<span class="ot">&lt;-</span><span class="fu">createPatientChart</span>(currentPatientNumber,patientTime,waitTime,visitTime,currentTime,<span class="st">&quot;closed_notAdmitted&quot;</span>,<span class="dv">0</span>)</span>
<span id="cb21-25"><a href="fundamentals-of-bayesian-inference.html#cb21-25" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb21-26"><a href="fundamentals-of-bayesian-inference.html#cb21-26" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(newPatient)</span>
<span id="cb21-27"><a href="fundamentals-of-bayesian-inference.html#cb21-27" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb21-28"><a href="fundamentals-of-bayesian-inference.html#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="do">#################### </span></span>
<span id="cb21-29"><a href="fundamentals-of-bayesian-inference.html#cb21-29" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-30"><a href="fundamentals-of-bayesian-inference.html#cb21-30" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-31"><a href="fundamentals-of-bayesian-inference.html#cb21-31" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-32"><a href="fundamentals-of-bayesian-inference.html#cb21-32" aria-hidden="true" tabindex="-1"></a> computeWaitTime<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">doctors=</span><span class="cn">NULL</span>,</span>
<span id="cb21-33"><a href="fundamentals-of-bayesian-inference.html#cb21-33" aria-hidden="true" tabindex="-1"></a>                           <span class="at">patientList=</span><span class="cn">NULL</span>,</span>
<span id="cb21-34"><a href="fundamentals-of-bayesian-inference.html#cb21-34" aria-hidden="true" tabindex="-1"></a>                           <span class="at">patientID=</span><span class="dv">1</span>){</span>
<span id="cb21-35"><a href="fundamentals-of-bayesian-inference.html#cb21-35" aria-hidden="true" tabindex="-1"></a>   <span class="do">## need to compute visiting time (booked)</span></span>
<span id="cb21-36"><a href="fundamentals-of-bayesian-inference.html#cb21-36" aria-hidden="true" tabindex="-1"></a>   <span class="do">## next time available</span></span>
<span id="cb21-37"><a href="fundamentals-of-bayesian-inference.html#cb21-37" aria-hidden="true" tabindex="-1"></a>   <span class="do">## required input current time for a specific doctor/patient ?</span></span>
<span id="cb21-38"><a href="fundamentals-of-bayesian-inference.html#cb21-38" aria-hidden="true" tabindex="-1"></a>   <span class="co"># patient time (minutes)</span></span>
<span id="cb21-39"><a href="fundamentals-of-bayesian-inference.html#cb21-39" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb21-40"><a href="fundamentals-of-bayesian-inference.html#cb21-40" aria-hidden="true" tabindex="-1"></a>   <span class="do">## FIX ME: it is grabbing 2 patient IDs?</span></span>
<span id="cb21-41"><a href="fundamentals-of-bayesian-inference.html#cb21-41" aria-hidden="true" tabindex="-1"></a>   currentTime<span class="ot">&lt;-</span>patientList<span class="sc">$</span>currentTime[<span class="fu">which</span>(patientList<span class="sc">$</span>patient<span class="sc">==</span>patientID)]</span>
<span id="cb21-42"><a href="fundamentals-of-bayesian-inference.html#cb21-42" aria-hidden="true" tabindex="-1"></a>   visitTime<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="at">min=</span><span class="dv">5</span>,<span class="at">max=</span><span class="dv">20</span>) <span class="do">## minutes</span></span>
<span id="cb21-43"><a href="fundamentals-of-bayesian-inference.html#cb21-43" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-44"><a href="fundamentals-of-bayesian-inference.html#cb21-44" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb21-45"><a href="fundamentals-of-bayesian-inference.html#cb21-45" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(<span class="fu">any</span>(doctors<span class="sc">$</span>nextTimeAvail<span class="sc">&lt;</span>currentTime)){</span>
<span id="cb21-46"><a href="fundamentals-of-bayesian-inference.html#cb21-46" aria-hidden="true" tabindex="-1"></a>     waitTime<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb21-47"><a href="fundamentals-of-bayesian-inference.html#cb21-47" aria-hidden="true" tabindex="-1"></a>     assignedDr<span class="ot">&lt;-</span><span class="fu">sample</span>(doctors<span class="sc">$</span>dr[<span class="fu">which</span>(doctors<span class="sc">$</span>nextTimeAvail<span class="sc">&lt;</span>currentTime)],<span class="dv">1</span>)</span>
<span id="cb21-48"><a href="fundamentals-of-bayesian-inference.html#cb21-48" aria-hidden="true" tabindex="-1"></a>     <span class="do">### current time + visitTime</span></span>
<span id="cb21-49"><a href="fundamentals-of-bayesian-inference.html#cb21-49" aria-hidden="true" tabindex="-1"></a>     nextAvailTime<span class="ot">&lt;-</span> visitTime<span class="sc">+</span>currentTime<span class="sc">+</span>waitTime</span>
<span id="cb21-50"><a href="fundamentals-of-bayesian-inference.html#cb21-50" aria-hidden="true" tabindex="-1"></a>     <span class="do">## completion time for patient exit (closing time).</span></span>
<span id="cb21-51"><a href="fundamentals-of-bayesian-inference.html#cb21-51" aria-hidden="true" tabindex="-1"></a>   }<span class="cf">else</span> <span class="cf">if</span>(<span class="fu">any</span>(doctors<span class="sc">$</span>nextTimeAvail<span class="sc">&lt;</span>currentTime)<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb21-52"><a href="fundamentals-of-bayesian-inference.html#cb21-52" aria-hidden="true" tabindex="-1"></a>     <span class="co"># all doctors are booked, no available doctors.</span></span>
<span id="cb21-53"><a href="fundamentals-of-bayesian-inference.html#cb21-53" aria-hidden="true" tabindex="-1"></a>     <span class="co"># wait time is the difference between next available time (assuming all times are greater than patient time)</span></span>
<span id="cb21-54"><a href="fundamentals-of-bayesian-inference.html#cb21-54" aria-hidden="true" tabindex="-1"></a>     waitTime<span class="ot">&lt;-</span><span class="fu">min</span>(doctors<span class="sc">$</span>nextTimeAvail<span class="sc">-</span>currentTime)</span>
<span id="cb21-55"><a href="fundamentals-of-bayesian-inference.html#cb21-55" aria-hidden="true" tabindex="-1"></a>     assignedDr<span class="ot">&lt;-</span>doctors<span class="sc">$</span>dr[<span class="fu">which</span>( (doctors<span class="sc">$</span>nextTimeAvail<span class="sc">-</span>currentTime)<span class="sc">==</span><span class="fu">min</span>(doctors<span class="sc">$</span>nextTimeAvail<span class="sc">-</span>currentTime))]</span>
<span id="cb21-56"><a href="fundamentals-of-bayesian-inference.html#cb21-56" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span>(<span class="fu">length</span>(assignedDr)<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb21-57"><a href="fundamentals-of-bayesian-inference.html#cb21-57" aria-hidden="true" tabindex="-1"></a>         assignedDr<span class="ot">&lt;-</span>assignedDr[<span class="dv">1</span>]</span>
<span id="cb21-58"><a href="fundamentals-of-bayesian-inference.html#cb21-58" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb21-59"><a href="fundamentals-of-bayesian-inference.html#cb21-59" aria-hidden="true" tabindex="-1"></a>     nextAvailTime<span class="ot">&lt;-</span> visitTime<span class="sc">+</span>currentTime<span class="sc">+</span>waitTime  <span class="do">## completion time for patient to exit</span></span>
<span id="cb21-60"><a href="fundamentals-of-bayesian-inference.html#cb21-60" aria-hidden="true" tabindex="-1"></a>    }<span class="do">## if all doctors unavail</span></span>
<span id="cb21-61"><a href="fundamentals-of-bayesian-inference.html#cb21-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(assignedDr)</span></span>
<span id="cb21-62"><a href="fundamentals-of-bayesian-inference.html#cb21-62" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(currentTime)</span></span>
<span id="cb21-63"><a href="fundamentals-of-bayesian-inference.html#cb21-63" aria-hidden="true" tabindex="-1"></a>    <span class="do">##  update doctor list</span></span>
<span id="cb21-64"><a href="fundamentals-of-bayesian-inference.html#cb21-64" aria-hidden="true" tabindex="-1"></a>     doctors[<span class="fu">which</span>(doctors<span class="sc">$</span>dr<span class="sc">==</span>assignedDr),<span class="st">&#39;visitingPatient&#39;</span>]<span class="ot">&lt;-</span>patientID</span>
<span id="cb21-65"><a href="fundamentals-of-bayesian-inference.html#cb21-65" aria-hidden="true" tabindex="-1"></a>     doctors[<span class="fu">which</span>(doctors<span class="sc">$</span>dr<span class="sc">==</span>assignedDr),<span class="st">&#39;nextTimeAvail&#39;</span>]<span class="ot">&lt;-</span>nextAvailTime</span>
<span id="cb21-66"><a href="fundamentals-of-bayesian-inference.html#cb21-66" aria-hidden="true" tabindex="-1"></a>     doctors[<span class="fu">which</span>(doctors<span class="sc">$</span>dr<span class="sc">==</span>assignedDr),<span class="st">&#39;currentTime&#39;</span>]<span class="ot">&lt;-</span>currentTime <span class="do">## patient time</span></span>
<span id="cb21-67"><a href="fundamentals-of-bayesian-inference.html#cb21-67" aria-hidden="true" tabindex="-1"></a>     doctors[<span class="fu">which</span>(doctors<span class="sc">$</span>dr<span class="sc">==</span>assignedDr),<span class="st">&#39;visitTimeLength&#39;</span>]<span class="ot">&lt;-</span>visitTime</span>
<span id="cb21-68"><a href="fundamentals-of-bayesian-inference.html#cb21-68" aria-hidden="true" tabindex="-1"></a>     <span class="co"># flag avail to no.</span></span>
<span id="cb21-69"><a href="fundamentals-of-bayesian-inference.html#cb21-69" aria-hidden="true" tabindex="-1"></a>     doctors[<span class="fu">which</span>(doctors<span class="sc">$</span>dr<span class="sc">==</span>assignedDr),<span class="st">&#39;avail&#39;</span>]<span class="ot">&lt;-</span><span class="st">&#39;no&#39;</span></span>
<span id="cb21-70"><a href="fundamentals-of-bayesian-inference.html#cb21-70" aria-hidden="true" tabindex="-1"></a>     <span class="do">## update patient list</span></span>
<span id="cb21-71"><a href="fundamentals-of-bayesian-inference.html#cb21-71" aria-hidden="true" tabindex="-1"></a>     patientList[<span class="fu">which</span>(patientList<span class="sc">$</span>patient<span class="sc">==</span>patientID),<span class="st">&#39;doctorWaitTime&#39;</span>]<span class="ot">&lt;-</span>waitTime</span>
<span id="cb21-72"><a href="fundamentals-of-bayesian-inference.html#cb21-72" aria-hidden="true" tabindex="-1"></a>     patientList[<span class="fu">which</span>(patientList<span class="sc">$</span>patient<span class="sc">==</span>patientID),<span class="st">&#39;doctorVisitTime&#39;</span>]<span class="ot">&lt;-</span>visitTime</span>
<span id="cb21-73"><a href="fundamentals-of-bayesian-inference.html#cb21-73" aria-hidden="true" tabindex="-1"></a>     patientList[<span class="fu">which</span>(patientList<span class="sc">$</span>patient<span class="sc">==</span>patientID),<span class="st">&#39;assignedDoctor&#39;</span>]<span class="ot">&lt;-</span>assignedDr</span>
<span id="cb21-74"><a href="fundamentals-of-bayesian-inference.html#cb21-74" aria-hidden="true" tabindex="-1"></a>     patientList[<span class="fu">which</span>(patientList<span class="sc">$</span>patient<span class="sc">==</span>patientID),<span class="st">&#39;completionTime&#39;</span>]<span class="ot">&lt;-</span>nextAvailTime</span>
<span id="cb21-75"><a href="fundamentals-of-bayesian-inference.html#cb21-75" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">patient=</span>patientList,<span class="at">doctor=</span>doctors))</span>
<span id="cb21-76"><a href="fundamentals-of-bayesian-inference.html#cb21-76" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb21-77"><a href="fundamentals-of-bayesian-inference.html#cb21-77" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-78"><a href="fundamentals-of-bayesian-inference.html#cb21-78" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-79"><a href="fundamentals-of-bayesian-inference.html#cb21-79" aria-hidden="true" tabindex="-1"></a> <span class="do">## creates a patient object</span></span>
<span id="cb21-80"><a href="fundamentals-of-bayesian-inference.html#cb21-80" aria-hidden="true" tabindex="-1"></a> createPatientChart<span class="ot">&lt;-</span><span class="cf">function</span>(currentPatientNumber,arrivalTime,waitTime,visitTime,currentTime,assignedDoctor,completionTime){</span>
<span id="cb21-81"><a href="fundamentals-of-bayesian-inference.html#cb21-81" aria-hidden="true" tabindex="-1"></a>   patientID<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">patient=</span>currentPatientNumber<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb21-82"><a href="fundamentals-of-bayesian-inference.html#cb21-82" aria-hidden="true" tabindex="-1"></a>                         <span class="at">arrivalTime=</span>arrivalTime,</span>
<span id="cb21-83"><a href="fundamentals-of-bayesian-inference.html#cb21-83" aria-hidden="true" tabindex="-1"></a>                         <span class="at">doctorWaitTime=</span>waitTime,</span>
<span id="cb21-84"><a href="fundamentals-of-bayesian-inference.html#cb21-84" aria-hidden="true" tabindex="-1"></a>                         <span class="at">doctorVisitTime=</span>visitTime,</span>
<span id="cb21-85"><a href="fundamentals-of-bayesian-inference.html#cb21-85" aria-hidden="true" tabindex="-1"></a>                         <span class="at">currentTime=</span>currentTime,</span>
<span id="cb21-86"><a href="fundamentals-of-bayesian-inference.html#cb21-86" aria-hidden="true" tabindex="-1"></a>                         <span class="at">assignedDoctor=</span>assignedDoctor,</span>
<span id="cb21-87"><a href="fundamentals-of-bayesian-inference.html#cb21-87" aria-hidden="true" tabindex="-1"></a>                         <span class="at">completionTime=</span><span class="dv">0</span>)</span>
<span id="cb21-88"><a href="fundamentals-of-bayesian-inference.html#cb21-88" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(patientID)</span>
<span id="cb21-89"><a href="fundamentals-of-bayesian-inference.html#cb21-89" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb21-90"><a href="fundamentals-of-bayesian-inference.html#cb21-90" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-91"><a href="fundamentals-of-bayesian-inference.html#cb21-91" aria-hidden="true" tabindex="-1"></a> updatePatientList<span class="ot">&lt;-</span><span class="cf">function</span>(patientList,patientID){</span>
<span id="cb21-92"><a href="fundamentals-of-bayesian-inference.html#cb21-92" aria-hidden="true" tabindex="-1"></a>   patientList<span class="ot">&lt;-</span><span class="fu">rbind</span>(patientList,patientID)</span>
<span id="cb21-93"><a href="fundamentals-of-bayesian-inference.html#cb21-93" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(patientList)</span>
<span id="cb21-94"><a href="fundamentals-of-bayesian-inference.html#cb21-94" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb21-95"><a href="fundamentals-of-bayesian-inference.html#cb21-95" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-96"><a href="fundamentals-of-bayesian-inference.html#cb21-96" aria-hidden="true" tabindex="-1"></a>updateTime<span class="ot">&lt;-</span><span class="cf">function</span>(currentTime,<span class="at">newTime=</span><span class="cn">NULL</span>,p1){</span>
<span id="cb21-97"><a href="fundamentals-of-bayesian-inference.html#cb21-97" aria-hidden="true" tabindex="-1"></a>  p1<span class="sc">$</span>currentTime<span class="ot">&lt;-</span>currentTime<span class="sc">+</span>newTime</span>
<span id="cb21-98"><a href="fundamentals-of-bayesian-inference.html#cb21-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p1)</span>
<span id="cb21-99"><a href="fundamentals-of-bayesian-inference.html#cb21-99" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-100"><a href="fundamentals-of-bayesian-inference.html#cb21-100" aria-hidden="true" tabindex="-1"></a> totalPatients<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb21-101"><a href="fundamentals-of-bayesian-inference.html#cb21-101" aria-hidden="true" tabindex="-1"></a><span class="do">## this is the simulation</span></span>
<span id="cb21-102"><a href="fundamentals-of-bayesian-inference.html#cb21-102" aria-hidden="true" tabindex="-1"></a> <span class="do">## first task : loop through the time update for patients</span></span>
<span id="cb21-103"><a href="fundamentals-of-bayesian-inference.html#cb21-103" aria-hidden="true" tabindex="-1"></a> <span class="do">## second task : include the doctor assignment query.</span></span>
<span id="cb21-104"><a href="fundamentals-of-bayesian-inference.html#cb21-104" aria-hidden="true" tabindex="-1"></a>simulateProcess<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">doctors=</span><span class="cn">NULL</span>,</span>
<span id="cb21-105"><a href="fundamentals-of-bayesian-inference.html#cb21-105" aria-hidden="true" tabindex="-1"></a>                          <span class="at">totalWait=</span><span class="cn">NULL</span>,</span>
<span id="cb21-106"><a href="fundamentals-of-bayesian-inference.html#cb21-106" aria-hidden="true" tabindex="-1"></a>                          <span class="at">totalPatients=</span><span class="dv">0</span>,</span>
<span id="cb21-107"><a href="fundamentals-of-bayesian-inference.html#cb21-107" aria-hidden="true" tabindex="-1"></a>                          <span class="at">timeToClose=</span><span class="dv">420</span>,</span>
<span id="cb21-108"><a href="fundamentals-of-bayesian-inference.html#cb21-108" aria-hidden="true" tabindex="-1"></a>                          <span class="at">currentTime=</span><span class="cn">NULL</span>){</span>
<span id="cb21-109"><a href="fundamentals-of-bayesian-inference.html#cb21-109" aria-hidden="true" tabindex="-1"></a>  <span class="do">## initiate Patient List</span></span>
<span id="cb21-110"><a href="fundamentals-of-bayesian-inference.html#cb21-110" aria-hidden="true" tabindex="-1"></a> patientList<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">patient=</span><span class="dv">0</span>,</span>
<span id="cb21-111"><a href="fundamentals-of-bayesian-inference.html#cb21-111" aria-hidden="true" tabindex="-1"></a>                         <span class="at">arrivalTime=</span><span class="dv">0</span>,</span>
<span id="cb21-112"><a href="fundamentals-of-bayesian-inference.html#cb21-112" aria-hidden="true" tabindex="-1"></a>                         <span class="at">doctorWaitTime=</span><span class="dv">0</span>,</span>
<span id="cb21-113"><a href="fundamentals-of-bayesian-inference.html#cb21-113" aria-hidden="true" tabindex="-1"></a>                         <span class="at">doctorVisitTime=</span><span class="dv">0</span>,</span>
<span id="cb21-114"><a href="fundamentals-of-bayesian-inference.html#cb21-114" aria-hidden="true" tabindex="-1"></a>                         <span class="at">currentTime=</span><span class="dv">0</span>,</span>
<span id="cb21-115"><a href="fundamentals-of-bayesian-inference.html#cb21-115" aria-hidden="true" tabindex="-1"></a>                         <span class="at">assignedDoctor=</span><span class="st">&#39;none&#39;</span>,</span>
<span id="cb21-116"><a href="fundamentals-of-bayesian-inference.html#cb21-116" aria-hidden="true" tabindex="-1"></a>                         <span class="at">completionTime=</span><span class="dv">0</span>)</span>
<span id="cb21-117"><a href="fundamentals-of-bayesian-inference.html#cb21-117" aria-hidden="true" tabindex="-1"></a> <span class="do">## not sure what to put here.</span></span>
<span id="cb21-118"><a href="fundamentals-of-bayesian-inference.html#cb21-118" aria-hidden="true" tabindex="-1"></a> currentTime<span class="ot">&lt;-</span>patientList<span class="sc">$</span>currentTime[<span class="fu">which</span>(patientList<span class="sc">$</span>patient<span class="sc">==</span><span class="fu">max</span>(patientList<span class="sc">$</span>patient))] <span class="do">## current time is the max current time from patient chart.</span></span>
<span id="cb21-119"><a href="fundamentals-of-bayesian-inference.html#cb21-119" aria-hidden="true" tabindex="-1"></a> currentPatientNumber<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb21-120"><a href="fundamentals-of-bayesian-inference.html#cb21-120" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-121"><a href="fundamentals-of-bayesian-inference.html#cb21-121" aria-hidden="true" tabindex="-1"></a> <span class="do">## timeToClose (minutes) is stopping to admit patients</span></span>
<span id="cb21-122"><a href="fundamentals-of-bayesian-inference.html#cb21-122" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(currentTime<span class="sc">&lt;</span>timeToClose){</span>
<span id="cb21-123"><a href="fundamentals-of-bayesian-inference.html#cb21-123" aria-hidden="true" tabindex="-1"></a>    <span class="do">## patient enters after the (i-1) patient enters.</span></span>
<span id="cb21-124"><a href="fundamentals-of-bayesian-inference.html#cb21-124" aria-hidden="true" tabindex="-1"></a>    p1<span class="ot">&lt;-</span><span class="fu">newPatientArrival</span>(patientList,</span>
<span id="cb21-125"><a href="fundamentals-of-bayesian-inference.html#cb21-125" aria-hidden="true" tabindex="-1"></a>                             <span class="at">closeTime=</span>timeToClose,</span>
<span id="cb21-126"><a href="fundamentals-of-bayesian-inference.html#cb21-126" aria-hidden="true" tabindex="-1"></a>                          <span class="at">waitTime=</span><span class="dv">0</span>,</span>
<span id="cb21-127"><a href="fundamentals-of-bayesian-inference.html#cb21-127" aria-hidden="true" tabindex="-1"></a>                          <span class="at">visitTime=</span><span class="dv">0</span>,</span>
<span id="cb21-128"><a href="fundamentals-of-bayesian-inference.html#cb21-128" aria-hidden="true" tabindex="-1"></a>                             <span class="at">currentPatientNumber=</span>currentPatientNumber,</span>
<span id="cb21-129"><a href="fundamentals-of-bayesian-inference.html#cb21-129" aria-hidden="true" tabindex="-1"></a>                             currentTime)</span>
<span id="cb21-130"><a href="fundamentals-of-bayesian-inference.html#cb21-130" aria-hidden="true" tabindex="-1"></a>    <span class="do">## update time</span></span>
<span id="cb21-131"><a href="fundamentals-of-bayesian-inference.html#cb21-131" aria-hidden="true" tabindex="-1"></a>    p1<span class="ot">&lt;-</span><span class="fu">updateTime</span>(p1<span class="sc">$</span>currentTime,<span class="at">newTime=</span>p1<span class="sc">$</span>arrivalTime,p1)</span>
<span id="cb21-132"><a href="fundamentals-of-bayesian-inference.html#cb21-132" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-133"><a href="fundamentals-of-bayesian-inference.html#cb21-133" aria-hidden="true" tabindex="-1"></a>    <span class="co"># given a patient time, switch the availability of any doctor</span></span>
<span id="cb21-134"><a href="fundamentals-of-bayesian-inference.html#cb21-134" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if a doctors next available time is less than the current time, switch him to available</span></span>
<span id="cb21-135"><a href="fundamentals-of-bayesian-inference.html#cb21-135" aria-hidden="true" tabindex="-1"></a>    <span class="do">## FIX ME: need to ensure this flag is correct.</span></span>
<span id="cb21-136"><a href="fundamentals-of-bayesian-inference.html#cb21-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(doctors<span class="sc">$</span>nextTimeAvail<span class="sc">&lt;</span>p1<span class="sc">$</span>currentTime)){</span>
<span id="cb21-137"><a href="fundamentals-of-bayesian-inference.html#cb21-137" aria-hidden="true" tabindex="-1"></a>      doctors<span class="sc">$</span>avail[<span class="fu">which</span>(doctors<span class="sc">$</span>nextTimeAvail<span class="sc">&lt;</span>p1<span class="sc">$</span>currentTime)]<span class="ot">&lt;-</span><span class="st">&#39;yes&#39;</span></span>
<span id="cb21-138"><a href="fundamentals-of-bayesian-inference.html#cb21-138" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-139"><a href="fundamentals-of-bayesian-inference.html#cb21-139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-140"><a href="fundamentals-of-bayesian-inference.html#cb21-140" aria-hidden="true" tabindex="-1"></a>    <span class="do">## create a patient list</span></span>
<span id="cb21-141"><a href="fundamentals-of-bayesian-inference.html#cb21-141" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(currentPatientNumber<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb21-142"><a href="fundamentals-of-bayesian-inference.html#cb21-142" aria-hidden="true" tabindex="-1"></a>      patientList<span class="ot">&lt;-</span>p1</span>
<span id="cb21-143"><a href="fundamentals-of-bayesian-inference.html#cb21-143" aria-hidden="true" tabindex="-1"></a>     <span class="co"># update patient number  </span></span>
<span id="cb21-144"><a href="fundamentals-of-bayesian-inference.html#cb21-144" aria-hidden="true" tabindex="-1"></a>      currentPatientNumber<span class="ot">&lt;-</span>currentPatientNumber<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb21-145"><a href="fundamentals-of-bayesian-inference.html#cb21-145" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb21-146"><a href="fundamentals-of-bayesian-inference.html#cb21-146" aria-hidden="true" tabindex="-1"></a>      patientList<span class="ot">&lt;-</span><span class="fu">rbind</span>(patientList,p1)</span>
<span id="cb21-147"><a href="fundamentals-of-bayesian-inference.html#cb21-147" aria-hidden="true" tabindex="-1"></a>     <span class="co"># update patient number  </span></span>
<span id="cb21-148"><a href="fundamentals-of-bayesian-inference.html#cb21-148" aria-hidden="true" tabindex="-1"></a>      currentPatientNumber<span class="ot">&lt;-</span>currentPatientNumber<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb21-149"><a href="fundamentals-of-bayesian-inference.html#cb21-149" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-150"><a href="fundamentals-of-bayesian-inference.html#cb21-150" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-151"><a href="fundamentals-of-bayesian-inference.html#cb21-151" aria-hidden="true" tabindex="-1"></a>    <span class="do">## task 2 assign a doctor</span></span>
<span id="cb21-152"><a href="fundamentals-of-bayesian-inference.html#cb21-152" aria-hidden="true" tabindex="-1"></a>     <span class="do">### check for doctor availability</span></span>
<span id="cb21-153"><a href="fundamentals-of-bayesian-inference.html#cb21-153" aria-hidden="true" tabindex="-1"></a>     <span class="do">## compute wait time, and/or compute the next available time</span></span>
<span id="cb21-154"><a href="fundamentals-of-bayesian-inference.html#cb21-154" aria-hidden="true" tabindex="-1"></a>     <span class="do">## returns a list object.</span></span>
<span id="cb21-155"><a href="fundamentals-of-bayesian-inference.html#cb21-155" aria-hidden="true" tabindex="-1"></a>    clinicList<span class="ot">&lt;-</span><span class="fu">computeWaitTime</span>(doctors,patientList,<span class="at">patientID=</span>patientList<span class="sc">$</span>patient[currentPatientNumber])</span>
<span id="cb21-156"><a href="fundamentals-of-bayesian-inference.html#cb21-156" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-157"><a href="fundamentals-of-bayesian-inference.html#cb21-157" aria-hidden="true" tabindex="-1"></a>    doctors<span class="ot">&lt;-</span>clinicList[[<span class="st">&quot;doctor&quot;</span>]]</span>
<span id="cb21-158"><a href="fundamentals-of-bayesian-inference.html#cb21-158" aria-hidden="true" tabindex="-1"></a>   patientList<span class="ot">&lt;-</span>clinicList[[<span class="st">&quot;patient&quot;</span>]]</span>
<span id="cb21-159"><a href="fundamentals-of-bayesian-inference.html#cb21-159" aria-hidden="true" tabindex="-1"></a>   <span class="do">## update flags</span></span>
<span id="cb21-160"><a href="fundamentals-of-bayesian-inference.html#cb21-160" aria-hidden="true" tabindex="-1"></a>     <span class="co"># update currentTime</span></span>
<span id="cb21-161"><a href="fundamentals-of-bayesian-inference.html#cb21-161" aria-hidden="true" tabindex="-1"></a>    <span class="do">## current time is cumulative sum of the arrival times.</span></span>
<span id="cb21-162"><a href="fundamentals-of-bayesian-inference.html#cb21-162" aria-hidden="true" tabindex="-1"></a>   currentTime<span class="ot">&lt;-</span>patientList<span class="sc">$</span>currentTime[<span class="fu">which</span>(patientList<span class="sc">$</span>patient<span class="sc">==</span><span class="fu">max</span>(patientList<span class="sc">$</span>patient))] <span class="do">## current time is the max current time from patient chart.</span></span>
<span id="cb21-163"><a href="fundamentals-of-bayesian-inference.html#cb21-163" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb21-164"><a href="fundamentals-of-bayesian-inference.html#cb21-164" aria-hidden="true" tabindex="-1"></a>   <span class="do">## fix me:</span></span>
<span id="cb21-165"><a href="fundamentals-of-bayesian-inference.html#cb21-165" aria-hidden="true" tabindex="-1"></a>   <span class="do">## reset doctor availability based on current patient time.</span></span>
<span id="cb21-166"><a href="fundamentals-of-bayesian-inference.html#cb21-166" aria-hidden="true" tabindex="-1"></a>   upID<span class="ot">&lt;-</span><span class="fu">which</span>(doctors<span class="sc">$</span>nextTimeAvail<span class="sc">&lt;</span>currentTime)</span>
<span id="cb21-167"><a href="fundamentals-of-bayesian-inference.html#cb21-167" aria-hidden="true" tabindex="-1"></a>   doctors<span class="sc">$</span>nextTimeAvail[upID]<span class="ot">&lt;-</span>currentTime</span>
<span id="cb21-168"><a href="fundamentals-of-bayesian-inference.html#cb21-168" aria-hidden="true" tabindex="-1"></a>   doctors<span class="sc">$</span>currentTime[upID]<span class="ot">&lt;-</span>currentTime </span>
<span id="cb21-169"><a href="fundamentals-of-bayesian-inference.html#cb21-169" aria-hidden="true" tabindex="-1"></a>   doctors<span class="sc">$</span>visitTimeLength[upID]<span class="ot">&lt;-</span><span class="dv">0</span> </span>
<span id="cb21-170"><a href="fundamentals-of-bayesian-inference.html#cb21-170" aria-hidden="true" tabindex="-1"></a>  }<span class="do">## while loop</span></span>
<span id="cb21-171"><a href="fundamentals-of-bayesian-inference.html#cb21-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">patient=</span>patientList,<span class="at">doctors=</span>doctors))</span>
<span id="cb21-172"><a href="fundamentals-of-bayesian-inference.html#cb21-172" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="fundamentals-of-bayesian-inference.html#cb22-1" aria-hidden="true" tabindex="-1"></a> doctors<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">dr=</span><span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>),</span>
<span id="cb22-2"><a href="fundamentals-of-bayesian-inference.html#cb22-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">visitingPatient=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="do">## who is doctor seeing (patient ID)</span></span>
<span id="cb22-3"><a href="fundamentals-of-bayesian-inference.html#cb22-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">visitTimeLength=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># length of doctor visit U(5,20)</span></span>
<span id="cb22-4"><a href="fundamentals-of-bayesian-inference.html#cb22-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">currentTime=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),    <span class="do">## current Time</span></span>
<span id="cb22-5"><a href="fundamentals-of-bayesian-inference.html#cb22-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nextTimeAvail=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="do">## current time + visitTimeLength = next avail time.</span></span>
<span id="cb22-6"><a href="fundamentals-of-bayesian-inference.html#cb22-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">avail=</span><span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>,<span class="st">&quot;yes&quot;</span>,<span class="st">&quot;yes&quot;</span>))</span>
<span id="cb22-7"><a href="fundamentals-of-bayesian-inference.html#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="do">## initiate times</span></span>
<span id="cb22-8"><a href="fundamentals-of-bayesian-inference.html#cb22-8" aria-hidden="true" tabindex="-1"></a> totalWait<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb22-9"><a href="fundamentals-of-bayesian-inference.html#cb22-9" aria-hidden="true" tabindex="-1"></a> currentPatientNumber<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb22-10"><a href="fundamentals-of-bayesian-inference.html#cb22-10" aria-hidden="true" tabindex="-1"></a> <span class="do">## clinic opens at 9am -4pm that is 7 hours (420 min.)</span></span>
<span id="cb22-11"><a href="fundamentals-of-bayesian-inference.html#cb22-11" aria-hidden="true" tabindex="-1"></a> timeToClose<span class="ot">&lt;-</span><span class="dv">7</span><span class="sc">*</span><span class="dv">60</span> <span class="do">## stops admiting patienets in 420 minutes</span></span>
<span id="cb22-12"><a href="fundamentals-of-bayesian-inference.html#cb22-12" aria-hidden="true" tabindex="-1"></a> <span class="do">## current time is 0</span></span>
<span id="cb22-13"><a href="fundamentals-of-bayesian-inference.html#cb22-13" aria-hidden="true" tabindex="-1"></a> <span class="do">## this will be the running total of minutes.</span></span>
<span id="cb22-14"><a href="fundamentals-of-bayesian-inference.html#cb22-14" aria-hidden="true" tabindex="-1"></a> currentTime<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb22-15"><a href="fundamentals-of-bayesian-inference.html#cb22-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb22-16"><a href="fundamentals-of-bayesian-inference.html#cb22-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb22-17"><a href="fundamentals-of-bayesian-inference.html#cb22-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb22-18"><a href="fundamentals-of-bayesian-inference.html#cb22-18" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="fu">simulateProcess</span>(doctors,</span>
<span id="cb22-19"><a href="fundamentals-of-bayesian-inference.html#cb22-19" aria-hidden="true" tabindex="-1"></a>                          totalWait,</span>
<span id="cb22-20"><a href="fundamentals-of-bayesian-inference.html#cb22-20" aria-hidden="true" tabindex="-1"></a>                          totalPatients,</span>
<span id="cb22-21"><a href="fundamentals-of-bayesian-inference.html#cb22-21" aria-hidden="true" tabindex="-1"></a>                          timeToClose,</span>
<span id="cb22-22"><a href="fundamentals-of-bayesian-inference.html#cb22-22" aria-hidden="true" tabindex="-1"></a>                          currentTime)</span>
<span id="cb22-23"><a href="fundamentals-of-bayesian-inference.html#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="fundamentals-of-bayesian-inference.html#cb22-24" aria-hidden="true" tabindex="-1"></a>pl<span class="ot">&lt;-</span>res<span class="sc">$</span>patient[<span class="fu">which</span>(res<span class="sc">$</span>patient<span class="sc">$</span>currentTime<span class="sc">&lt;=</span><span class="dv">420</span>),]</span>
<span id="cb22-25"><a href="fundamentals-of-bayesian-inference.html#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="fundamentals-of-bayesian-inference.html#cb22-26" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(pl<span class="sc">$</span>doctorVisitTime)</span>
<span id="cb22-27"><a href="fundamentals-of-bayesian-inference.html#cb22-27" aria-hidden="true" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v=</span>(<span class="dv">20</span><span class="sc">+</span><span class="dv">5</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="do">## should be ~12</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="fundamentals-of-bayesian-inference.html#cb23-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(pl<span class="sc">$</span>arrivalTime) <span class="do">## should be close to 10  exp(1/10) has mean 10</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="fundamentals-of-bayesian-inference.html#cb24-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(pl<span class="sc">$</span>doctorWaitTime[<span class="fu">which</span>(pl<span class="sc">$</span>doctorWaitTime<span class="sc">!=</span><span class="dv">0</span>)]) <span class="do">## about 2.41</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="fundamentals-of-bayesian-inference.html#cb25-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">max</span>(pl<span class="sc">$</span>completionTime)<span class="sc">-</span><span class="dv">420</span>) <span class="do">## closing time</span></span></code></pre></div>
<pre><code>## [1] 7.869564</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="fundamentals-of-bayesian-inference.html#cb27-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">max</span>(pl<span class="sc">$</span>patient)) <span class="do">## total patient  should be 42</span></span></code></pre></div>
<pre><code>## [1] 48</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="fundamentals-of-bayesian-inference.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## (20-5)/6 + 10 this is about 12.5 minutes of arrival + visit time. which is approximately close to 10 </span></span>
<span id="cb29-2"><a href="fundamentals-of-bayesian-inference.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">## the arrival time is about 10 minutes.  </span></span>
<span id="cb29-3"><a href="fundamentals-of-bayesian-inference.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="fundamentals-of-bayesian-inference.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## we should expect 42 patients</span></span>
<span id="cb29-5"><a href="fundamentals-of-bayesian-inference.html#cb29-5" aria-hidden="true" tabindex="-1"></a> <span class="co">#420/10</span></span>
<span id="cb29-6"><a href="fundamentals-of-bayesian-inference.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-7"><a href="fundamentals-of-bayesian-inference.html#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## sanity check</span></span>
<span id="cb29-8"><a href="fundamentals-of-bayesian-inference.html#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#all(pl$currentTime+pl$doctorWaitTime+pl$doctorVisitTime-pl$completionTime==0)</span></span></code></pre></div>
</div>
<div id="simulation-100-times" class="section level2 unnumbered hasAnchor">
<h2>Simulation 100 times<a href="fundamentals-of-bayesian-inference.html#simulation-100-times" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>total number of patients was approximately 42, which we expect since the total 420/10. The total number waiting with 3 doctors is 6.61 for 1 day. the average waiting time was about 4-5 minutes. For 1 day, the average closing time was 5.32 minutes after 4 pm</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="fundamentals-of-bayesian-inference.html#cb30-1" aria-hidden="true" tabindex="-1"></a> totalPat<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb30-2"><a href="fundamentals-of-bayesian-inference.html#cb30-2" aria-hidden="true" tabindex="-1"></a> totalWaiting<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb30-3"><a href="fundamentals-of-bayesian-inference.html#cb30-3" aria-hidden="true" tabindex="-1"></a> avgWaiting<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb30-4"><a href="fundamentals-of-bayesian-inference.html#cb30-4" aria-hidden="true" tabindex="-1"></a> closing<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb30-5"><a href="fundamentals-of-bayesian-inference.html#cb30-5" aria-hidden="true" tabindex="-1"></a> patientList<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb30-6"><a href="fundamentals-of-bayesian-inference.html#cb30-6" aria-hidden="true" tabindex="-1"></a> p1<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb30-7"><a href="fundamentals-of-bayesian-inference.html#cb30-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb30-8"><a href="fundamentals-of-bayesian-inference.html#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb30-9"><a href="fundamentals-of-bayesian-inference.html#cb30-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-10"><a href="fundamentals-of-bayesian-inference.html#cb30-10" aria-hidden="true" tabindex="-1"></a> doctors<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">dr=</span><span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>),</span>
<span id="cb30-11"><a href="fundamentals-of-bayesian-inference.html#cb30-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">visitingPatient=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="do">## who is doctor seeing (patient ID)</span></span>
<span id="cb30-12"><a href="fundamentals-of-bayesian-inference.html#cb30-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">visitTimeLength=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># length of doctor visit U(5,20)</span></span>
<span id="cb30-13"><a href="fundamentals-of-bayesian-inference.html#cb30-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">currentTime=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),    <span class="do">## current Time</span></span>
<span id="cb30-14"><a href="fundamentals-of-bayesian-inference.html#cb30-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nextTimeAvail=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="do">## current time + visitTimeLength = next avail time.</span></span>
<span id="cb30-15"><a href="fundamentals-of-bayesian-inference.html#cb30-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">avail=</span><span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>,<span class="st">&quot;yes&quot;</span>,<span class="st">&quot;yes&quot;</span>))</span>
<span id="cb30-16"><a href="fundamentals-of-bayesian-inference.html#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="do">## initiate times</span></span>
<span id="cb30-17"><a href="fundamentals-of-bayesian-inference.html#cb30-17" aria-hidden="true" tabindex="-1"></a> totalWait<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb30-18"><a href="fundamentals-of-bayesian-inference.html#cb30-18" aria-hidden="true" tabindex="-1"></a> totalPatients<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb30-19"><a href="fundamentals-of-bayesian-inference.html#cb30-19" aria-hidden="true" tabindex="-1"></a> currentPatientNumber<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb30-20"><a href="fundamentals-of-bayesian-inference.html#cb30-20" aria-hidden="true" tabindex="-1"></a> <span class="do">## clinic opens at 9am -4pm that is 7 hours (420 min.)</span></span>
<span id="cb30-21"><a href="fundamentals-of-bayesian-inference.html#cb30-21" aria-hidden="true" tabindex="-1"></a> timeToClose<span class="ot">&lt;-</span><span class="dv">7</span><span class="sc">*</span><span class="dv">60</span> <span class="do">## stops admiting patienets in 420 minutes</span></span>
<span id="cb30-22"><a href="fundamentals-of-bayesian-inference.html#cb30-22" aria-hidden="true" tabindex="-1"></a> <span class="do">## current time is 0</span></span>
<span id="cb30-23"><a href="fundamentals-of-bayesian-inference.html#cb30-23" aria-hidden="true" tabindex="-1"></a> <span class="do">## this will be the running total of minutes.</span></span>
<span id="cb30-24"><a href="fundamentals-of-bayesian-inference.html#cb30-24" aria-hidden="true" tabindex="-1"></a> currentTime<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb30-25"><a href="fundamentals-of-bayesian-inference.html#cb30-25" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb30-26"><a href="fundamentals-of-bayesian-inference.html#cb30-26" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb30-27"><a href="fundamentals-of-bayesian-inference.html#cb30-27" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="fu">simulateProcess</span>(doctors,</span>
<span id="cb30-28"><a href="fundamentals-of-bayesian-inference.html#cb30-28" aria-hidden="true" tabindex="-1"></a>                          totalWait,</span>
<span id="cb30-29"><a href="fundamentals-of-bayesian-inference.html#cb30-29" aria-hidden="true" tabindex="-1"></a>                          totalPatients,</span>
<span id="cb30-30"><a href="fundamentals-of-bayesian-inference.html#cb30-30" aria-hidden="true" tabindex="-1"></a>                          timeToClose,</span>
<span id="cb30-31"><a href="fundamentals-of-bayesian-inference.html#cb30-31" aria-hidden="true" tabindex="-1"></a>                          currentTime)</span>
<span id="cb30-32"><a href="fundamentals-of-bayesian-inference.html#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="fundamentals-of-bayesian-inference.html#cb30-33" aria-hidden="true" tabindex="-1"></a>pl<span class="ot">&lt;-</span>res<span class="sc">$</span>patient[<span class="fu">which</span>(res<span class="sc">$</span>patient<span class="sc">$</span>currentTime<span class="sc">&lt;=</span><span class="dv">420</span>),]</span>
<span id="cb30-34"><a href="fundamentals-of-bayesian-inference.html#cb30-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-35"><a href="fundamentals-of-bayesian-inference.html#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="fundamentals-of-bayesian-inference.html#cb30-36" aria-hidden="true" tabindex="-1"></a> totalPat<span class="ot">&lt;-</span><span class="fu">c</span>(totalPat,<span class="fu">max</span>(pl<span class="sc">$</span>patient))</span>
<span id="cb30-37"><a href="fundamentals-of-bayesian-inference.html#cb30-37" aria-hidden="true" tabindex="-1"></a>  totalWaiting<span class="ot">&lt;-</span><span class="fu">c</span>(totalWaiting,<span class="fu">nrow</span>(pl[<span class="fu">which</span>(pl<span class="sc">$</span>doctorWaitTime<span class="sc">!=</span><span class="dv">0</span>),]))</span>
<span id="cb30-38"><a href="fundamentals-of-bayesian-inference.html#cb30-38" aria-hidden="true" tabindex="-1"></a> avgWaiting<span class="ot">&lt;-</span><span class="fu">c</span>(avgWaiting,<span class="fu">mean</span>(pl[<span class="fu">which</span>(pl<span class="sc">$</span>doctorWaitTime<span class="sc">!=</span><span class="dv">0</span>),<span class="st">&quot;doctorWaitTime&quot;</span>]))</span>
<span id="cb30-39"><a href="fundamentals-of-bayesian-inference.html#cb30-39" aria-hidden="true" tabindex="-1"></a> closing<span class="ot">&lt;-</span><span class="fu">c</span>(closing,<span class="fu">max</span>(pl<span class="sc">$</span>completionTime))</span>
<span id="cb30-40"><a href="fundamentals-of-bayesian-inference.html#cb30-40" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb30-41"><a href="fundamentals-of-bayesian-inference.html#cb30-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-42"><a href="fundamentals-of-bayesian-inference.html#cb30-42" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb30-43"><a href="fundamentals-of-bayesian-inference.html#cb30-43" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(totalPat,<span class="at">main=</span><span class="st">&quot;total patients&quot;</span>)</span>
<span id="cb30-44"><a href="fundamentals-of-bayesian-inference.html#cb30-44" aria-hidden="true" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v=</span><span class="dv">420</span><span class="sc">/</span><span class="dv">10</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="fundamentals-of-bayesian-inference.html#cb31-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(totalWaiting,<span class="at">main=</span><span class="st">&quot;total number waiting&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="fundamentals-of-bayesian-inference.html#cb32-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(avgWaiting,<span class="at">main=</span><span class="st">&quot;avg. waiting (min)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="fundamentals-of-bayesian-inference.html#cb33-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">hist</span>(closing<span class="dv">-420</span>,<span class="at">main=</span><span class="st">&quot;closing time&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-4.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cross.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/01-intro.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
